!function($){$.extend(!0,window,{Slick:{CellSelectionModel:function(options){var _grid,_selector,_options,_ranges=[],_self=this;_selector=void 0===options||void 0===options.cellRangeSelector?new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}):options.cellRangeSelector;var _defaults={selectActiveCell:!0};function removeInvalidRanges(ranges){for(var result=[],i=0;i<ranges.length;i++){var r=ranges[i];_grid.canCellBeSelected(r.fromRow,r.fromCell)&&_grid.canCellBeSelected(r.toRow,r.toCell)&&result.push(r)}return result}function setSelectedRanges(ranges){if(_ranges&&0!==_ranges.length||ranges&&0!==ranges.length){var rangeHasChanged=!function(range1,range2){var areDifferent=range1.length!==range2.length;if(!areDifferent)for(var i=0;i<range1.length;i++)if(range1[i].fromCell!==range2[i].fromCell||range1[i].fromRow!==range2[i].fromRow||range1[i].toCell!==range2[i].toCell||range1[i].toRow!==range2[i].toRow){areDifferent=!0;break}return!areDifferent}(_ranges,ranges);_ranges=removeInvalidRanges(ranges),rangeHasChanged&&_self.onSelectedRangesChanged.notify(_ranges)}}function getSelectedRanges(){return _ranges}function handleBeforeCellRangeSelected(e,args){if(_grid.getEditorLock().isActive())return e.stopPropagation(),!1}function handleCellRangeSelected(e,args){_grid.setActiveCell(args.range.fromRow,args.range.fromCell,!1,!1,!0),setSelectedRanges([args.range])}function handleActiveCellChange(e,args){_options.selectActiveCell&&null!=args.row&&null!=args.cell?setSelectedRanges([new Slick.Range(args.row,args.cell)]):_options.selectActiveCell||setSelectedRanges([])}function handleKeyDown(e){var ranges,last,active=_grid.getActiveCell(),metaKey=e.ctrlKey||e.metaKey;if(active&&e.shiftKey&&!metaKey&&!e.altKey&&(37==e.which||39==e.which||38==e.which||40==e.which)){(ranges=getSelectedRanges()).length||ranges.push(new Slick.Range(active.row,active.cell)),(last=ranges.pop()).contains(active.row,active.cell)||(last=new Slick.Range(active.row,active.cell));var dRow=last.toRow-last.fromRow,dCell=last.toCell-last.fromCell,dirRow=active.row==last.fromRow?1:-1,dirCell=active.cell==last.fromCell?1:-1;37==e.which?dCell-=dirCell:39==e.which?dCell+=dirCell:38==e.which?dRow-=dirRow:40==e.which&&(dRow+=dirRow);var new_last=new Slick.Range(active.row,active.cell,active.row+dirRow*dRow,active.cell+dirCell*dCell);if(removeInvalidRanges([new_last]).length){ranges.push(new_last);var viewRow=dirRow>0?new_last.toRow:new_last.fromRow,viewCell=dirCell>0?new_last.toCell:new_last.fromCell;_grid.scrollRowIntoView(viewRow),_grid.scrollCellIntoView(viewRow,viewCell)}else ranges.push(last);setSelectedRanges(ranges),e.preventDefault(),e.stopPropagation()}}$.extend(this,{getSelectedRanges:getSelectedRanges,setSelectedRanges:setSelectedRanges,init:function(grid){_options=$.extend(!0,{},_defaults,options),(_grid=grid).getCanvasNode(),_grid.onActiveCellChanged.subscribe(handleActiveCellChange),_grid.onKeyDown.subscribe(handleKeyDown),grid.registerPlugin(_selector),_selector.onCellRangeSelected.subscribe(handleCellRangeSelected),_selector.onBeforeCellRangeSelected.subscribe(handleBeforeCellRangeSelected)},destroy:function(){_grid.onActiveCellChanged.unsubscribe(handleActiveCellChange),_grid.onKeyDown.unsubscribe(handleKeyDown),_selector.onCellRangeSelected.unsubscribe(handleCellRangeSelected),_selector.onBeforeCellRangeSelected.unsubscribe(handleBeforeCellRangeSelected),_grid.unregisterPlugin(_selector)},onSelectedRangesChanged:new Slick.Event})}}})}(jQuery);