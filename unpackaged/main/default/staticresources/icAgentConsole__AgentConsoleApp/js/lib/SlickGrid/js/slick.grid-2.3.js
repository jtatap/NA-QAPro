if("undefined"==typeof jQuery)throw new Error("SlickGrid requires jquery module to be loaded");if(!jQuery.fn.drag)throw new Error("SlickGrid requires jquery.event.drag module to be loaded");if("undefined"==typeof Slick)throw new Error("slick.core.js not loaded");!function($){var scrollbarDimensions,maxSupportedCssHeight;function SlickGrid(container,data,columns,options){var defaults={alwaysShowVerticalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacer,$footerRow,$footerRowScroller,$footerRowSpacer,$preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,tabbingDirection=1,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],pagingActive=!1,pagingIsLastPage=!1,scrollThrottle=ActionThrottle(render,50),h_editorLoader=null,h_render=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],postProcessgroupId=0,counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent,cssShow={position:"absolute",visibility:"hidden",display:"block"},$hiddenParents,oldProps=[],columnResizeDragging=!1;function init(){if(($container=container instanceof jQuery?container:$(container)).length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");cacheCssForHiddenInit(),maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),options=$.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,columnsById={};for(var i=0;i<columns.length;i++){var m=columns[i]=$.extend({},columnDefaults,columns[i]);columnsById[m.id]=i,m.minWidth&&m.width<m.minWidth&&(m.width=m.minWidth),m.maxWidth&&m.width>m.maxWidth&&(m.width=m.maxWidth)}if(options.enableColumnReorder&&!$.fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=$("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),options.createPreHeaderPanel&&($preHeaderPanelScroller=$("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$preHeaderPanel=$("<div />").appendTo($preHeaderPanelScroller),$preHeaderPanelSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScroller),options.showPreHeaderPanel||$preHeaderPanelScroller.hide()),$headerScroller=$("<div class='slick-header ui-state-default' />").appendTo($container),$headers=$("<div class='slick-header-columns' style='left:-1000px' />").appendTo($headerScroller),$headerRowScroller=$("<div class='slick-headerrow ui-state-default' />").appendTo($container),$headerRow=$("<div class='slick-headerrow-columns' />").appendTo($headerRowScroller),$headerRowSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScroller),$topPanelScroller=$("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($container),$topPanel=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScroller),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),($viewport=$("<div class='slick-viewport' style='width:100%;overflow:auto;outline:0;position:relative;;'>").appendTo($container)).css("overflow-y",options.alwaysShowVerticalScroll?"scroll":options.autoHeight?"hidden":"auto"),$viewport.css("overflow-x",options.forceFitColumns?"hidden":"auto"),options.viewportClass&&$viewport.toggleClass(options.viewportClass,!0),$canvas=$("<div class='grid-canvas' />").appendTo($viewport),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),$preHeaderPanelSpacer&&$preHeaderPanelSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headers.width(getHeadersWidth()),$headerRowSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),options.createFooterRow&&($footerRowScroller=$("<div class='slick-footerrow ui-state-default' />").appendTo($container),$footerRow=$("<div class='slick-footerrow-columns' />").appendTo($footerRowScroller),$footerRowSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScroller),options.showFooterRow||$footerRowScroller.hide()),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,viewportW=parseFloat($.css($container[0],"width",!0)),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.on("selectstart.ui",function(event){return $(event.target).is("input,textarea")}),updateColumnCaches(),createColumnHeaders(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.on("resize.slickgrid",resizeCanvas),$viewport.on("scroll",handleScroll),$headerScroller.on("contextmenu",handleHeaderContextMenu).on("click",handleHeaderClick).on("mouseenter",".slick-header-column",handleHeaderMouseEnter).on("mouseleave",".slick-header-column",handleHeaderMouseLeave),$headerRowScroller.on("scroll",handleHeaderRowScroll),options.createFooterRow&&$footerRowScroller.on("scroll",handleFooterRowScroll),options.createPreHeaderPanel&&$preHeaderPanelScroller.on("scroll",handlePreHeaderPanelScroll),$focusSink.add($focusSink2).on("keydown",handleKeyDown),$canvas.on("keydown",handleKeyDown).on("click",handleClick).on("dblclick",handleDblClick).on("contextmenu",handleContextMenu).on("draginit",handleDragInit).on("dragstart",{distance:3},handleDragStart).on("drag",handleDrag).on("dragend",handleDragEnd).on("mouseenter",".slick-cell",handleMouseEnter).on("mouseleave",".slick-cell",handleMouseLeave),navigator.userAgent.toLowerCase().match(/webkit/)&&navigator.userAgent.toLowerCase().match(/macintosh/)&&$canvas.on("mousewheel",handleMouseWheel),restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){($hiddenParents=$container.parents().addBack().not(":visible")).each(function(){var old={};for(var name in cssShow)old[name]=this.style[name],this.style[name]=cssShow[name];oldProps.push(old)})}function restoreCssFromHiddenInit(){$hiddenParents.each(function(i){var old=oldProps[i];for(var name in cssShow)this.style[name]=old[name]})}function registerPlugin(plugin){plugins.unshift(plugin),plugin.init(self)}function unregisterPlugin(plugin){for(var i=plugins.length;i>=0;i--)if(plugins[i]===plugin){plugins[i].destroy&&plugins[i].destroy(),plugins.splice(i,1);break}}function setSelectionModel(model){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),(selectionModel=model)&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var $outerdiv=$('<div class="'+$viewport.className+'" style="position:absolute; top:-10000px; left:-10000px; overflow:auto; width:100px; height:100px;"></div>').appendTo($viewport),$innerdiv=$('<div style="width:200px; height:200px; overflow:auto;"></div>').appendTo($outerdiv),dim={width:$outerdiv[0].offsetWidth-$outerdiv[0].clientWidth,height:$outerdiv[0].offsetHeight-$outerdiv[0].clientHeight};return $innerdiv.remove(),$outerdiv.remove(),dim}function getColumnTotalWidth(includeScrollbar){for(var totalWidth=0,i=0,ii=columns.length;i<ii;i++)totalWidth+=columns[i].width;return includeScrollbar&&(totalWidth+=scrollbarDimensions.width),totalWidth}function getHeadersWidth(){var headersWidth=getColumnTotalWidth(!options.autoHeight);return Math.max(headersWidth,viewportW)+1e3}function getCanvasWidth(){for(var availableWidth=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,rowWidth=0,i=columns.length;i--;)rowWidth+=columns[i].width;return options.fullWidthRows?Math.max(rowWidth,availableWidth):rowWidth}function updateCanvasWidth(forceColumnWidthsUpdate){var oldCanvasWidth=canvasWidth;(canvasWidth=getCanvasWidth())!=oldCanvasWidth&&($canvas.width(canvasWidth),$headerRow.width(canvasWidth),options.createFooterRow&&$footerRow.width(canvasWidth),options.createPreHeaderPanel&&$preHeaderPanel.width(canvasWidth),$headers.width(getHeadersWidth()),viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width);var w=canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0);$headerRowSpacer.width(w),options.createFooterRow&&$footerRowSpacer.width(w),options.createPreHeaderPanel&&$preHeaderPanelSpacer.width(w),(canvasWidth!=oldCanvasWidth||forceColumnWidthsUpdate)&&applyColumnWidths()}function disableSelection($target){$target&&$target.jquery&&$target.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",function(){return!1})}function getMaxSupportedCssHeight(){for(var supportedHeight=1e6,testUpTo=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,div=$("<div style='display:none' />").appendTo(document.body);;){var test=2*supportedHeight;if(div.css("height",test),test>testUpTo||div.height()!==test)break;supportedHeight=test}return div.remove(),supportedHeight}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function bindAncestorScrollEvents(){for(var elem=$canvas[0];(elem=elem.parentNode)!=document.body&&null!=elem;)if(elem==$viewport[0]||elem.scrollWidth!=elem.clientWidth||elem.scrollHeight!=elem.clientHeight){var $elem=$(elem);$boundAncestors=$boundAncestors?$boundAncestors.add($elem):$elem,$elem.on("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.off("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(columnId,title,toolTip){if(initialized){var idx=getColumnIndex(columnId);if(null!=idx){var columnDef=columns[idx],$header=$headers.children().eq(idx);$header&&(void 0!==title&&(columns[idx].name=title),void 0!==toolTip&&(columns[idx].toolTip=toolTip),trigger(self.onBeforeHeaderCellDestroy,{node:$header[0],column:columnDef,grid:self}),$header.attr("title",toolTip||"").children().eq(0).html(title),trigger(self.onHeaderCellRendered,{node:$header[0],column:columnDef,grid:self}))}}}function getHeader(){return $headers[0]}function getHeaderColumn(columnIdOrIdx){var idx="number"==typeof columnIdOrIdx?columnIdOrIdx:getColumnIndex(columnIdOrIdx),$rtn=$headers.children().eq(idx);return $rtn&&$rtn[0]}function getHeaderRow(){return $headerRow[0]}function getFooterRow(){return $footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getHeaderRowColumn(columnIdOrIdx){var idx="number"==typeof columnIdOrIdx?columnIdOrIdx:getColumnIndex(columnIdOrIdx),$rtn=$headerRow.children().eq(idx);return $rtn&&$rtn[0]}function getFooterRowColumn(columnIdOrIdx){var idx="number"==typeof columnIdOrIdx?columnIdOrIdx:getColumnIndex(columnIdOrIdx),$rtn=$footerRow.children().eq(idx);return $rtn&&$rtn[0]}function createColumnHeaders(){function onMouseEnter(){$(this).addClass("ui-state-hover")}function onMouseLeave(){$(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each(function(){var columnDef=$(this).data("column");columnDef&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:columnDef,grid:self})}),$headers.empty(),$headers.width(getHeadersWidth()),$headerRow.find(".slick-headerrow-column").each(function(){var columnDef=$(this).data("column");columnDef&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:columnDef,grid:self})}),$headerRow.empty(),options.createFooterRow&&($footerRow.find(".slick-footerrow-column").each(function(){var columnDef=$(this).data("column");columnDef&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:columnDef})}),$footerRow.empty());for(var i=0;i<columns.length;i++){var m=columns[i],header=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+m.name+"</span>").width(m.width-headerColumnWidthDiff).attr("id",""+uid+m.id).attr("title",m.toolTip||"").data("column",m).addClass(m.headerCssClass||"").appendTo($headers);if((options.enableColumnReorder||m.sortable)&&header.on("mouseenter",onMouseEnter).on("mouseleave",onMouseLeave),m.sortable&&(header.addClass("slick-header-sortable"),header.append("<span class='slick-sort-indicator"+(options.numberedMultiColumnSort&&!options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")+"' />"),options.numberedMultiColumnSort&&options.sortColNumberInSeparateSpan&&header.append("<span class='slick-sort-indicator-numbered' />")),trigger(self.onHeaderCellRendered,{node:header[0],column:m,grid:self}),options.showHeaderRow){var headerRowCell=$("<div class='ui-state-default slick-headerrow-column l"+i+" r"+i+"'></div>").data("column",m).appendTo($headerRow);trigger(self.onHeaderRowCellRendered,{node:headerRowCell[0],column:m,grid:self})}if(options.createFooterRow&&options.showFooterRow){var footerRowCell=$("<div class='ui-state-default slick-footerrow-column l"+i+" r"+i+"'></div>").data("column",m).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:footerRowCell[0],column:m})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&("function"==typeof options.enableColumnReorder?options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger):setupColumnReorder())}function setupColumnSort(){$headers.click(function(e){if(!columnResizeDragging&&(e.metaKey=e.metaKey||e.ctrlKey,!$(e.target).hasClass("slick-resizable-handle"))){var $col=$(e.target).closest(".slick-header-column");if($col.length){var column=$col.data("column");if(column.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var sortColumn=null,i=0;i<sortColumns.length;i++)if(sortColumns[i].columnId==column.id){(sortColumn=sortColumns[i]).sortAsc=!sortColumn.sortAsc;break}var hadSortCol=!!sortColumn;options.tristateMultiColumnSort?(sortColumn||(sortColumn={columnId:column.id,sortAsc:column.defaultSortAsc}),hadSortCol&&sortColumn.sortAsc&&(sortColumns.splice(i,1),sortColumn=null),options.multiColumnSort||(sortColumns=[]),!sortColumn||hadSortCol&&options.multiColumnSort||sortColumns.push(sortColumn)):e.metaKey&&options.multiColumnSort?sortColumn&&sortColumns.splice(i,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),sortColumn?0==sortColumns.length&&sortColumns.push(sortColumn):(sortColumn={columnId:column.id,sortAsc:column.defaultSortAsc},sortColumns.push(sortColumn))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:$.map(sortColumns,function(col){return{sortCol:columns[getColumnIndex(col.columnId)],sortAsc:col.sortAsc}})},e):trigger(self.onSort,{multiColumnSort:!1,sortCol:sortColumns.length>0?column:null,sortAsc:!(sortColumns.length>0)||sortColumns[0].sortAsc},e)}}}})}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy"),$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",start:function(e,ui){ui.placeholder.width(ui.helper.outerWidth()-headerColumnWidthDiff),$(ui.helper).addClass("slick-header-column-active")},beforeStop:function(e,ui){$(ui.helper).removeClass("slick-header-column-active")},stop:function(e){if(getEditorLock().commitCurrentEdit()){for(var reorderedIds=$headers.sortable("toArray"),reorderedColumns=[],i=0;i<reorderedIds.length;i++)reorderedColumns.push(columns[getColumnIndex(reorderedIds[i].replace(uid,""))]);setColumns(reorderedColumns),trigger(self.onColumnsReordered,{}),e.stopPropagation(),setupColumnResize()}else $(this).sortable("cancel")}})}function setupColumnResize(){var j,c,pageX,columnElements,minPageX,maxPageX,firstResizable,lastResizable;(columnElements=$headers.children()).find(".slick-resizable-handle").remove(),columnElements.each(function(i,e){i>=columns.length||columns[i].resizable&&(void 0===firstResizable&&(firstResizable=i),lastResizable=i)}),void 0!==firstResizable&&columnElements.each(function(i,e){i>=columns.length||i<firstResizable||options.forceFitColumns&&i>=lastResizable||($(e),$("<div class='slick-resizable-handle' />").appendTo(e).on("dragstart",function(e,dd){if(!getEditorLock().commitCurrentEdit())return!1;pageX=e.pageX,$(this).parent().addClass("slick-header-column-active");var shrinkLeewayOnRight=null,stretchLeewayOnRight=null;if(columnElements.each(function(i,e){i>=columns.length||(columns[i].previousWidth=$(e).outerWidth())}),options.forceFitColumns)for(shrinkLeewayOnRight=0,stretchLeewayOnRight=0,j=i+1;j<columns.length;j++)(c=columns[j]).resizable&&(null!==stretchLeewayOnRight&&(c.maxWidth?stretchLeewayOnRight+=c.maxWidth-c.previousWidth:stretchLeewayOnRight=null),shrinkLeewayOnRight+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth));var shrinkLeewayOnLeft=0,stretchLeewayOnLeft=0;for(j=0;j<=i;j++)(c=columns[j]).resizable&&(null!==stretchLeewayOnLeft&&(c.maxWidth?stretchLeewayOnLeft+=c.maxWidth-c.previousWidth:stretchLeewayOnLeft=null),shrinkLeewayOnLeft+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth));null===shrinkLeewayOnRight&&(shrinkLeewayOnRight=1e5),null===shrinkLeewayOnLeft&&(shrinkLeewayOnLeft=1e5),null===stretchLeewayOnRight&&(stretchLeewayOnRight=1e5),null===stretchLeewayOnLeft&&(stretchLeewayOnLeft=1e5),maxPageX=pageX+Math.min(shrinkLeewayOnRight,stretchLeewayOnLeft),minPageX=pageX-Math.min(shrinkLeewayOnLeft,stretchLeewayOnRight)}).on("drag",function(e,dd){columnResizeDragging=!0;var actualMinWidth,x,d=Math.min(maxPageX,Math.max(minPageX,e.pageX))-pageX;if(d<0){for(x=d,j=i;j>=0;j--)(c=columns[j]).resizable&&(actualMinWidth=Math.max(c.minWidth||0,absoluteColumnMinWidth),x&&c.previousWidth+x<actualMinWidth?(x+=c.previousWidth-actualMinWidth,c.width=actualMinWidth):(c.width=c.previousWidth+x,x=0));if(options.forceFitColumns)for(x=-d,j=i+1;j<columns.length;j++)(c=columns[j]).resizable&&(x&&c.maxWidth&&c.maxWidth-c.previousWidth<x?(x-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+x,x=0))}else{for(x=d,j=i;j>=0;j--)(c=columns[j]).resizable&&(x&&c.maxWidth&&c.maxWidth-c.previousWidth<x?(x-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+x,x=0));if(options.forceFitColumns)for(x=-d,j=i+1;j<columns.length;j++)(c=columns[j]).resizable&&(actualMinWidth=Math.max(c.minWidth||0,absoluteColumnMinWidth),x&&c.previousWidth+x<actualMinWidth?(x+=c.previousWidth-actualMinWidth,c.width=actualMinWidth):(c.width=c.previousWidth+x,x=0))}applyColumnHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths()}).on("dragend",function(e,dd){var newWidth;for($(this).parent().removeClass("slick-header-column-active"),j=0;j<columns.length;j++)c=columns[j],newWidth=$(columnElements[j]).outerWidth(),c.previousWidth!==newWidth&&c.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{}),setTimeout(function(){columnResizeDragging=!1},300)}))})}function getVBoxDelta($el){var delta=0;return $.each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],function(n,val){delta+=parseFloat($el.css(val))||0}),delta}function measureCellPaddingAndBorder(){var el,h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],v=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],verArray=$.fn.jquery.split(".");jQueryNewWidthBehaviour=1==verArray[0]&&verArray[1]>=8||verArray[0]>=2,el=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=el.css("box-sizing")&&"border-box"!=el.css("-moz-box-sizing")&&"border-box"!=el.css("-webkit-box-sizing")&&($.each(h,function(n,val){headerColumnWidthDiff+=parseFloat(el.css(val))||0}),$.each(v,function(n,val){headerColumnHeightDiff+=parseFloat(el.css(val))||0})),el.remove();var r=$("<div class='slick-row' />").appendTo($canvas);el=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(r),cellWidthDiff=cellHeightDiff=0,"border-box"!=el.css("box-sizing")&&"border-box"!=el.css("-moz-box-sizing")&&"border-box"!=el.css("-webkit-box-sizing")&&($.each(h,function(n,val){cellWidthDiff+=parseFloat(el.css(val))||0}),$.each(v,function(n,val){cellHeightDiff+=parseFloat(el.css(val))||0})),r.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));for(var rowHeight=options.rowHeight-cellHeightDiff,rules=["."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-preheader-panel { height:"+options.preHeaderPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-footerrow-columns { height:"+options.footerRowHeight+"px; }","."+uid+" .slick-cell { height:"+rowHeight+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],i=0;i<columns.length;i++)rules.push("."+uid+" .l"+i+" { }"),rules.push("."+uid+" .r"+i+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=rules.join(" "):$style[0].appendChild(document.createTextNode(rules.join(" ")))}function getColumnCssRules(idx){var i;if(!stylesheet){var sheets=document.styleSheets;for(i=0;i<sheets.length;i++)if((sheets[i].ownerNode||sheets[i].owningElement)==$style[0]){stylesheet=sheets[i];break}if(!stylesheet)throw new Error("Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];var matches,columnIdx,cssRules=stylesheet.cssRules||stylesheet.rules;for(i=0;i<cssRules.length;i++){var selector=cssRules[i].selectorText;(matches=/\.l\d+/.exec(selector))?(columnIdx=parseInt(matches[0].substr(2,matches[0].length-2),10),columnCssRulesL[columnIdx]=cssRules[i]):(matches=/\.r\d+/.exec(selector))&&(columnIdx=parseInt(matches[0].substr(2,matches[0].length-2),10),columnCssRulesR[columnIdx]=cssRules[i])}}return{left:columnCssRulesL[idx],right:columnCssRulesR[idx]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var i=plugins.length;i--;)unregisterPlugin(plugins[i]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.off(".slickgrid"),removeCssRules(),$canvas.off("draginit dragstart dragend drag"),$container.empty().removeClass(uid)}function trigger(evt,args,e){return e=e||new Slick.EventData,(args=args||{}).grid=self,evt.notify(args,e,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(id){return columnsById[id]}function autosizeColumns(){var i,c,prevTotal,widths=[],shrinkLeeway=0,total=0,availWidth=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(i=0;i<columns.length;i++)c=columns[i],widths.push(c.width),total+=c.width,c.resizable&&(shrinkLeeway+=c.width-Math.max(c.minWidth,absoluteColumnMinWidth));for(prevTotal=total;total>availWidth&&shrinkLeeway;){var shrinkProportion=(total-availWidth)/shrinkLeeway;for(i=0;i<columns.length&&total>availWidth;i++){c=columns[i];var width=widths[i];if(!(!c.resizable||width<=c.minWidth||width<=absoluteColumnMinWidth)){var absMinWidth=Math.max(c.minWidth,absoluteColumnMinWidth),shrinkSize=Math.floor(shrinkProportion*(width-absMinWidth))||1;total-=shrinkSize=Math.min(shrinkSize,width-absMinWidth),shrinkLeeway-=shrinkSize,widths[i]-=shrinkSize}}if(prevTotal<=total)break;prevTotal=total}for(prevTotal=total;total<availWidth;){var growProportion=availWidth/total;for(i=0;i<columns.length&&total<availWidth;i++){c=columns[i];var growSize,currentWidth=widths[i];total+=growSize=!c.resizable||c.maxWidth<=currentWidth?0:Math.min(Math.floor(growProportion*currentWidth)-currentWidth,c.maxWidth-currentWidth||1e6)||1,widths[i]+=total<=availWidth?growSize:0}if(prevTotal>=total)break;prevTotal=total}var reRender=!1;for(i=0;i<columns.length;i++)columns[i].rerenderOnResize&&columns[i].width!=widths[i]&&(reRender=!0),columns[i].width=widths[i];applyColumnHeaderWidths(),updateCanvasWidth(!0),trigger(self.onAutosizeColumns,{columns:columns}),reRender&&(invalidateAllRows(),render())}function applyColumnHeaderWidths(){if(initialized){for(var h,i=0,headers=$headers.children(),ii=columns.length;i<ii;i++)h=$(headers[i]),jQueryNewWidthBehaviour?h.outerWidth()!==columns[i].width&&h.outerWidth(columns[i].width):h.width()!==columns[i].width-headerColumnWidthDiff&&h.width(columns[i].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var w,rule,x=0,i=0;i<columns.length;i++)w=columns[i].width,(rule=getColumnCssRules(i)).left.style.left=x+"px",rule.right.style.right=canvasWidth-x-w+"px",x+=columns[i].width}function setSortColumn(columnId,ascending){setSortColumns([{columnId:columnId,sortAsc:ascending}])}function setSortColumns(cols){sortColumns=cols;var numberCols=options.numberedMultiColumnSort&&sortColumns.length>1,headerColumnEls=$headers.children();headerColumnEls.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),headerColumnEls.find(".slick-sort-indicator-numbered").text(""),$.each(sortColumns,function(i,col){null==col.sortAsc&&(col.sortAsc=!0);var columnIndex=getColumnIndex(col.columnId);null!=columnIndex&&(headerColumnEls.eq(columnIndex).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(col.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),numberCols&&headerColumnEls.eq(columnIndex).find(".slick-sort-indicator-numbered").text(i+1))})}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,ranges){selectedRows=[];for(var hash={},i=0;i<ranges.length;i++)for(var j=ranges[i].fromRow;j<=ranges[i].toRow;j++){hash[j]||(selectedRows.push(j),hash[j]={});for(var k=ranges[i].fromCell;k<=ranges[i].toCell;k++)canCellBeSelected(j,k)&&(hash[j][columns[k].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,hash),trigger(self.onSelectedRowsChanged,{rows:getSelectedRows()},e)}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var x=0,i=0,ii=columns.length;i<ii;i++)columnPosLeft[i]=x,columnPosRight[i]=x+columns[i].width,x+=columns[i].width}function setColumns(columnDefinitions){columns=columnDefinitions,columnsById={};for(var i=0;i<columns.length;i++){var m=columns[i]=$.extend({},columnDefaults,columns[i]);columnsById[m.id]=i,m.minWidth&&m.width<m.minWidth&&(m.width=m.minWidth),m.maxWidth&&m.width>m.maxWidth&&(m.width=m.maxWidth)}updateColumnCaches(),initialized&&(invalidateAllRows(),createColumnHeaders(),removeCssRules(),createCssRules(),resizeCanvas(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(args,suppressRender){getEditorLock().commitCurrentEdit()&&(makeActiveCellNormal(),options.enableAddRow!==args.enableAddRow&&invalidateRow(getDataLength()),options=$.extend(options,args),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),suppressRender||render())}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1)}function setData(newData,scrollToTop){data=newData,invalidateAllRows(),updateRowCount(),scrollToTop&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data.length}function getDataLengthIncludingAddNew(){return getDataLength()+(!options.enableAddRow||pagingActive&&!pagingIsLastPage?0:1)}function getDataItem(i){return data.getItem?data.getItem(i):data[i]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(visible){options.showTopPanel!=visible&&(options.showTopPanel=visible,visible?$topPanelScroller.slideDown("fast",resizeCanvas):$topPanelScroller.slideUp("fast",resizeCanvas))}function setHeaderRowVisibility(visible){options.showHeaderRow!=visible&&(options.showHeaderRow=visible,visible?$headerRowScroller.slideDown("fast",resizeCanvas):$headerRowScroller.slideUp("fast",resizeCanvas))}function setFooterRowVisibility(visible){options.showFooterRow!=visible&&(options.showFooterRow=visible,visible?$footerRowScroller.slideDown("fast",resizeCanvas):$footerRowScroller.slideUp("fast",resizeCanvas))}function setPreHeaderPanelVisibility(visible){options.showPreHeaderPanel!=visible&&(options.showPreHeaderPanel=visible,visible?$preHeaderPanelScroller.slideDown("fast",resizeCanvas):$preHeaderPanelScroller.slideUp("fast",resizeCanvas))}function getContainerNode(){return $container.get(0)}function getRowTop(row){return options.rowHeight*row-offset}function getRowFromPosition(y){return Math.floor((y+offset)/options.rowHeight)}function scrollTo(y){y=Math.max(y,0),y=Math.min(y,th-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0));var oldOffset=offset;page=Math.min(n-1,Math.floor(y/ph));var newScrollTop=y-(offset=Math.round(page*cj));offset!=oldOffset&&(cleanupRows(getVisibleRange(newScrollTop)),updateRowPositions()),prevScrollTop!=newScrollTop&&(vScrollDir=prevScrollTop+oldOffset<newScrollTop+offset?1:-1,$viewport[0].scrollTop=lastRenderedScrollTop=scrollTop=prevScrollTop=newScrollTop,trigger(self.onViewportChanged,{}))}function defaultFormatter(row,cell,value,columnDef,dataContext,grid){return null==value?"":(value+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(row,column){var rowMetadata=data.getItemMetadata&&data.getItemMetadata(row),columnOverrides=rowMetadata&&rowMetadata.columns&&(rowMetadata.columns[column.id]||rowMetadata.columns[getColumnIndex(column.id)]);return columnOverrides&&columnOverrides.formatter||rowMetadata&&rowMetadata.formatter||column.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(column)||options.defaultFormatter}function getEditor(row,cell){var column=columns[cell],rowMetadata=data.getItemMetadata&&data.getItemMetadata(row),columnMetadata=rowMetadata&&rowMetadata.columns;return columnMetadata&&columnMetadata[column.id]&&void 0!==columnMetadata[column.id].editor?columnMetadata[column.id].editor:columnMetadata&&columnMetadata[cell]&&void 0!==columnMetadata[cell].editor?columnMetadata[cell].editor:column.editor||options.editorFactory&&options.editorFactory.getEditor(column)}function getDataItemValueForColumn(item,columnDef){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(item,columnDef):item[columnDef.field]}function appendRowHtml(stringArray,row,range,dataLength){var d=getDataItem(row),rowCss="slick-row"+(row<dataLength&&!d?" loading":"")+(row===activeRow&&options.showCellSelection?" active":"")+(row%2==1?" odd":" even");d||(rowCss+=" "+options.addNewRowCssClass);var colspan,m,metadata=data.getItemMetadata&&data.getItemMetadata(row);metadata&&metadata.cssClasses&&(rowCss+=" "+metadata.cssClasses),stringArray.push("<div class='ui-widget-content "+rowCss+"' style='top:"+getRowTop(row)+"px'>");for(var i=0,ii=columns.length;i<ii;i++){if(m=columns[i],colspan=1,metadata&&metadata.columns){var columnData=metadata.columns[m.id]||metadata.columns[i];"*"===(colspan=columnData&&columnData.colspan||1)&&(colspan=ii-i)}if(columnPosRight[Math.min(ii-1,i+colspan-1)]>range.leftPx){if(columnPosLeft[i]>range.rightPx)break;appendCellHtml(stringArray,row,i,colspan,d)}colspan>1&&(i+=colspan-1)}stringArray.push("</div>")}function appendCellHtml(stringArray,row,cell,colspan,item){var m=columns[cell],cellCss="slick-cell l"+cell+" r"+Math.min(columns.length-1,cell+colspan-1)+(m.cssClass?" "+m.cssClass:"");for(var key in row===activeRow&&cell===activeCell&&options.showCellSelection&&(cellCss+=" active"),cellCssClasses)cellCssClasses[key][row]&&cellCssClasses[key][row][m.id]&&(cellCss+=" "+cellCssClasses[key][row][m.id]);var value=null,formatterResult="";item&&(value=getDataItemValueForColumn(item,m),null!==(formatterResult=getFormatter(row,m)(row,cell,value,m,item,self))&&void 0!==formatterResult||(formatterResult=""));var addlCssClasses=trigger(self.onBeforeAppendCell,{row:row,cell:cell,value:value,dataContext:item})||"";addlCssClasses+=formatterResult&&formatterResult.addClasses?(addlCssClasses?" ":"")+formatterResult.addClasses:"",stringArray.push("<div class='"+cellCss+(addlCssClasses?" "+addlCssClasses:"")+"'>"),item&&stringArray.push("[object Object]"!==Object.prototype.toString.call(formatterResult)?formatterResult:formatterResult.text),stringArray.push("</div>"),rowsCache[row].cellRenderQueue.push(cell),rowsCache[row].cellColSpans[cell]=colspan}function cleanupRows(rangeToKeep){for(var i in rowsCache)(i=parseInt(i,10))!==activeRow&&(i<rangeToKeep.top||i>rangeToKeep.bottom)&&removeRowFromCache(i);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){for(var row in currentEditor&&makeActiveCellNormal(),rowsCache)removeRowFromCache(row);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function queuePostProcessedRowForCleanup(cacheEntry,postProcessedRow,rowIdx){for(var columnIdx in postProcessgroupId++,postProcessedRow)postProcessedRow.hasOwnProperty(columnIdx)&&postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:cacheEntry.cellNodesByColumnIdx[0|columnIdx],columnIdx:0|columnIdx,rowIdx:rowIdx});postProcessedCleanupQueue.push({actionType:"R",groupId:postProcessgroupId,node:cacheEntry.rowNode}),$(cacheEntry.rowNode).detach()}function queuePostProcessedCellForCleanup(cellnode,columnIdx,rowIdx){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:cellnode,columnIdx:columnIdx,rowIdx:rowIdx}),$(cellnode).detach()}function removeRowFromCache(row){var cacheEntry=rowsCache[row];cacheEntry&&(cacheEntry.rowNode&&(rowNodeFromLastMouseWheelEvent===cacheEntry.rowNode?(cacheEntry.rowNode.style.display="none",zombieRowNodeFromLastMouseWheelEvent=rowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent=cacheEntry,zombieRowPostProcessedFromLastMouseWheelEvent=postProcessedRows[row]):options.enableAsyncPostRenderCleanup&&postProcessedRows[row]?queuePostProcessedRowForCleanup(cacheEntry,postProcessedRows[row],row):$canvas[0].removeChild(cacheEntry.rowNode)),delete rowsCache[row],delete postProcessedRows[row],renderedRows--,counter_rows_removed++)}function invalidateRows(rows){var i,rl;if(rows&&rows.length){for(vScrollDir=0,rl=rows.length,i=0;i<rl;i++)currentEditor&&activeRow===rows[i]&&makeActiveCellNormal(),rowsCache[rows[i]]&&removeRowFromCache(rows[i]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(row){(row||0===row)&&invalidateRows([row])}function applyFormatResultToCellNode(formatterResult,cellNode,suppressRemove){null!==formatterResult&&void 0!==formatterResult||(formatterResult=""),"[object Object]"===Object.prototype.toString.call(formatterResult)?(cellNode.innerHTML=formatterResult.text,formatterResult.removeClasses&&!suppressRemove&&$(cellNode).removeClass(formatterResult.removeClasses),formatterResult.addClasses&&$(cellNode).addClass(formatterResult.addClasses)):cellNode.innerHTML=formatterResult}function updateCell(row,cell){var cellNode=getCellNode(row,cell);if(cellNode){var m=columns[cell],d=getDataItem(row);currentEditor&&activeRow===row&&activeCell===cell?currentEditor.loadValue(d):(applyFormatResultToCellNode(d?getFormatter(row,m)(row,cell,getDataItemValueForColumn(d,m),m,d,self):"",cellNode),invalidatePostProcessingResults(row))}}function updateRow(row){var cacheEntry=rowsCache[row];if(cacheEntry){ensureCellNodesInRowsCache(row);var d=getDataItem(row);for(var columnIdx in cacheEntry.cellNodesByColumnIdx)if(cacheEntry.cellNodesByColumnIdx.hasOwnProperty(columnIdx)){var m=columns[columnIdx|=0],node=cacheEntry.cellNodesByColumnIdx[columnIdx];row===activeRow&&columnIdx===activeCell&&currentEditor?currentEditor.loadValue(d):d?applyFormatResultToCellNode(getFormatter(row,m)(row,columnIdx,getDataItemValueForColumn(d,m),m,d,self),node):node.innerHTML=""}invalidatePostProcessingResults(row)}}function getViewportHeight(){return parseFloat($.css($container[0],"height",!0))-parseFloat($.css($container[0],"paddingTop",!0))-parseFloat($.css($container[0],"paddingBottom",!0))-parseFloat($.css($headerScroller[0],"height"))-getVBoxDelta($headerScroller)-(options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0)-(options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0)-(options.createFooterRow&&options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0)-(options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0)}function resizeCanvas(){initialized&&(viewportH=options.autoHeight?options.rowHeight*getDataLengthIncludingAddNew():getViewportHeight(),numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportW=parseFloat($.css($container[0],"width",!0)),options.autoHeight||$viewport.height(viewportH),scrollbarDimensions&&scrollbarDimensions.width||(scrollbarDimensions=measureScrollbar()),options.forceFitColumns&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render())}function updatePagingStatusFromView(pagingInfo){pagingActive=0!==pagingInfo.pageSize,pagingIsLastPage=pagingInfo.pageNum==pagingInfo.totalPages-1}function updateRowCount(){if(initialized){var dataLength=getDataLength(),numberOfRows=getDataLengthIncludingAddNew()+(options.leaveSpaceForNewRows?numVisibleRows-1:0),oldViewportHasVScroll=viewportHasVScroll;viewportHasVScroll=options.alwaysShowVerticalScroll||!options.autoHeight&&numberOfRows*options.rowHeight>viewportH,viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width,makeActiveCellNormal();var r1=dataLength-1;for(var i in rowsCache)i>r1&&removeRowFromCache(i);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&activeRow>r1&&resetActiveCell();var oldH=h;(th=Math.max(options.rowHeight*numberOfRows,viewportH-scrollbarDimensions.height))<maxSupportedCssHeight?(h=ph=th,n=1,cj=0):(ph=(h=maxSupportedCssHeight)/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==oldH&&($canvas.css("height",h),scrollTop=$viewport[0].scrollTop);var oldScrollTopInRange=scrollTop+offset<=th-viewportH;0==th||0==scrollTop?page=offset=0:scrollTo(oldScrollTopInRange?scrollTop+offset:th-viewportH),h!=oldH&&options.autoHeight&&resizeCanvas(),options.forceFitColumns&&oldViewportHasVScroll!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(viewportTop,viewportLeft){return null==viewportTop&&(viewportTop=scrollTop),null==viewportLeft&&(viewportLeft=scrollLeft),{top:getRowFromPosition(viewportTop),bottom:getRowFromPosition(viewportTop+viewportH)+1,leftPx:viewportLeft,rightPx:viewportLeft+viewportW}}function getRenderedRange(viewportTop,viewportLeft){var range=getVisibleRange(viewportTop,viewportLeft),buffer=Math.round(viewportH/options.rowHeight),minBuffer=options.minRowBuffer;return-1==vScrollDir?(range.top-=buffer,range.bottom+=minBuffer):1==vScrollDir?(range.top-=minBuffer,range.bottom+=buffer):(range.top-=minBuffer,range.bottom+=minBuffer),range.top=Math.max(0,range.top),range.bottom=Math.min(getDataLengthIncludingAddNew()-1,range.bottom),range.leftPx-=viewportW,range.rightPx+=viewportW,range.leftPx=Math.max(0,range.leftPx),range.rightPx=Math.min(canvasWidth,range.rightPx),range}function ensureCellNodesInRowsCache(row){var cacheEntry=rowsCache[row];if(cacheEntry&&cacheEntry.cellRenderQueue.length)for(var lastChild=cacheEntry.rowNode.lastChild;cacheEntry.cellRenderQueue.length;){var columnIdx=cacheEntry.cellRenderQueue.pop();cacheEntry.cellNodesByColumnIdx[columnIdx]=lastChild,lastChild=lastChild.previousSibling}}function cleanUpCells(range,row){var cellToRemove,node,cacheEntry=rowsCache[row],cellsToRemove=[];for(var i in cacheEntry.cellNodesByColumnIdx)if(cacheEntry.cellNodesByColumnIdx.hasOwnProperty(i)){i|=0;var colspan=cacheEntry.cellColSpans[i];(columnPosLeft[i]>range.rightPx||columnPosRight[Math.min(columns.length-1,i+colspan-1)]<range.leftPx)&&(row==activeRow&&i==activeCell||cellsToRemove.push(i))}for(postProcessgroupId++;null!=(cellToRemove=cellsToRemove.pop());)node=cacheEntry.cellNodesByColumnIdx[cellToRemove],options.enableAsyncPostRenderCleanup&&postProcessedRows[row]&&postProcessedRows[row][cellToRemove]?queuePostProcessedCellForCleanup(node,cellToRemove,row):cacheEntry.rowNode.removeChild(node),delete cacheEntry.cellColSpans[cellToRemove],delete cacheEntry.cellNodesByColumnIdx[cellToRemove],postProcessedRows[row]&&delete postProcessedRows[row][cellToRemove]}function cleanUpAndRenderCells(range){for(var cacheEntry,cellsAdded,colspan,stringArray=[],processedRows=[],row=range.top,btm=range.bottom;row<=btm;row++)if(cacheEntry=rowsCache[row]){ensureCellNodesInRowsCache(row),cleanUpCells(range,row),cellsAdded=0;var metadata=data.getItemMetadata&&data.getItemMetadata(row);metadata=metadata&&metadata.columns;for(var d=getDataItem(row),i=0,ii=columns.length;i<ii&&!(columnPosLeft[i]>range.rightPx);i++)if(null==(colspan=cacheEntry.cellColSpans[i])){if(colspan=1,metadata){var columnData=metadata[columns[i].id]||metadata[i];"*"===(colspan=columnData&&columnData.colspan||1)&&(colspan=ii-i)}columnPosRight[Math.min(ii-1,i+colspan-1)]>range.leftPx&&(appendCellHtml(stringArray,row,i,colspan,d),cellsAdded++),i+=colspan>1?colspan-1:0}else i+=colspan>1?colspan-1:0;cellsAdded&&processedRows.push(row)}if(stringArray.length){var processedRow,node,x=document.createElement("div");for(x.innerHTML=stringArray.join("");null!=(processedRow=processedRows.pop());){var columnIdx;for(cacheEntry=rowsCache[processedRow];null!=(columnIdx=cacheEntry.cellRenderQueue.pop());)node=x.lastChild,cacheEntry.rowNode.appendChild(node),cacheEntry.cellNodesByColumnIdx[columnIdx]=node}}}function renderRows(range){for(var parentNode=$canvas[0],stringArray=[],rows=[],needToReselectCell=!1,dataLength=getDataLength(),i=range.top,ii=range.bottom;i<=ii;i++)rowsCache[i]||(renderedRows++,rows.push(i),rowsCache[i]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(stringArray,i,range,dataLength),activeCellNode&&activeRow===i&&(needToReselectCell=!0),counter_rows_rendered++);if(rows.length){var x=document.createElement("div");for(x.innerHTML=stringArray.join(""),i=0,ii=rows.length;i<ii;i++)rowsCache[rows[i]].rowNode=parentNode.appendChild(x.firstChild);needToReselectCell&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(row){for(var columnIdx in postProcessedRows[row])postProcessedRows[row].hasOwnProperty(columnIdx)&&(postProcessedRows[row][columnIdx]="C");postProcessFromRow=Math.min(postProcessFromRow,row),postProcessToRow=Math.max(postProcessToRow,row),startPostProcessing()}function updateRowPositions(){for(var row in rowsCache)rowsCache[row].rowNode.style.top=getRowTop(row)+"px"}function render(){if(initialized){scrollThrottle.dequeue();var visible=getVisibleRange(),rendered=getRenderedRange();cleanupRows(rendered),lastRenderedScrollLeft!=scrollLeft&&cleanUpAndRenderCells(rendered),renderRows(rendered),postProcessFromRow=visible.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,visible.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null}}function handleHeaderScroll(){handleElementScroll($headerScroller[0])}function handleHeaderRowScroll(){handleElementScroll($headerRowScroller[0])}function handleFooterRowScroll(){handleElementScroll($footerRowScroller[0])}function handlePreHeaderPanelScroll(){handleElementScroll($preHeaderPanelScroller[0])}function handleElementScroll(element){var scrollLeft=element.scrollLeft;scrollLeft!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=scrollLeft)}function handleScroll(){scrollTop=$viewport[0].scrollTop,scrollLeft=$viewport[0].scrollLeft;var vScrollDist=Math.abs(scrollTop-prevScrollTop),hScrollDist=Math.abs(scrollLeft-prevScrollLeft);if(hScrollDist&&(prevScrollLeft=scrollLeft,$headerScroller[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScroller[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScroller[0].scrollLeft=scrollLeft),options.createPreHeaderPanel&&($preHeaderPanelScroller[0].scrollLeft=scrollLeft)),vScrollDist)if(vScrollDir=prevScrollTop<scrollTop?1:-1,prevScrollTop=scrollTop,vScrollDist<viewportH)scrollTo(scrollTop+offset);else{var oldOffset=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),oldOffset!=(offset=Math.round(page*cj))&&invalidateAllRows()}if(hScrollDist||vScrollDist){var dx=Math.abs(lastRenderedScrollLeft-scrollLeft),dy=Math.abs(lastRenderedScrollTop-scrollTop);(dx>20||dy>20)&&(options.forceSyncScrolling||dy<viewportH&&dx<viewportW?render():scrollThrottle.enqueue(),trigger(self.onViewportChanged,{}))}trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop})}function ActionThrottle(action,minPeriod_ms){var blocked=!1,queued=!1;function dequeue(){queued=!1}function blockAndExecute(){blocked=!0,setTimeout(unblock,minPeriod_ms),action()}function unblock(){queued?(dequeue(),blockAndExecute()):blocked=!1}return{enqueue:function(){blocked?queued=!0:blockAndExecute()},dequeue:dequeue}}function asyncPostProcessRows(){for(var dataLength=getDataLength();postProcessFromRow<=postProcessToRow;){var row=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,cacheEntry=rowsCache[row];if(cacheEntry&&!(row>=dataLength)){for(var columnIdx in postProcessedRows[row]||(postProcessedRows[row]={}),ensureCellNodesInRowsCache(row),cacheEntry.cellNodesByColumnIdx)if(cacheEntry.cellNodesByColumnIdx.hasOwnProperty(columnIdx)){var m=columns[columnIdx|=0],processedStatus=postProcessedRows[row][columnIdx];if(m.asyncPostRender&&"R"!==processedStatus){var node=cacheEntry.cellNodesByColumnIdx[columnIdx];node&&m.asyncPostRender(node,row,getDataItem(row),m,"C"===processedStatus),postProcessedRows[row][columnIdx]="R"}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){for(var groupId=postProcessedCleanupQueue[0].groupId;postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==groupId;){var entry=postProcessedCleanupQueue.shift();if("R"==entry.actionType&&$(entry.node).remove(),"C"==entry.actionType){var column=columns[entry.columnIdx];column.asyncPostRenderCleanup&&entry.node&&column.asyncPostRenderCleanup(entry.node,entry.rowIdx,column)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(addedHash,removedHash){var node,columnId,addedRowHash,removedRowHash;for(var row in rowsCache){if(removedRowHash=removedHash&&removedHash[row],addedRowHash=addedHash&&addedHash[row],removedRowHash)for(columnId in removedRowHash)addedRowHash&&removedRowHash[columnId]==addedRowHash[columnId]||(node=getCellNode(row,getColumnIndex(columnId)))&&$(node).removeClass(removedRowHash[columnId]);if(addedRowHash)for(columnId in addedRowHash)removedRowHash&&removedRowHash[columnId]==addedRowHash[columnId]||(node=getCellNode(row,getColumnIndex(columnId)))&&$(node).addClass(addedRowHash[columnId])}}function addCellCssStyles(key,hash){if(cellCssClasses[key])throw new Error("addCellCssStyles: cell CSS hash with key '"+key+"' already exists.");cellCssClasses[key]=hash,updateCellCssStylesOnRenderedRows(hash,null),trigger(self.onCellCssStylesChanged,{key:key,hash:hash,grid:self})}function removeCellCssStyles(key){cellCssClasses[key]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[key]),delete cellCssClasses[key],trigger(self.onCellCssStylesChanged,{key:key,hash:null,grid:self}))}function setCellCssStyles(key,hash){var prevHash=cellCssClasses[key];cellCssClasses[key]=hash,updateCellCssStylesOnRenderedRows(hash,prevHash),trigger(self.onCellCssStylesChanged,{key:key,hash:hash,grid:self})}function getCellCssStyles(key){return cellCssClasses[key]}function flashCell(row,cell,speed){if(speed=speed||100,rowsCache[row]){var $cell=$(getCellNode(row,cell));!function toggleCellClass(times){times&&setTimeout(function(){$cell.queue(function(){$cell.toggleClass(options.cellFlashingCssClass).dequeue(),toggleCellClass(times-1)})},speed)}(4)}}function handleMouseWheel(e){var rowNode=$(e.target).closest(".slick-row")[0];rowNode!=rowNodeFromLastMouseWheelEvent&&(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent!=rowNode&&(options.enableAsyncPostRenderCleanup&&zombieRowPostProcessedFromLastMouseWheelEvent?queuePostProcessedRowForCleanup(zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent):$canvas[0].removeChild(zombieRowNodeFromLastMouseWheelEvent),zombieRowNodeFromLastMouseWheelEvent=null,zombieRowCacheFromLastMouseWheelEvent=null,zombieRowPostProcessedFromLastMouseWheelEvent=null,options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()),rowNodeFromLastMouseWheelEvent=rowNode)}function handleDragInit(e,dd){var cell=getCellFromEvent(e);if(!cell||!cellExists(cell.row,cell.cell))return!1;var retval=trigger(self.onDragInit,dd,e);return!!e.isImmediatePropagationStopped()&&retval}function handleDragStart(e,dd){var cell=getCellFromEvent(e);if(!cell||!cellExists(cell.row,cell.cell))return!1;var retval=trigger(self.onDragStart,dd,e);return!!e.isImmediatePropagationStopped()&&retval}function handleDrag(e,dd){return trigger(self.onDrag,dd,e)}function handleDragEnd(e,dd){trigger(self.onDragEnd,dd,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var handled=e.isImmediatePropagationStopped(),keyCode=Slick.keyCode;if(!handled&&!e.shiftKey&&!e.altKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.which==keyCode.HOME?handled=e.ctrlKey?navigateTop():navigateRowStart():e.which==keyCode.END&&(handled=e.ctrlKey?navigateBottom():navigateRowEnd())}if(!handled)if(e.shiftKey||e.altKey||e.ctrlKey)e.which!=keyCode.TAB||!e.shiftKey||e.ctrlKey||e.altKey||(handled=navigatePrev());else{if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which==keyCode.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else e.which==keyCode.PAGE_DOWN?(navigatePageDown(),handled=!0):e.which==keyCode.PAGE_UP?(navigatePageUp(),handled=!0):e.which==keyCode.LEFT?handled=navigateLeft():e.which==keyCode.RIGHT?handled=navigateRight():e.which==keyCode.UP?handled=navigateUp():e.which==keyCode.DOWN?handled=navigateDown():e.which==keyCode.TAB?handled=navigateNext():e.which==keyCode.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable()),handled=!0)}if(handled){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(error){}}}function handleClick(e){currentEditor||(e.target!=document.activeElement||$(e.target).hasClass("slick-cell"))&&setFocus();var cell=getCellFromEvent(e);if(cell&&(null===currentEditor||activeRow!=cell.row||activeCell!=cell.cell)&&(trigger(self.onClick,{row:cell.row,cell:cell.cell},e),!e.isImmediatePropagationStopped()&&canCellBeActive(cell.row,cell.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()))){scrollRowIntoView(cell.row,!1);var preClickModeOn=e.target&&e.target.className===Slick.preClickClassName,column=columns[cell.cell],suppressActiveCellChangedEvent=!!(options.editable&&column&&column.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(getCellNode(cell.row,cell.cell),null,preClickModeOn,suppressActiveCellChangedEvent)}}function handleContextMenu(e){var $cell=$(e.target).closest(".slick-cell",$canvas);0!==$cell.length&&(activeCellNode===$cell[0]&&null!==currentEditor||trigger(self.onContextMenu,{},e))}function handleDblClick(e){var cell=getCellFromEvent(e);!cell||null!==currentEditor&&activeRow==cell.row&&activeCell==cell.cell||(trigger(self.onDblClick,{row:cell.row,cell:cell.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(cell.row,cell.cell,!0))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$(this).data("column"),grid:self},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$(this).data("column"),grid:self},e)}function handleHeaderContextMenu(e){var $header=$(e.target).closest(".slick-header-column",".slick-header-columns"),column=$header&&$header.data("column");trigger(self.onHeaderContextMenu,{column:column},e)}function handleHeaderClick(e){if(!columnResizeDragging){var $header=$(e.target).closest(".slick-header-column",".slick-header-columns"),column=$header&&$header.data("column");column&&trigger(self.onHeaderClick,{column:column},e)}}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(row,cell){return!(row<0||row>=getDataLength()||cell<0||cell>=columns.length)}function getCellFromPoint(x,y){for(var row=getRowFromPosition(y),cell=0,w=0,i=0;i<columns.length&&w<x;i++)w+=columns[i].width,cell++;return cell<0&&(cell=0),{row:row,cell:cell-1}}function getCellFromNode(cellNode){var cls=/l\d+/.exec(cellNode.className);if(!cls)throw new Error("getCellFromNode: cannot get cell - "+cellNode.className);return parseInt(cls[0].substr(1,cls[0].length-1),10)}function getRowFromNode(rowNode){for(var row in rowsCache)if(rowsCache[row].rowNode===rowNode)return 0|row;return null}function getCellFromEvent(e){var $cell=$(e.target).closest(".slick-cell",$canvas);if(!$cell.length)return null;var row=getRowFromNode($cell[0].parentNode),cell=getCellFromNode($cell[0]);return null==row||null==cell?null:{row:row,cell:cell}}function getCellNodeBox(row,cell){if(!cellExists(row,cell))return null;for(var y1=getRowTop(row),y2=y1+options.rowHeight-1,x1=0,i=0;i<cell;i++)x1+=columns[i].width;return{top:y1,left:x1,bottom:y2,right:x1+columns[cell].width}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(row,cell,doPaging){scrollRowIntoView(row,doPaging);var colspan=getColspan(row,cell);internalScrollColumnIntoView(columnPosLeft[cell],columnPosRight[cell+(colspan>1?colspan-1:0)])}function internalScrollColumnIntoView(left,right){var scrollRight=scrollLeft+viewportW;left<scrollLeft?($viewport.scrollLeft(left),handleScroll(),render()):right>scrollRight&&($viewport.scrollLeft(Math.min(left,right-$viewport[0].clientWidth)),handleScroll(),render())}function scrollColumnIntoView(cell){internalScrollColumnIntoView(columnPosLeft[cell],columnPosRight[cell])}function setActiveCellInternal(newCell,opt_editMode,preClickModeOn,suppressActiveCellChangedEvent){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass("active"),rowsCache[activeRow]&&$(rowsCache[activeRow].rowNode).removeClass("active")),null!=(activeCellNode=newCell)?(activeRow=getRowFromNode(activeCellNode.parentNode),activeCell=activePosX=getCellFromNode(activeCellNode),null==opt_editMode&&(opt_editMode=activeRow==getDataLength()||options.autoEdit),options.showCellSelection&&($(activeCellNode).addClass("active"),$(rowsCache[activeRow].rowNode).addClass("active")),options.editable&&opt_editMode&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout(function(){makeActiveCellEditable(void 0,preClickModeOn)},options.asyncEditorLoadDelay):makeActiveCellEditable(void 0,preClickModeOn))):activeRow=activeCell=null,suppressActiveCellChangedEvent||trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){var sel=window.getSelection();sel&&sel.removeAllRanges&&sel.removeAllRanges()}}function isCellPotentiallyEditable(row,cell){var dataLength=getDataLength();return!(row<dataLength&&!getDataItem(row)||columns[cell].cannotTriggerInsert&&row>=dataLength||!getEditor(row,cell))}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var d=getDataItem(activeRow);if($(activeCellNode).removeClass("editable invalid"),d){var column=columns[activeCell];applyFormatResultToCellNode(getFormatter(activeRow,column)(activeRow,activeCell,getDataItemValueForColumn(d,column),column,d,self),activeCellNode),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(editor,preClickModeOn){if(activeCellNode){if(!options.editable)throw new Error("Grid : makeActiveCellEditable : should never get called when options.editable is false");if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var columnDef=columns[activeCell],item=getDataItem(activeRow);if(!1!==trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:item,column:columnDef})){getEditorLock().activate(editController),$(activeCellNode).addClass("editable");var useEditor=editor||getEditor(activeRow,activeCell);editor||useEditor.suppressClearOnEdit||(activeCellNode.innerHTML=""),currentEditor=new useEditor({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:columnDef,item:item||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),item&&(currentEditor.loadValue(item),preClickModeOn&&currentEditor.preClick&&currentEditor.preClick()),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}else setFocus()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(elem){var box={top:elem.offsetTop,left:elem.offsetLeft,bottom:0,right:0,width:$(elem).outerWidth(),height:$(elem).outerHeight(),visible:!0};box.bottom=box.top+box.height,box.right=box.left+box.width;for(var offsetParent=elem.offsetParent;(elem=elem.parentNode)!=document.body&&null!=elem;)box.visible&&elem.scrollHeight!=elem.offsetHeight&&"visible"!=$(elem).css("overflowY")&&(box.visible=box.bottom>elem.scrollTop&&box.top<elem.scrollTop+elem.clientHeight),box.visible&&elem.scrollWidth!=elem.offsetWidth&&"visible"!=$(elem).css("overflowX")&&(box.visible=box.right>elem.scrollLeft&&box.left<elem.scrollLeft+elem.clientWidth),box.left-=elem.scrollLeft,box.top-=elem.scrollTop,elem===offsetParent&&(box.left+=elem.offsetLeft,box.top+=elem.offsetTop,offsetParent=elem.offsetParent),box.bottom=box.top+box.height,box.right=box.left+box.width;return box}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var cellBox=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(cellBox.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(cellBox)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(row,doPaging){var rowAtTop=row*options.rowHeight,rowAtBottom=(row+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);(row+1)*options.rowHeight>scrollTop+viewportH+offset?(scrollTo(doPaging?rowAtTop:rowAtBottom),render()):row*options.rowHeight<scrollTop+offset&&(scrollTo(doPaging?rowAtBottom:rowAtTop),render())}function scrollRowToTop(row){scrollTo(row*options.rowHeight),render()}function scrollPage(dir){var deltaRows=dir*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop)+deltaRows)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var row=activeRow+deltaRows,dataLengthIncludingAddNew=getDataLengthIncludingAddNew();row>=dataLengthIncludingAddNew&&(row=dataLengthIncludingAddNew-1),row<0&&(row=0);for(var cell=0,prevCell=null,prevActivePosX=activePosX;cell<=activePosX;)canCellBeActive(row,cell)&&(prevCell=cell),cell+=getColspan(row,cell);null!==prevCell?(setActiveCellInternal(getCellNode(row,prevCell)),activePosX=prevActivePosX):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function navigateTop(){navigateToRow(0)}function navigateBottom(){navigateToRow(getDataLength()-1)}function navigateToRow(row){var num_rows=getDataLength();if(!num_rows)return!0;if(row<0?row=0:row>=num_rows&&(row=num_rows-1),scrollCellIntoView(row,0,!0),options.enableCellNavigation&&null!=activeRow){for(var cell=0,prevCell=null,prevActivePosX=activePosX;cell<=activePosX;)canCellBeActive(row,cell)&&(prevCell=cell),cell+=getColspan(row,cell);null!==prevCell?(setActiveCellInternal(getCellNode(row,prevCell)),activePosX=prevActivePosX):resetActiveCell()}return!0}function getColspan(row,cell){var metadata=data.getItemMetadata&&data.getItemMetadata(row);if(!metadata||!metadata.columns)return 1;var columnData=metadata.columns[columns[cell].id]||metadata.columns[cell],colspan=columnData&&columnData.colspan;return"*"===colspan?columns.length-cell:colspan||1}function findFirstFocusableCell(row){for(var cell=0;cell<columns.length;){if(canCellBeActive(row,cell))return cell;cell+=getColspan(row,cell)}return null}function findLastFocusableCell(row){for(var cell=0,lastFocusableCell=null;cell<columns.length;)canCellBeActive(row,cell)&&(lastFocusableCell=cell),cell+=getColspan(row,cell);return lastFocusableCell}function gotoRight(row,cell,posX){if(cell>=columns.length)return null;do{cell+=getColspan(row,cell)}while(cell<columns.length&&!canCellBeActive(row,cell));return cell<columns.length?{row:row,cell:cell,posX:cell}:null}function gotoLeft(row,cell,posX){if(cell<=0)return null;var firstFocusableCell=findFirstFocusableCell(row);if(null===firstFocusableCell||firstFocusableCell>=cell)return null;for(var pos,prev={row:row,cell:firstFocusableCell,posX:firstFocusableCell};;){if(!(pos=gotoRight(prev.row,prev.cell,prev.posX)))return null;if(pos.cell>=cell)return prev;prev=pos}}function gotoDown(row,cell,posX){for(var prevCell,dataLengthIncludingAddNew=getDataLengthIncludingAddNew();;){if(++row>=dataLengthIncludingAddNew)return null;for(prevCell=cell=0;cell<=posX;)prevCell=cell,cell+=getColspan(row,cell);if(canCellBeActive(row,prevCell))return{row:row,cell:prevCell,posX:posX}}}function gotoUp(row,cell,posX){for(var prevCell;;){if(--row<0)return null;for(prevCell=cell=0;cell<=posX;)prevCell=cell,cell+=getColspan(row,cell);if(canCellBeActive(row,prevCell))return{row:row,cell:prevCell,posX:posX}}}function gotoNext(row,cell,posX){if(null==row&&null==cell&&canCellBeActive(row=cell=posX=0,cell))return{row:row,cell:cell,posX:cell};var pos=gotoRight(row,cell,posX);if(pos)return pos;var firstFocusableCell=null,dataLengthIncludingAddNew=getDataLengthIncludingAddNew();for(row===dataLengthIncludingAddNew-1&&row--;++row<dataLengthIncludingAddNew;)if(null!==(firstFocusableCell=findFirstFocusableCell(row)))return{row:row,cell:firstFocusableCell,posX:firstFocusableCell};return null}function gotoPrev(row,cell,posX){if(null==row&&null==cell&&canCellBeActive(row=getDataLengthIncludingAddNew()-1,cell=posX=columns.length-1))return{row:row,cell:cell,posX:cell};for(var pos,lastSelectableCell;!pos&&!(pos=gotoLeft(row,cell,posX));){if(--row<0)return null;cell=0,null!==(lastSelectableCell=findLastFocusableCell(row))&&(pos={row:row,cell:lastSelectableCell,posX:lastSelectableCell})}return pos}function gotoRowStart(row,cell,posX){var newCell=findFirstFocusableCell(row);return null===newCell?null:{row:row,cell:newCell,posX:posX}}function gotoRowEnd(row,cell,posX){var newCell=findLastFocusableCell(row);return null===newCell?null:{row:row,cell:newCell,posX:posX}}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigateRowStart(){return navigate("home")}function navigateRowEnd(){return navigate("end")}function navigate(dir){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=dir&&"next"!=dir)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus(),tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[dir];var pos=(0,{up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext,home:gotoRowStart,end:gotoRowEnd}[dir])(activeRow,activeCell,activePosX);if(pos){var isAddNewRow=pos.row==getDataLength();return scrollCellIntoView(pos.row,pos.cell,!isAddNewRow&&options.emulatePagingWhenScrolling),setActiveCellInternal(getCellNode(pos.row,pos.cell)),activePosX=pos.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(row,cell){return rowsCache[row]?(ensureCellNodesInRowsCache(row),rowsCache[row].cellNodesByColumnIdx[cell]):null}function setActiveCell(row,cell,opt_editMode,preClickModeOn,suppressActiveCellChangedEvent){initialized&&(row>getDataLength()||row<0||cell>=columns.length||cell<0||options.enableCellNavigation&&(scrollCellIntoView(row,cell,!1),setActiveCellInternal(getCellNode(row,cell),opt_editMode,preClickModeOn,suppressActiveCellChangedEvent)))}function canCellBeActive(row,cell){if(!options.enableCellNavigation||row>=getDataLengthIncludingAddNew()||row<0||cell>=columns.length||cell<0)return!1;var rowMetadata=data.getItemMetadata&&data.getItemMetadata(row);if(rowMetadata&&void 0!==rowMetadata.focusable)return!!rowMetadata.focusable;var columnMetadata=rowMetadata&&rowMetadata.columns;return columnMetadata&&columnMetadata[columns[cell].id]&&void 0!==columnMetadata[columns[cell].id].focusable?!!columnMetadata[columns[cell].id].focusable:columnMetadata&&columnMetadata[cell]&&void 0!==columnMetadata[cell].focusable?!!columnMetadata[cell].focusable:!!columns[cell].focusable}function canCellBeSelected(row,cell){if(row>=getDataLength()||row<0||cell>=columns.length||cell<0)return!1;var rowMetadata=data.getItemMetadata&&data.getItemMetadata(row);if(rowMetadata&&void 0!==rowMetadata.selectable)return!!rowMetadata.selectable;var columnMetadata=rowMetadata&&rowMetadata.columns&&(rowMetadata.columns[columns[cell].id]||rowMetadata.columns[cell]);return columnMetadata&&void 0!==columnMetadata.selectable?!!columnMetadata.selectable:!!columns[cell].selectable}function gotoCell(row,cell,forceEdit){initialized&&canCellBeActive(row,cell)&&getEditorLock().commitCurrentEdit()&&(scrollCellIntoView(row,cell,!1),setActiveCellInternal(getCellNode(row,cell),forceEdit||row===getDataLength()||options.autoEdit,null,options.editable),currentEditor||setFocus())}function commitCurrentEdit(){var item=getDataItem(activeRow),column=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var validationResults=currentEditor.validate();if(validationResults.valid){if(activeRow<getDataLength()){var editCommand={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(item,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:item})},undo:function(){this.editor.applyValue(item,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:item})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(item,column,editCommand)):(editCommand.execute(),makeActiveCellNormal())}else{var newItem={};currentEditor.applyValue(newItem,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:newItem,column:column})}return!getEditorLock().isActive()}return $(activeCellNode).removeClass("invalid"),$(activeCellNode).width(),$(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:validationResults,row:activeRow,cell:activeCell,column:column}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(rows){for(var ranges=[],lastCell=columns.length-1,i=0;i<rows.length;i++)ranges.push(new Slick.Range(rows[i],0,rows[i],lastCell));return ranges}function getSelectedRows(){if(!selectionModel)throw new Error("Selection model is not set");return selectedRows}function setSelectedRows(rows){if(!selectionModel)throw new Error("Selection model is not set");selectionModel.setSelectedRanges(rowsToRanges(rows))}this.debug=function(){var s="";s+="\ncounter_rows_rendered:  "+counter_rows_rendered,s+="\ncounter_rows_removed:  "+counter_rows_removed,s+="\nrenderedRows:  "+renderedRows,s+="\nnumVisibleRows:  "+numVisibleRows,s+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,s+="\nn(umber of pages):  "+n,s+="\n(current) page:  "+page,s+="\npage height (ph):  "+ph,s+="\nvScrollDir:  "+vScrollDir,alert(s)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:"2.3.21",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onFooterRowCellRendered:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onBeforeFooterRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onBeforeAppendCell:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,onAutosizeColumns:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,updatePagingStatusFromView:updatePagingStatusFromView,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,scrollColumnIntoView:scrollColumnIntoView,getCanvasNode:getCanvasNode,getUID:getUID,getHeaderColumnWidthDiff:getHeaderColumnWidthDiff,getScrollbarDimensions:getScrollbarDimensions,getHeadersWidth:getHeadersWidth,getCanvasWidth:getCanvasWidth,focus:setFocus,scrollTo:scrollTo,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,navigatePageUp:navigatePageUp,navigatePageDown:navigatePageDown,navigateTop:navigateTop,navigateBottom:navigateBottom,navigateRowStart:navigateRowStart,navigateRowEnd:navigateRowEnd,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,getPreHeaderPanel:getPreHeaderPanel,setPreHeaderPanelVisibility:setPreHeaderPanelVisibility,getHeader:getHeader,getHeaderColumn:getHeaderColumn,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,setFooterRowVisibility:setFooterRowVisibility,getFooterRow:getFooterRow,getFooterRowColumn:getFooterRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}$.extend(!0,window,{Slick:{Grid:SlickGrid}})}(jQuery);