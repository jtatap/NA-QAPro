Date.LZ=function(x){return(x<0||x>9?"":"0")+x},Date.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),Date.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),Date.dayNames=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),Date.dayAbbreviations=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"),Date.preferAmericanFormat=!0,Date.prototype.getFullYear||(Date.prototype.getFullYear=function(){var yy=this.getYear();return yy<1900?yy+1900:yy}),Date.parseString=function(val,format){if(void 0===format||null==format||""==format){for(var generalFormats=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d","MMM-d","d-MMM"),monthFirst=new Array("M/d/y","M-d-y","M.d.y","M/d","M-d"),dateFirst=new Array("d/M/y","d-M-y","d.M.y","d/M","d-M"),checkList=new Array(generalFormats,Date.preferAmericanFormat?monthFirst:dateFirst,Date.preferAmericanFormat?dateFirst:monthFirst),i=0;i<checkList.length;i++)for(var l=checkList[i],j=0;j<l.length;j++){var d=Date.parseString(val,l[j]);if(null!=d)return d}return null}this.isInteger=function(val){for(var i=0;i<val.length;i++)if(-1=="1234567890".indexOf(val.charAt(i)))return!1;return!0},this.getInt=function(str,i,minlength,maxlength){for(var x=maxlength;x>=minlength;x--){var token=str.substring(i,i+x);if(token.length<minlength)return null;if(this.isInteger(token))return token}return null},val+="",format+="";for(var x,y,i_val=0,i_format=0,c="",token="",year=(new Date).getFullYear(),month=1,date=1,hh=0,mm=0,ss=0,ampm="";i_format<format.length;){for(c=format.charAt(i_format),token="";format.charAt(i_format)==c&&i_format<format.length;)token+=format.charAt(i_format++);if("yyyy"==token||"yy"==token||"y"==token){if("yyyy"==token&&(x=4,y=4),"yy"==token&&(x=2,y=2),"y"==token&&(x=2,y=4),null==(year=this.getInt(val,i_val,x,y)))return null;i_val+=year.length,2==year.length&&(year=year>70?year-0+1900:year-0+2e3)}else if("MMM"==token||"NNN"==token){month=0;var names="MMM"==token?Date.monthNames.concat(Date.monthAbbreviations):Date.monthAbbreviations;for(i=0;i<names.length;i++){var month_name=names[i];if(val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()){month=i%12+1,i_val+=month_name.length;break}}if(month<1||month>12)return null}else if("EE"==token||"E"==token)for(names="EE"==token?Date.dayNames:Date.dayAbbreviations,i=0;i<names.length;i++){var day_name=names[i];if(val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()){i_val+=day_name.length;break}}else if("MM"==token||"M"==token){if(null==(month=this.getInt(val,i_val,token.length,2))||month<1||month>12)return null;i_val+=month.length}else if("dd"==token||"d"==token){if(null==(date=this.getInt(val,i_val,token.length,2))||date<1||date>31)return null;i_val+=date.length}else if("hh"==token||"h"==token){if(null==(hh=this.getInt(val,i_val,token.length,2))||hh<1||hh>12)return null;i_val+=hh.length}else if("HH"==token||"H"==token){if(null==(hh=this.getInt(val,i_val,token.length,2))||hh<0||hh>23)return null;i_val+=hh.length}else if("KK"==token||"K"==token){if(null==(hh=this.getInt(val,i_val,token.length,2))||hh<0||hh>11)return null;i_val+=hh.length,hh++}else if("kk"==token||"k"==token){if(null==(hh=this.getInt(val,i_val,token.length,2))||hh<1||hh>24)return null;i_val+=hh.length,hh--}else if("mm"==token||"m"==token){if(null==(mm=this.getInt(val,i_val,token.length,2))||mm<0||mm>59)return null;i_val+=mm.length}else if("ss"==token||"s"==token){if(null==(ss=this.getInt(val,i_val,token.length,2))||ss<0||ss>59)return null;i_val+=ss.length}else if("a"==token){if("am"==val.substring(i_val,i_val+2).toLowerCase())ampm="AM";else{if("pm"!=val.substring(i_val,i_val+2).toLowerCase())return null;ampm="PM"}i_val+=2}else{if(val.substring(i_val,i_val+token.length)!=token)return null;i_val+=token.length}}if(i_val!=val.length)return null;if(2==month)if(year%4==0&&year%100!=0||year%400==0){if(date>29)return null}else if(date>28)return null;return(4==month||6==month||9==month||11==month)&&date>30?null:(hh<12&&"PM"==ampm?hh=hh-0+12:hh>11&&"AM"==ampm&&(hh-=12),new Date(year,month-1,date,hh,mm,ss))},Date.isValid=function(val,format){return null!=Date.parseString(val,format)},Date.prototype.isBefore=function(date2){return null!=date2&&this.getTime()<date2.getTime()},Date.prototype.isAfter=function(date2){return null!=date2&&this.getTime()>date2.getTime()},Date.prototype.equals=function(date2){return null!=date2&&this.getTime()==date2.getTime()},Date.prototype.equalsIgnoreTime=function(date2){if(null==date2)return!1;var d1=new Date(this.getTime()).clearTime(),d2=new Date(date2.getTime()).clearTime();return d1.getTime()==d2.getTime()},Date.prototype.format=function(format){format+="";var result="",i_format=0,c="",token="",y=this.getYear()+"",M=this.getMonth()+1,d=this.getDate(),E=this.getDay(),H=this.getHours(),m=this.getMinutes(),s=this.getSeconds(),value=new Object;for(y.length<4&&(y=""+(+y+1900)),value.y=""+y,value.yyyy=y,value.yy=y.substring(2,4),value.M=M,value.MM=Date.LZ(M),value.MMM=Date.monthNames[M-1],value.NNN=Date.monthAbbreviations[M-1],value.d=d,value.dd=Date.LZ(d),value.E=Date.dayAbbreviations[E],value.EE=Date.dayNames[E],value.H=H,value.HH=Date.LZ(H),value.h=0==H?12:H>12?H-12:H,value.hh=Date.LZ(value.h),value.K=value.h-1,value.k=value.H+1,value.KK=Date.LZ(value.K),value.kk=Date.LZ(value.k),value.a=H>11?"PM":"AM",value.m=m,value.mm=Date.LZ(m),value.s=s,value.ss=Date.LZ(s);i_format<format.length;){for(c=format.charAt(i_format),token="";format.charAt(i_format)==c&&i_format<format.length;)token+=format.charAt(i_format++);void 0!==value[token]?result+=value[token]:result+=token}return result},Date.prototype.getDayName=function(){return Date.dayNames[this.getDay()]},Date.prototype.getDayAbbreviation=function(){return Date.dayAbbreviations[this.getDay()]},Date.prototype.getMonthName=function(){return Date.monthNames[this.getMonth()]},Date.prototype.getMonthAbbreviation=function(){return Date.monthAbbreviations[this.getMonth()]},Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.add=function(interval,number){if(void 0===interval||null==interval||void 0===number||null==number)return this;if(number=+number,"y"==interval)this.setFullYear(this.getFullYear()+number);else if("M"==interval)this.setMonth(this.getMonth()+number);else if("d"==interval)this.setDate(this.getDate()+number);else if("w"==interval)for(var step=number>0?1:-1;0!=number;){for(this.add("d",step);0==this.getDay()||6==this.getDay();)this.add("d",step);number-=step}else"h"==interval?this.setHours(this.getHours()+number):"m"==interval?this.setMinutes(this.getMinutes()+number):"s"==interval&&this.setSeconds(this.getSeconds()+number);return this};