var handleFileSelect=function(evt){var reader,file=evt.data;file&&((reader=isFireFox()?new FileReaderSync:new FileReader).onload=function(readerEvt){var base64String;base64String=(isFireFox()?readerEvt:readerEvt.target.result).split("base64,")[1],postMessage(file.name+","+base64String)},isFireFox()?reader.onload(reader.readAsDataURL(file)):reader.readAsDataURL(file))},isFireFox=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1};onmessage=function(e){handleFileSelect(e)};