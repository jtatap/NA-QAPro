if(!jQuery.support.cors&&jQuery.ajaxTransport&&window.XDomainRequest){var httpRegEx=/^https?:\/\//i,httpMethodsRegEx=/^get|post|put|delete$/i,putOrDeleteRegEx=/^put|delete$/i,sameSchemeRegEx=new RegExp("^"+location.protocol,"i"),htmlRegEx=/text\/html/i,jsonRegEx=/\/json/i,xmlRegEx=/\/xml/i;jQuery.ajaxTransport("text html xml json",function(options,userOptions,jqXHR){var url=options.url,httpMethod=options.type,postData="",contentType="",autherization="";if(options.crossDomain&&options.async&&httpMethodsRegEx.test(httpMethod)&&httpRegEx.test(url)&&sameSchemeRegEx.test(url)){var xdr=null,userType=(userOptions.dataType||"").toLowerCase();return{send:function(headers,complete){if(xdr=new XDomainRequest,/^\d+$/.test(userOptions.timeout)&&(xdr.timeout=userOptions.timeout),xdr.ontimeout=function(){complete(500,"timeout")},xdr.onload=function(){var allResponseHeaders="Content-Length: "+xdr.responseText.length+"\r\nContent-Type: "+xdr.contentType,status={code:200,message:"success"},responses={text:xdr.responseText};try{if("html"===userType||htmlRegEx.test(xdr.contentType))responses.html=xdr.responseText;else if("json"===userType||"text"!==userType&&jsonRegEx.test(xdr.contentType))try{responses.json=IC_Common.parseJSON(xdr.responseText),responses.json.hasOwnProperty("ieCorsResult")&&(status.code=responses.json.ieCorsResult.statusCode,status.message=responses.json.ieCorsResult.statusDescription)}catch(e){throw status.code=500,status.message="parseerror","Invalid JSON: "+xdr.responseText}else if("xml"===userType||"text"!==userType&&xmlRegEx.test(xdr.contentType)){var doc=new ActiveXObject("Microsoft.XMLDOM");doc.async=!1;try{doc.loadXML(xdr.responseText)}catch(e){doc=void 0}if(!doc||!doc.documentElement||doc.getElementsByTagName("parsererror").length)throw status.code=500,status.message="parseerror","Invalid XML: "+xdr.responseText;responses.xml=doc}}catch(parseMessage){throw parseMessage}finally{complete(status.code,status.message,responses,allResponseHeaders)}},xdr.onprogress=function(){},xdr.onerror=function(){complete(500,"error",{text:xdr.responseText})},userOptions.headers&&(userOptions.headers.hasOwnProperty("Content-Type")&&(contentType=userOptions.headers["Content-Type"]),userOptions.headers.hasOwnProperty("Authorization")&&(autherization=userOptions.headers.Authorization,url=url+(-1===url.indexOf("?")?"?":"&")+"Authorization="+encodeURIComponent(autherization))),url=url+(-1===url.indexOf("?")?"?":"&")+"iecors=true",putOrDeleteRegEx.test(httpMethod)&&(url=url+(-1===url.indexOf("?")?"?":"&")+"httpMethod="+httpMethod,httpMethod="POST"),userOptions.data)if(contentType===AgentConsoleDataStore.URLEncoded){var json={};if(IC_Validation.isValidObject(userOptions.data))json=userOptions.data;else for(var tmp,key,value,params=userOptions.data.split("&"),i=0,len=params.length;i<len;i++)tmp=params[i].split("="),key=decodeURIComponent(tmp[0]),value=decodeURIComponent(tmp[1]),-1!=key.search(/\[\]$/)?(json[tmp=key.replace(/\[\]$/,"")]=json[tmp]||[],json[tmp].push(value)):json[key]=value;postData=JSON.stringify(json)}else postData=contentType===AgentConsoleDataStore.JSONEncoded?IC_Validation.isValidObject(userOptions.data)?JSON.stringify(userOptions.data):userOptions.data:"string"===jQuery.type(userOptions.data)?userOptions.data:jQuery.param(userOptions.data);xdr.open(httpMethod,url),xdr.send(postData)},abort:function(){xdr&&xdr.abort()}}}})}