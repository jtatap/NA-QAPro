!function($){var logger=IC_Common.getLogger("Container");$.widget("AgentConsole.agentConsole",$.AgentConsole.baseContainer,{options:{sfSessionId:"",resourceBase:"",phoneNo:null,stationId:null,username:null,timezoneOffset:0,sfdcOrigin:"",sfMode:"",localeCode:"",localeDateFormat:"",localeDateTimeFormat:"",langCode:"",isAutoLogin:!0,isPopout:!1,isTooltipEnabled:!1,agentVersion:"",sfNamespace:"",sfUserId:"",sfUsername:"",logLevel:"ERROR",appHelpTarget:"https://help.incontact.com/fall19/EN/Content/Agent/SalesforceAgent/AgentForSalesforce.htm",isInLightningView:!1,timezoneName:""},agentInfo:{cState:{state:"Logging in",reason:"",time:(new Date).getTime(),timeout:0,acw:!1},lgId:"",lgState:"Disconnected",lgMuted:!1,mask:!1},updateSkillListQueue:!1,containsDialerCall:!1,isDialerPanel:!1,panelDisplayed:"",isPopout:!1,chatContactIdToTransfer:"",chatContacts:"",chatDisconnectedWidget:[],isChatContactPanel:!1,showIndicator:!1,showContactIndicator:!1,isPCDialPad:!1,isVMDialPad:!1,contactLength:0,accpId:"",isPCConfirmErrorMsgDisplayed:!1,acceptRejectPanelType:"",isAutoLoginErr:!1,indicatorHt:0,contactIndicatorsAdded:[],obPhoneSkillsList:[],isEmailValidState:!1,emailInboxTimerId:null,isEmailLimitReached:!1,emailQueueCount:0,contactType:null,isEvolveWFMEnabled:!1,isEvolveQMEnabled:!1,isSoftPhoneEnabled:!1,defaultSoftPhoneVolume:.9,isCXonePMEnabled:!1,personalQueueCountForLogout:0,IC_AGENT_CONSOLE_API:"IC_AgentConsoleApi/",_create:function(){logger.info("##### _create ##### v:"+this.options.agentVersion+" sfUserId:"+this.options.sfUserId+" sfUsername:"+this.options.sfUsername+" timezoneName:"+this.options.timezoneName+" localeCode:"+this.options.localeCode+" namespace:"+this.options.sfNamespace+" isInLightningView:"+this.options.isInLightningView);IC_Common.parseQueryString(window.location.search);this.options.localeDateFormat=AgentConsoleLocale.getLocaleFormat(this.options.localeCode,"date"),this.options.localeDateTimeFormat=AgentConsoleLocale.getLocaleFormat(this.options.localeCode,""),this.options.localeTimeFormat=AgentConsoleLocale.getLocaleFormat(this.options.localeCode,"time"),AgentConsoleDataStore.setGlobalLogLevel(this.options.logLevel),AgentConsoleDataStore.localeDateTimeFormat=this.options.localeDateTimeFormat.replace("yy","yyyy"),AgentConsoleDataStore.localeDateFormat=this.options.localeDateFormat.replace("yy","yyyy"),AgentConsoleDataStore.clientLocale=this.options.localeCode,AgentConsoleDataStore.clientTimezoneName=this.options.timezoneName,$(document).on("click",$.proxy(this.onDocumentClick,this)),this.resourceBase=this.options.resourceBase,AgentConsoleSalesforce.init({resourceBase:this.options.resourceBase,namespace:this.options.sfNamespace}),NotificationHandler.init(this.resourceBase),webRTC.resourceBase=this.resourceBase,OmnichannelClient.container=this,this.elements={},IC_Common.isIE11()&&this.element.addClass("ie11or10");var rootDiv=$('<div class="agentConsole" />').appendTo(this.element),that=this;this.elements.rootDiv=rootDiv,this.createBaseControls(),this.elements.loginPopupDiv=$('<div class="popupDiv" align="center"/>').appendTo(rootDiv),this.elements.loginPopupDiv.css({height:"89%","z-index":"1"}),this.elements.loginParentDiv=$('<div class="loginMsgDiv" id = "loginMsgParentDivId"/>').appendTo(this.elements.loginPopupDiv),this.elements.loginMsgDiv=$('<div id = "loginMsgId"/>').text(IC_Localization.sessionEnded).appendTo(this.elements.loginParentDiv),this.elements.loginBtnDiv=$('<input type="button" title="'+IC_Localization.login+'" id = "loginBtnId" value='+IC_Localization.login+' class="loginBtnDiv brRoundT brRoundB textEllipsis" align="center" />').appendTo(this.elements.loginParentDiv),this.elements.loginPopupDiv.hide(),this.elements.loginBtnDiv.on("click",$.proxy(this.onLoginBtnClick,this)),this.elements.popupDiv=$('<div class="popupDiv" align="center"/>').appendTo(rootDiv),this.elements.msgDiv=$('<div class="msgDiv brRoundT brRoundB" id = "msgDivId" tabindex="-1" aria-labelledby="infoMsgId"/>').appendTo(this.elements.popupDiv),this.elements.msgBtn=$('<div class="btnDivEnable okBtn brRoundT brRoundB textEllipsis" id = "ok" title = "'+IC_Localization.ok+'" tabindex = "0" aria-label = "'+IC_Localization.ok+'"  role="button">').text(IC_Localization.ok).appendTo(this.elements.msgDiv),this.elements.msgBtn.on("click",$.proxy(this.onClickMsgOkBtn,this)),this.elements.msgBtn.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),IC_Common.enterKeyPress(this.elements.msgBtn,function(){that.onClickMsgOkBtn()}),IC_Common.setFocusToElement(this.elements.msgBtn,"dialog-button-focus"),this.elements.callMsgDiv=$('<div id = "callMsgDivId" class="msgDiv brRoundT brRoundB" tabindex="-1" aria-labelledby="confirmationPrompt"/>').appendTo(this.elements.popupDiv),this.elements.callMsgDiv.css("display","none"),this.elements.callMsgYesBtn=$('<div id = "callMsgYesBtnId" class="btnDivEnable yesBtn brRoundT brRoundB textEllipsis" title = "'+IC_Localization.yes+'" tabindex = "0" aria-label = "'+IC_Localization.yes+'"  role="button">').text(IC_Localization.yes).appendTo(this.elements.callMsgDiv),this.elements.callMsgNoBtn=$('<div id = "callMsgNoBtnId" class="btnDivEnable noBtn brRoundT brRoundB textEllipsis" title = "'+IC_Localization.no+'" tabindex = "0" aria-label = "'+IC_Localization.no+'"  role="button">').text(IC_Localization.no).appendTo(this.elements.callMsgDiv),this.elements.callMsgNoBtn.on("click",$.proxy(this.closeCallMsgPopup,this)),this.elements.callMsgNoBtn.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.elements.callMsgYesBtn.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),IC_Common.setFocusToElement(this.elements.callMsgYesBtn,"dialog-button-focus"),IC_Common.setFocusToElement(this.elements.callMsgNoBtn,"dialog-button-focus"),this.elements.headerPanel=$('<div class="bgHeaderGradient header"/>').appendTo(rootDiv),this.elements.headerLogo=$('<div class="logo"></div>').text(IC_Localization.salesforceAgent).appendTo(this.elements.headerPanel),this.elements.headerLogo.fadeIn(),this.elements.agentLegStatebgElement=$('<div class="agentLegStatebg"/>').appendTo(this.elements.headerPanel),this.elements.agentLegState=$('<img class="agentLegState" id = "agentLegStateId" />').attr("src",this.resourceBase+"/css/images/leg-off.png").appendTo(this.elements.agentLegStatebgElement),this.elements.agentLegState.on("click",$.proxy(this.onClickAgentLeg,this)),this.elements.agentMsgScroll=$('<div class="agentMsgScroll hideMsgPanel" />').appendTo(this.elements.headerPanel),this.elements.agentMsgScroll.agentMessageScroll({container:this,resourceBase:this.options.resourceBase}),this.elements.agentMsgScroll.on("click",$.proxy(this.onAgentMsgScrollClick,this)),this.elements.agentStatePanel=$('<div class="agentStateControl"/>').appendTo(rootDiv),this.elements.agentIndicatorPanel=$('<div class="agentIndicator bgBodyGradient"/>').appendTo(rootDiv),this.elements.contentPanel=$('<div class="bgBodyGradient contentPanel withoutDialerPanel"/>').appendTo(rootDiv),this.createAgentConsoleContainer(),this.elements.footerPanel=$('<div class="bgFooterGradient footer"/>').appendTo(rootDiv),this.elements.metricsPanel=$('<div class="metricsPanel"/>').appendTo(rootDiv),this.elements.sfdcLogo=$('<img id = "metricLogo"/>').appendTo(this.elements.metricsPanel),this.elements.cobrandImg=$('<img id = "brandingImg"/>').appendTo(this.elements.metricsPanel),this.elements.obPhoneSkillsMenu=$('<div id="ic_obskilllistmenu" class="ic_obSkillListMenu btnDivEnable" />').appendTo(rootDiv),this.elements.obPhoneSkillsMenu.on("mouseleave",function(){that.elements.obPhoneSkillsMenu.hide()}),this.elements.obPhoneSkillsMenu.on("mouseenter",function(){clearTimeout(that.obSkillHideTimeout)}),this.elements.obEmailSkillsMenu=$('<div id="ic_obskilllistmenu" class="ic_obSkillListMenu btnDivEnable" />').appendTo(rootDiv),this.elements.obEmailSkillsMenu.on("mouseleave",function(){that.elements.obEmailSkillsMenu.hide()}),this.elements.obEmailSkillsMenu.on("mouseenter",function(){clearTimeout(that.obSkillHideTimeout)}),this.commitmentPendingLayer=$("<div class='commitmentPendingLayer'/>").appendTo(rootDiv).hide(),logger.trace("_create:METHOD EXIT")},_init:function(){if(this.initializeBase(),this.canDestroyWItemAccptRejPnl=!1,this.isWorkItemTransferClicked=!1,this.isVoiceMailTransferClicked=!1,this.isChatContactTransferClicked=!1,this.isEmailContactTransferClicked=!1,this.isSkillSelectedHere=!1,logger.trace("_init METHOD ENTRY"),IC_Validation.isNullOrEmpty(this.options.sfdcOrigin))throw logger.error("_init - sfdcIFrameOrigin empty"),Error(IC_Localization.invalidSFDCOrigin);var message=this.IC_AGENT_CONSOLE_API+JSON.stringify({type:"iframeLoaded"});window.parent.postMessage(message,this.options.sfdcOrigin),$(document).on(AgentConsoleDataStore.AgentSessionStartEvent,$.proxy(this.onAgentSessionStart,this)),$(document).on(AgentConsoleDataStore.AgentInfoEvent,$.proxy(this.onAgentInfoUpdate,this)),$(document).on(AgentConsoleDataStore.AgentSessionEndEvent,$.proxy(this.onAgentSessionEnd,this)),$(document).on(AgentConsoleDataStore.ContactEvent,$.proxy(this.onContactUpdate,this)),$(document).on(AgentConsoleDataStore.UnavailableListEvent,$.proxy(this.onUnavailableListUpdate,this)),$(document).on(AgentConsoleDataStore.AgentSkillListEvent,$.proxy(this.onAgentSkillListUpdate,this)),$(document).on(AgentConsoleDataStore.ContactResultEvent,$.proxy(this.onContactResultListUpdate,this)),$(document).on(AgentConsoleDataStore.APIErrorEvent,$.proxy(this.onAPIErrorEventUpdate,this)),$(document).on(AgentConsoleDataStore.AgentListEvent,$.proxy(this.onAgentListUpdate,this)),$(document).on(AgentConsoleDataStore.AgentStateChangeEvent,$.proxy(this.onAgentStateChange,this)),$(document).on(AgentConsoleDataStore.TeamListEvent,$.proxy(this.onTeamListUpdate,this)),$(document).on(AgentConsoleDataStore.SkillListEvent,$.proxy(this.onSkillListUpdate,this)),$(document).on(AgentConsoleDataStore.SkillClosedHoursEvent,$.proxy(this.onSkillClosedHours,this)),$(document).on(AgentConsoleDataStore.AllUnavailableCodeListEvent,$.proxy(this.onAllUnavailableListUpdate,this)),$(document).on(AgentConsoleDataStore.SkillQueueEvent,$.proxy(this.onSkillQueueUpdate,this)),$(document).on(AgentConsoleDataStore.CustomVariablesEvent,$.proxy(this.onCustomVariablesUpdate,this)),$(document).on(AgentConsoleDataStore.AgentSkillAssignmentsEvent,$.proxy(this.onAgentSkillAssignmentsUpdate,this)),$(document).on(AgentConsoleDataStore.AddressBooksEvent,$.proxy(this.onAddressBooksUpdate,this)),$(document).on(AgentConsoleDataStore.PCQueueEvent,$.proxy(this.onPCQueueCountUpdate,this)),$(document).on(AgentConsoleDataStore.DispositionEvent,$.proxy(this.onDispositionUpdate,this)),$(document).on(AgentConsoleDataStore.ChatMsgEvent,$.proxy(this.onChatMsgUpdate,this)),$(document).on(AgentConsoleDataStore.FeedbackCategoryEvent,$.proxy(this.onFeedbackCategoryUpdate,this)),$(document).on(AgentConsoleDataStore.AgentMessageEvent,$.proxy(this.onAgentMessageUpdate,this)),$(document).on(AgentConsoleDataStore.AgentIndicatorEvent,$.proxy(this.OnAgentIndicatorUpdate,this)),$(document).on(AgentConsoleDataStore.ContactHistoryEvent,$.proxy(this.ContactHistoryFilterUpdate,this)),$(document).on(AgentConsoleDataStore.VoiceMailPlayBackEvent,$.proxy(this.onVoiceMailPlayBackUpdate,this)),$(document).on(AgentConsoleDataStore.AutoLoginDisabledEvent,$.proxy(this.onAutoLoginDisabled,this)),$(document).on(AgentConsoleDataStore.MailProgressEvent,$.proxy(this.onMailProgressUpdate,this)),$(document).on(AgentConsoleDataStore.PromiseKeeperEvent,$.proxy(this.onPromiseKeeperUpdate,this)),$(document).on(AgentConsoleDataStore.TimeZoneEvent,$.proxy(this.onTimeZoneEvent,this)),$(document).on(AgentConsoleDataStore.RescheduleCommitmentReminderEvent,$.proxy(this.RescheduleCommitmentReminderEvent,this)),$(document).on(AgentConsoleDataStore.ProceedCommitmentReminderEvent,$.proxy(this.ProceedCommitmentReminderEvent,this)),$(document).on(AgentConsoleDataStore.RescheduleCommitmentReminderCompletedEvent,$.proxy(this.RescheduleCommitmentReminderCompletedEvent,this)),$(document).on(AgentConsoleDataStore.BrandingProfilesEvent,$.proxy(this.onBradingProfilesUpdate,this)),$(document).on(AgentConsoleDataStore.ChatPatronTypingEvent,$.proxy(this.onChatPatronTypingUpdate,this)),$(document).on(AgentConsoleDataStore.ChatPreviewEvent,$.proxy(this.onChatPreviewUpdate,this)),$(document).on(AgentConsoleDataStore.ParkedEmailLimitValidation,$.proxy(this.onParkEmailLimitValidation,this)),$(document).on(AgentConsoleDataStore.PCPreviewNotesUpdate,$.proxy(this.pcPreviewNotesUpdate,this)),$(document).on(AgentConsoleDataStore.SkillTagsUpdateEvent,$.proxy(this.onSkillTagsUpdate,this)),$(document).on(AgentConsoleDataStore.TagsUpdatedContactEvent,$.proxy(this.onTagsUpdatedContactEvent,this)),$(document).on(AgentConsoleDataStore.BUFeaturesListEvent,$.proxy(this.onGetBUFeaturesList,this)),$(document).on(AgentConsoleDataStore.agentLegAcceptRejectActionsEvent,$.proxy(this.onAgentLegAcceptRejectActionsEvent,this)),this.elements.agentStatePanel.agentState({container:this}),this.elements.agentStatePanel.agentState("updateData",this.agentInfo),this.elements.agentIndicatorPanel.indicator({container:this}),this.elements.footerPanel.footer({container:this}),window.attachEvent?window.attachEvent("onmessage",$.proxy(this.processPostMessage,this)):window.addEventListener("message",$.proxy(this.processPostMessage,this),!1),AgentConsoleDataStore.sfMode=!1===IC_Validation.isNotNullOrEmpty(this.options.sfMode)?"Classic":this.options.sfMode,AgentConsoleDataStore.isAutoLogin=this.options.isAutoLogin,this.elements.footerPanel.footer("toggleFooterCount",!1),AgentConsoleDataStore.checkSalesforceUserAndFlushStorage(this.options.sfUserId);var isWebRTCAutoLogin=!1;AgentConsoleDataStore.isTokenExpired()?AgentConsoleDataStore.redirectToLoginPage(!1):(omniChannel.init(),IC_Validation.isNullOrEmpty(this.options.stationId)&&IC_Validation.isNullOrEmpty(this.options.phoneNo)||IC_Validation.isNullOrEmpty(localStorage.icSessionId)&&(!0!==AgentConsoleDataStore.isAutoLogin||!0===AgentConsoleDataStore.isSSO())?this.showOptionsPanelwithAgentLoggedOut():(AgentConsoleDataStore.isScc($.proxy(this.sccToggleClickToDial,this)),this.options.phoneNo==IC_Util.WebRTC?isWebRTCAutoLogin=!0:this.loginAgent(!1)),this.checkIntegratedSoftphoneEnabled($.proxy(this.onCheckIntegratedSoftphoneCompleted,this,isWebRTCAutoLogin)),"Lightning"===this.options.sfMode&&sforce.console.onCustomConsoleComponentButtonClicked($.proxy(this.onCustomConsoleComponentButtonClicked,this)),logger.trace("_init METHOD EXIT"))},onCustomConsoleComponentButtonClicked:function(result){var isWindowHidden=result.windowHidden;logger.trace("onCustomConsoleComponentButtonClicked  | "+isWindowHidden),isWindowHidden||this.resizeContactWidget()},showOptionsPanelwithAgentLoggedOut:function(){this.agentInfo.cState.state="Logged out",this.elements.agentStatePanel.agentState("updateData",this.agentInfo),this.onOptionsPanelOpen(!1),AgentConsoleDataStore.setSoftphoneHeightWidth()},checkIntegratedSoftphoneEnabled:function(callback){if(webRTC.isWebRTCSupportedBrowser()){var isSoftphoneEnabled=AgentConsoleDataStore.getSoftphoneEnabled();IC_Validation.isNullOrEmpty(isSoftphoneEnabled)?AgentConsoleDataStore.isIntegratedSoftphoneEnabled(function(isSoftphoneEnabled){callback(isSoftphoneEnabled)}):callback(isSoftphoneEnabled)}else callback(!1)},onCheckIntegratedSoftphoneCompleted:function(isWebRTCAutoLogin,isSoftphoneEnabled){this.isSoftPhoneEnabled=isSoftphoneEnabled,IC_Validation.isNotNullOrEmpty(this.elements.optionPanel)&&this.elements.optionPanel.userSetting("isWebRTCEnabled",isSoftphoneEnabled),isWebRTCAutoLogin&&(1==isSoftphoneEnabled?this.loginAgent(!1):this.showOptionsPanelwithAgentLoggedOut())},getSoftphoneEnabled:function(){return this.isSoftPhoneEnabled},createAgentConsoleContainer:function(){this.elements.contentPanelWrapper=$("<div/>").appendTo(this.elements.contentPanel),this.createHomePage(this.elements.contentPanelWrapper),this.createTabControls(this.elements.contentPanelWrapper),this.elements.contentPanelWrapper.css("display","none")},createTabControls:function(parent){var that=this;this.elements.tooltipDiv=$('<div class="tooltipDiv"/>').appendTo(parent),this.tooltipTxt=$("<span>").addClass("tooltipTextSpan").appendTo(this.elements.tooltipDiv),this.elements.tooltipDiv.hoverfn(function(event){that.elements.tooltipDiv.showfn()},function(){that.elements.tooltipDiv.hide()}),this.elements.tabPanel=$('<div id = "tabPanelId" class="bgBodyGradient tabPanel"/>').appendTo(parent),this.elements.tabLeftArrowIconImg=$("<div/>").addClass("tabLeftArrowDiv").appendTo(this.elements.tabPanel),this.leftArrowImg=$("<img/>").addClass("leftArrowImg").attr("src",this.resourceBase+"/css/images/arrowleft-disabled.png").appendTo(this.elements.tabLeftArrowIconImg),this.elements.innerTabPanel=$('<div id = "innerTabPanelId" class="bgBodyGradient innerTabPanel"/>').addClass("innerTabPanel").appendTo(this.elements.tabPanel),this.elements.tabDialpadIconDiv=$('<div class="btnBrRound5 iconDiv btnDivDisable" id = "tabDialpadIconId"/>').appendTo(this.elements.innerTabPanel),this.elements.tabDialpadIconImg=$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/hp-sm-phone.png").appendTo(this.elements.tabDialpadIconDiv),this.elements.tabDialpadIconDiv.hoverfn(function(){that.elements.tabDialpadIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.dialPadTooltipTxt):that.elements.tabDialpadIconDiv.attr("title",IC_Localization.dialPad)},function(){that.mouseLeaveButton(this)}),this.elements.tabAgentsIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id="tabAgentsIconId"/>').appendTo(this.elements.innerTabPanel),this.elements.tabAgentsIconDiv.hoverfn(function(){that.elements.tabAgentsIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.agentListTooltipTxt):that.elements.tabAgentsIconDiv.attr("title",IC_Localization.agents)},function(){that.mouseLeaveButton(this)}),$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/hp-sm-agents.png").appendTo(this.elements.tabAgentsIconDiv),this.elements.tabSkillsIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id="tabSkillsIconDiv"/>').appendTo(this.elements.innerTabPanel),this.elements.tabSkillsIconDiv.hoverfn(function(){that.elements.tabSkillsIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.skillListTooltipTxt):that.elements.tabSkillsIconDiv.attr("title",IC_Localization.skills)},function(){that.mouseLeaveButton(this)}),$('<img class="skillIcon"/>').attr("src",this.resourceBase+"/css/images/SkillIcon.svg").appendTo(this.elements.tabSkillsIconDiv),this.elements.tabAddressBookIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id="tabAddressBookIconDiv"/>').appendTo(this.elements.innerTabPanel),this.elements.tabAddressBookIconDiv.hoverfn(function(){that.elements.tabAddressBookIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.addressBookTooltipTxt):that.elements.tabAddressBookIconDiv.attr("title",IC_Localization.addressBook)},function(){that.mouseLeaveButton(this)}),$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/hp-sm-addrbook.png").appendTo(this.elements.tabAddressBookIconDiv),this.elements.tabHistoryIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id="tabHistoryIconDiv"/>').appendTo(this.elements.innerTabPanel),this.elements.tabHistoryIconDiv.hoverfn(function(){that.elements.tabHistoryIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.contactHistoryTooltipTxt):that.elements.tabHistoryIconDiv.attr("title",IC_Localization.contactHistory)},function(){that.mouseLeaveButton(this)}),$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/hp-sm-history.png").appendTo(this.elements.tabHistoryIconDiv),this.elements.tabAgentInfoIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id = "tabAgentInfoIconId" />').appendTo(this.elements.innerTabPanel),this.elements.tabAgentInfoIconDiv.hoverfn(function(){that.elements.tabAgentInfoIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.agentInfoToolitipTxt):that.elements.tabAgentInfoIconDiv.attr("title",IC_Localization.agentInfo)},function(){that.mouseLeaveButton(this)}),$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/hp-sm-agentinfo.png").appendTo(this.elements.tabAgentInfoIconDiv),this.elements.tabOBEmailIconDiv=$('<div class="btnBrRound5 iconDiv btnDivDisable" id = "tabOBEmailIconDivId"/>').appendTo(this.elements.innerTabPanel),this.elements.tabOBEmailIconImg=$('<img class="icon"/>').css({width:"22px",height:"20px"}).attr("src",this.resourceBase+"/css/images/mail.png").appendTo(this.elements.tabOBEmailIconDiv),this.elements.tabOBEmailIconDiv.hoverfn(function(){that.elements.tabOBEmailIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.emailTooltipTxt):that.elements.tabOBEmailIconDiv.attr("title",IC_Localization.email)},function(){that.mouseLeaveButton(this)}),this.elements.tabPromiseKeeperIconDiv=$('<div class="btnBrRound5 iconDiv btnDivDisable" id = "tabPromiseKeeperIconId" />').appendTo(this.elements.innerTabPanel),this.elements.tabPromiseKeeperIconDiv.hoverfn(function(){that.elements.tabPromiseKeeperIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.commitmentTooltipTxt):that.elements.tabPromiseKeeperIconDiv.attr("title",IC_Localization.commitmentManager)},function(){that.mouseLeaveButton(this)}),this.elements.tabPromiseKeeperIconImg=$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/pin.png").appendTo(this.elements.tabPromiseKeeperIconDiv),this.elements.tabAgentReportsIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id = "tabAgentReportsIconId"/>').appendTo(this.elements.innerTabPanel),this.elements.tabAgentReportsIconImg=$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/agentreport-tab.png").appendTo(this.elements.tabAgentReportsIconDiv),this.elements.tabAgentReportsIconDiv.hoverfn(function(){that.elements.tabAgentReportsIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.agentReportsTooltipTxt):that.elements.tabAgentReportsIconDiv.attr("title",IC_Localization.agentReports)},function(){that.mouseLeaveButton(this)}),this.elements.tabEvolveScheduleIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id = "tabEvolveScheduleIconId" style="display : none"/>').appendTo(this.elements.innerTabPanel),this.elements.tabEvolveScheduleIconDiv.hoverfn(function(){that.elements.tabEvolveScheduleIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.scheduleTooltipTxt):that.elements.tabEvolveScheduleIconDiv.attr("title",IC_Localization.schedule)},function(){that.mouseLeaveButton(this)}),this.elements.tabEvolveScheduleIconImg=$('<img class="icon"/>').css({width:"22px",height:"20px"}).attr("src",this.resourceBase+"/css/images/schedule.png").appendTo(this.elements.tabEvolveScheduleIconDiv),this.elements.tabMessageIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id = "tabMessageIconId" />').appendTo(this.elements.innerTabPanel),this.elements.tabMessageIconDiv.hoverfn(function(){that.elements.tabMessageIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.messageTooltipTxt):that.elements.tabMessageIconDiv.attr("title",IC_Localization.message)},function(){that.mouseLeaveButton(this)}),this.elements.tabMessageIconImg=$('<img class="icon"/>').css({width:"22px",height:"20px"}).attr("src",this.resourceBase+"/css/images/messages.png").appendTo(this.elements.tabMessageIconDiv),this.elements.tabHelpIconDiv=$('<div class="btnBrRound5 iconDiv btnDivEnable" id = "taHelpIconId" />').appendTo(this.elements.innerTabPanel),this.elements.tabHelpIconImg=$('<img class="icon"/>').attr("src",this.resourceBase+"/css/images/help-tab.png").appendTo(this.elements.tabHelpIconDiv),this.elements.tabHelpIconDiv.hoverfn(function(){that.elements.tabHelpIconDiv.removeAttr("title"),that.tabPanelMouseEnterButton(this),that.options.isTooltipEnabled?that.tabPanelCustomTooltip(IC_Localization.helpTooltipTxt):that.elements.tabHelpIconDiv.attr("title",IC_Localization.help)},function(){that.mouseLeaveButton(this)}),this.elements.tabRightArrowIconImg=$("<div/>").css({float:"right"}).appendTo(this.elements.tabPanel),this.rightArrowImg=$("<img/>").addClass("rightArrowImg").attr("src",this.resourceBase+"/css/images/arrowright-enabled.png").appendTo(this.elements.tabRightArrowIconImg),this.elements.dialPadControl=$('<div class="modalDialogPanel" id = "dialPadPanelId"/>').appendTo(parent),this.elements.dialPadControl.dialPad({container:this,resourceBase:this.options.resourceBase}),this.elements.agentListControl=$('<div class="modalDialogPanel" id="agentListPanelId"/>').appendTo(parent),this.elements.agentListControl.agentList({container:this,resourceBase:this.options.resourceBase}),this.elements.skillListControl=$('<div class="modalDialogPanel" id = "skillListPanelId"/>').appendTo(parent),this.elements.skillListControl.skillList({container:this,resourceBase:this.options.resourceBase}),this.elements.addressBookControl=$('<div class="modalDialogPanel" id = "addessBookPanelId" />').appendTo(parent),this.elements.addressBookControl.addressBook({container:this,resourceBase:this.options.resourceBase}),this.elements.contactHistoryControl=$('<div class="modalDialogPanel" id = "contactHistoryPanelId" />').appendTo(parent),this.elements.contactHistoryControl.contactHistory({container:this,resourceBase:this.options.resourceBase}),this.elements.agentInfoControl=$('<div id = "agentInfoPanelId" class="modalDialogPanel"/>').appendTo(parent),this.elements.agentInfoControl.agentInformation({container:this,resourceBase:this.options.resourceBase}),this.elements.agentFeedbackControl=$('<div class="modalDialogPanel"/>').appendTo(parent),this.elements.agentFeedbackControl.agentFeedback({container:this,resourceBase:this.options.resourceBase}),this.elements.agentMessageControl=$('<div class="modalDialogPanel"/>').appendTo(parent),this.elements.agentMessageControl.agentMessage({container:this,resourceBase:this.options.resourceBase}),this.elements.keyPadControl=$('<div class="modalDialogPanelKeypad"/>').appendTo(parent),this.elements.keyPadControl.keyPad({container:this,resourceBase:this.options.resourceBase}),this.elements.promiseKeeperControl=$('<div id = "promiseKeeperPanelId" class="modalDialogPanel"/>').appendTo(parent),this.elements.promiseKeeperControl.promiseKeeper({container:this,resourceBase:this.options.resourceBase}),this.elements.evolveScheduleControl=$('<div id = "evolveSchedulePanelId" class="modalDialogPanel"/>').appendTo(parent),this.elements.evolveScheduleControl.evolveSchedule({container:this,resourceBase:this.options.resourceBase}),this.elements.promiseKeeperDetailsControl=$('<div id = "promiseKeeperDetailsPanelId" class="modalDialogPanel" role = "dialog" aria-label = "'+IC_Localization.commitmentDetails+'"/>').appendTo(parent),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails({container:this,resourceBase:this.options.resourceBase}),this.elements.promiseKeeperDateTimeControl=$('<div id = "promiseKeeperDateTimePanelId" class="modalDialogPanel"/>').appendTo(parent),this.elements.promiseKeeperDateTimeControl.promiseKeeperDateTime({container:this,resourceBase:this.options.resourceBase,dateTimeUpdatedCallback:function(reminderDateTime){that.elements.promiseKeeperDetailsControl.promiseKeeperDetails("updateCallbackTime",reminderDateTime)}}),this.elements.rescheduleDateTimeControl=$('<div id = "rescheduleDateTimePanelId" class="modalDialogPanel"/>').appendTo(parent),this.elements.rescheduleDateTimeControl.rescheduleDateTime({container:this,resourceBase:this.options.resourceBase}),this.elements.agentReportsControl=$('<div id = "agentReportsPanelId" class="modalDialogPanel"/>').appendTo(parent),this.elements.agentReportsControl.agentReports({container:this,resourceBase:this.options.resourceBase}),this.elements.agentReportsPerformanceControl=$('<div id = "agentPerformancePanelId" class="modalDialogPanel" role = "dialog" aria-label = "'+IC_Localization.agentPerformanceReport+'"/>').appendTo(parent),this.elements.agentReportsPerformanceControl.agentReportsPerformance({container:this,resourceBase:this.options.resourceBase}),this.elements.tabDialpadIconDiv.on("click",$.proxy(this.onClickTabDialPad,this)),this.elements.tabAgentsIconDiv.on("click",$.proxy(this.onClickTabAgents,this)),this.elements.tabSkillsIconDiv.on("click",$.proxy(this.onClickTabSkills,this)),this.elements.tabAddressBookIconDiv.on("click",$.proxy(this.onClickTabAddressBooks,this)),this.elements.tabHistoryIconDiv.on("click",$.proxy(this.onClickTabContactHistory,this)),this.elements.tabAgentInfoIconDiv.on("click",$.proxy(this.onClickTabAgentInfo,this)),this.elements.tabPromiseKeeperIconDiv.on("click",$.proxy(this.onClickTabPromiseKeeper,this)),this.elements.tabHelpIconDiv.on("click",$.proxy(this.onClickHelp,this)),this.elements.tabLeftArrowIconImg.on("click",$.proxy(this.onClickLeftArrow,this)),this.elements.tabRightArrowIconImg.on("click",$.proxy(this.onClickRightArrow,this)),this.elements.tabAgentReportsIconDiv.on("click",$.proxy(this.onClickTabAgentReports,this)),this.elements.tabOBEmailIconDiv.on("click",$.proxy(this.onClickTabEmail,this)),this.elements.tabEvolveScheduleIconDiv.on("click",$.proxy(this.onClickTabEvolveSchedule,this)),this.elements.tabMessageIconDiv.on("click",$.proxy(this.onClickTabMessage,this))},createHomePage:function(parent){var offsetTop,that=this,dialPanelAndIndicatorHt=0;this.createMultiContactControlsPanel(parent),this.elements.homePagePanel=$('<div class="homePage"/>').appendTo(parent),this.elements.HomeDialPadIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivDisable" id = "homeDialPadIconId"/>').appendTo(this.elements.homePagePanel),this.elements.HomeDialPadIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/hp-phone-disabled.png").appendTo(this.elements.HomeDialPadIconDiv),this.elements.HomeDialPadIconDiv.hoverfn(function(){that.elements.HomeDialPadIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.dialPadTooltipTxt,offsetTop)):that.elements.HomeDialPadIconDiv.attr("title",IC_Localization.dialPad)},function(){that.mouseLeaveButton(this)}),this.elements.HomeAgentsIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeAgentsIconId"/>').appendTo(this.elements.homePagePanel),$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/hp-agents.png").appendTo(this.elements.HomeAgentsIconDiv),this.elements.HomeAgentsIconDiv.hoverfn(function(){that.elements.HomeAgentsIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.agentListTooltipTxt,offsetTop)):that.elements.HomeAgentsIconDiv.attr("title",IC_Localization.agents)},function(){that.mouseLeaveButton(this)}),this.elements.HomeSkillsIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeSkillsIconId" />').appendTo(this.elements.homePagePanel),$('<img class="hpSkillIcon"/>').attr("src",this.resourceBase+"/css/images/SkillIcon.svg").appendTo(this.elements.HomeSkillsIconDiv),this.elements.HomeSkillsIconDiv.hoverfn(function(){that.elements.HomeSkillsIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.skillListTooltipTxt,offsetTop)):that.elements.HomeSkillsIconDiv.attr("title",IC_Localization.skills)},function(){that.mouseLeaveButton(this)}),this.elements.HomeAddressBooksIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeAddressBookIconId" />').appendTo(this.elements.homePagePanel),$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/hp-addrbook.png").appendTo(this.elements.HomeAddressBooksIconDiv),this.elements.HomeAddressBooksIconDiv.hoverfn(function(){that.elements.HomeAddressBooksIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.addressBookTooltipTxt,offsetTop)):that.elements.HomeAddressBooksIconDiv.attr("title",IC_Localization.addressBook)},function(){that.mouseLeaveButton(this)}),this.elements.HomeContactHistoryIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeContactHistoryIconId" />').appendTo(this.elements.homePagePanel),$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/hp-history.png").appendTo(this.elements.HomeContactHistoryIconDiv),this.elements.HomeContactHistoryIconDiv.hoverfn(function(){that.elements.HomeContactHistoryIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.contactHistoryTooltipTxt,offsetTop)):that.elements.HomeContactHistoryIconDiv.attr("title",IC_Localization.contactHistory)},function(){that.mouseLeaveButton(this)}),this.elements.HomeAgentInfoIconDiv=$('<div id = "HomeAgentInfoIconId" class="btnBrRound5 hpIconDiv btnDivEnable" />').appendTo(this.elements.homePagePanel),$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/hp-agentinfo.png").appendTo(this.elements.HomeAgentInfoIconDiv),this.elements.HomeAgentInfoIconDiv.hoverfn(function(){that.elements.HomeAgentInfoIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.agentInfoToolitipTxt,offsetTop)):that.elements.HomeAgentInfoIconDiv.attr("title",IC_Localization.agentInfo)},function(){that.mouseLeaveButton(this)}),this.elements.HomeOBEmailIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivDisable" id="HomeOBEmailIconDiv" style="display:none"/>').appendTo(this.elements.homePagePanel),this.elements.HomeOBEmailIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/mail-disable.png").appendTo(this.elements.HomeOBEmailIconDiv),this.elements.HomeOBEmailIconDiv.hoverfn(function(){that.elements.HomeOBEmailIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.emailTooltipTxt,offsetTop)):that.elements.HomeOBEmailIconDiv.attr("title",IC_Localization.email)},function(){that.mouseLeaveButton(this)}),this.elements.HomePromiseKeeperIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivDisable" id="HomePromiseKeeperIconDiv"/>').appendTo(this.elements.homePagePanel),this.elements.HomePromiseKeeperIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/home-pin-disabled.png").appendTo(this.elements.HomePromiseKeeperIconDiv),this.elements.HomePromiseKeeperIconDiv.hoverfn(function(){that.elements.HomePromiseKeeperIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.commitmentTooltipTxt,offsetTop)):that.elements.HomePromiseKeeperIconDiv.attr("title",IC_Localization.commitmentManager)},function(){that.mouseLeaveButton(this)}),this.elements.HomeAgentReportsIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeAgentReportsIconId"/>').appendTo(this.elements.homePagePanel),this.elements.HomeAgentReportsIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/agentreport-home.png").attr("alt",IC_Localization.agentReports).appendTo(this.elements.HomeAgentReportsIconDiv),this.elements.HomeAgentReportsIconDiv.hoverfn(function(){that.elements.HomeAgentReportsIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.agentReportsTooltipTxt,offsetTop)):that.elements.HomeAgentReportsIconDiv.attr("title",IC_Localization.agentReports)},function(){that.mouseLeaveButton(this)}),this.elements.HomeScheduleIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeScheduleIconId" style="display : none"/>').appendTo(this.elements.homePagePanel),this.elements.HomeScheduleIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/schedule.png").appendTo(this.elements.HomeScheduleIconDiv),this.elements.HomeScheduleIconDiv.hoverfn(function(){that.elements.HomeScheduleIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.scheduleTooltipTxt,offsetTop)):that.elements.HomeScheduleIconDiv.attr("title",IC_Localization.schedule)},function(){that.mouseLeaveButton(this)}),this.elements.HomeMessageIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeMessageIconId"/>').appendTo(this.elements.homePagePanel),this.elements.HomeMessageIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/messages.png").appendTo(this.elements.HomeMessageIconDiv),this.elements.HomeMessageIconDiv.hoverfn(function(){that.elements.HomeMessageIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.messageTooltipTxt,offsetTop)):that.elements.HomeMessageIconDiv.attr("title",IC_Localization.message)},function(){that.mouseLeaveButton(this)}),this.elements.HomeHelpIconDiv=$('<div class="btnBrRound5 hpIconDiv btnDivEnable" id = "homeHelpIconId"/>').appendTo(this.elements.homePagePanel),this.elements.HomeHelpIconImg=$('<img class="hpIcon"/>').attr("src",this.resourceBase+"/css/images/help-home.png").appendTo(this.elements.HomeHelpIconDiv),this.elements.HomeHelpIconDiv.hoverfn(function(){that.elements.HomeHelpIconDiv.removeAttr("title"),that.homePanelMouseEnterButton(this),that.options.isTooltipEnabled?(dialPanelAndIndicatorHt=that.getDialerPanelAndIndicator(),offsetTop=$(this).offset().top-53-dialPanelAndIndicatorHt,that.homePanelCustomTooltip(IC_Localization.helpTooltipTxt,offsetTop)):that.elements.HomeHelpIconDiv.attr("title",IC_Localization.help)},function(){that.mouseLeaveButton(this)}),this.elements.HomeAgentsIconDiv.on("click",$.proxy(this.onClickHomeAgents,this)),this.elements.HomeSkillsIconDiv.on("click",$.proxy(this.onClickHomeSkills,this)),this.elements.HomeDialPadIconDiv.on("click",$.proxy(this.onClickHomeDialPad,this)),this.elements.HomeAddressBooksIconDiv.on("click",$.proxy(this.onClickHomeAddressBooks,this)),this.elements.HomeContactHistoryIconDiv.on("click",$.proxy(this.onClickHomeContactHistory,this)),this.elements.HomeAgentInfoIconDiv.on("click",$.proxy(this.onClickHomeAgentInfo,this)),this.elements.HomeOBEmailIconDiv.on("click",$.proxy(this.onClickHomeEmail,this)),this.elements.HomePromiseKeeperIconDiv.on("click",$.proxy(this.onClickHomePromiseKeeper,this)),this.elements.HomeHelpIconDiv.on("click",$.proxy(this.onClickHelp,this)),this.elements.HomeAgentReportsIconDiv.on("click",$.proxy(this.onClickHomeAgentReports,this)),this.elements.HomeScheduleIconDiv.on("click",$.proxy(this.onClickHomeEvolveSchedule,this)),this.elements.HomeMessageIconDiv.on("click",$.proxy(this.onAgentMsgScrollClick,this))},getDialerPanelAndIndicator:function(){var height=0;return this.isDialerPanel&&(height+=30),this.showIndicator&&(height+=23),height},homePanelMouseEnterButton:function(that){var btnDiv=$(that);(IC_Common.isButtonEnabled(btnDiv)||IC_Common.isButtonSelected(btnDiv))&&btnDiv.addClass("btnDivHover")},homePanelCustomTooltip:function(text,top){var tooltip=this.textMask(text,190);this.tooltipTxt.html(tooltip.value+" "+tooltip.hyper),this.elements.tooltipDiv.css({display:"block",bottom:"",top:top})},tabPanelMouseEnterButton:function(that){var btnDiv=$(that);(IC_Common.isButtonEnabled(btnDiv)||IC_Common.isButtonSelected(btnDiv))&&btnDiv.addClass("btnDivHover")},tabPanelCustomTooltip:function(text){var tooltip=this.textMask(text,190);this.tooltipTxt.html(tooltip.value+" "+tooltip.hyper),this.elements.tooltipDiv.css({display:"block",bottom:"32px",top:""})},mouseLeaveButton:function(that){$(that).removeClass("btnDivHover"),this.elements.tooltipDiv.css("display","none")},onClickRightArrow:function(){var numOfIcons=$("#innerTabPanelId").children().filter(":visible").length,left=parseInt(this.elements.innerTabPanel.css("left").replace("px","")),diff=31*numOfIcons-155;(0==left||left>-diff)&&(this.leftArrowImg.attr("src",this.resourceBase+"/css/images/arrowleft-enabled.png"),left-=32,$("#innerTabPanelId").css("left",left+"px")),left<=-diff&&this.rightArrowImg.attr("src",this.resourceBase+"/css/images/arrowright-disabled.png")},onClickLeftArrow:function(){var left=parseInt(this.elements.innerTabPanel.css("left").replace("px",""));left<0&&(this.rightArrowImg.attr("src",this.resourceBase+"/css/images/arrowright-enabled.png"),left+=32,$("#innerTabPanelId").css("left",left+"px")),0==left&&this.leftArrowImg.attr("src",this.resourceBase+"/css/images/arrowleft-disabled.png")},textMask:function(text,width){var moreLink,str,len=0,moreTxt=IC_Localization.more;return void 0!==text&&(len=text.length),width<len?(str=text.substring(0,Math.abs(width-4))+"... ",moreLink='<a href = "'+this.options.appHelpTarget+'" target="_blank" id="goHelp">'+moreTxt+"</a>"):(str=text,moreLink=""),{value:str,hyper:moreLink}},createMultiContactControlsPanel:function(parent){IC_Localization.search;this.elements.contactsRootPanel=$('<div class="contactsRootPanel"/>').appendTo(parent),this.elements.mediaTabsDiv=$('<div class="mediaTabsDiv"/>').appendTo(this.elements.contactsRootPanel),this.omniTabDiv=$('<div class="mediaIconsDiv"  id="omniTab" title="'+IC_Localization.omni+'"/>').css("display","none").on("click",$.proxy(this.showOmniContactTab,this)).appendTo(this.elements.mediaTabsDiv),this.omniIndicateIcon=$('<div class="mediaStateIcons" />').appendTo(this.omniTabDiv),this.omniTabIcon=$('<img class="mediaIcons" src="'+this.resourceBase+'/css/images/omni-icon-disable.png" />').css({width:"19px",height:"19px","margin-top":"-4px"}).appendTo(this.omniTabDiv),this.omniTabDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.omniTabDiv.off("mouseenter mouseleave"),this.omniTabDiv.off("click"),this.phoneTabDiv=$('<div class="mediaIconsDiv" id="phoneTab"  title="'+IC_Localization.phone+'"/>').on("click",$.proxy(this.showPhoneContactTab,this)).appendTo(this.elements.mediaTabsDiv),this.phoneIndicateIcon=$('<div class="mediaStateIcons" />').appendTo(this.phoneTabDiv),this.phoneTabIcon=$('<img class="mediaIcons" src="'+this.resourceBase+'/css/images/agent-info-skills-phone.png" />').appendTo(this.phoneTabDiv),this.phoneTabDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.chatTabDiv=$('<div class="mediaIconsDiv"  id="chatTab" title="'+IC_Localization.chat+'"/>').on("click",$.proxy(this.showChatContactTab,this)).appendTo(this.elements.mediaTabsDiv),this.chatIndicateIcon=$('<div class="mediaStateIcons" />').appendTo(this.chatTabDiv),this.chatTabIcon=$('<img class="mediaIcons" src="'+this.resourceBase+'/css/images/chatIcn-dark.png" />').css("margin-top","-2px").appendTo(this.chatTabDiv),this.chatTabDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.emailTabDiv=$('<div class="mediaIconsDiv" id="emailTab"  title="'+IC_Localization.email+'"/>').on("click",$.proxy(this.showEmailContactTab,this)).appendTo(this.elements.mediaTabsDiv),this.emailIndicateIcon=$('<div class="mediaStateIcons"/>').appendTo(this.emailTabDiv),this.emailTabIcon=$('<img class="mediaIcons" src="'+this.resourceBase+'/css/images/mail.png" />').css({width:"21px",height:"19px","margin-top":"-4px","margin-right":"4px"}).appendTo(this.emailTabDiv),this.emailTabDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.voicemailTabDiv=$('<div class="mediaIconsDiv" id="voicemailTab"  title="'+IC_Localization.voicemail+'"/>').on("click",$.proxy(this.showVoiceMailContactTab,this)).appendTo(this.elements.mediaTabsDiv),this.voicemailIndicateIcon=$('<div class="mediaStateIcons" />').appendTo(this.voicemailTabDiv),this.voicemailTabIcon=$('<img class="mediaIcons" src="'+this.resourceBase+'/css/images/personal-connection-override-answer-machine.png" />').css("margin-right","5px").appendTo(this.voicemailTabDiv),this.voicemailTabDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.workItemTabDiv=$('<div class="mediaIconsDiv" id="workitemTab"  title="'+IC_Localization.workItem+'"/>').on("click",$.proxy(this.showWorkItemContactTab,this)).appendTo(this.elements.mediaTabsDiv),this.workItemIndicateIcon=$('<div class="mediaStateIcons" />').appendTo(this.workItemTabDiv),this.workItemTabIcon=$('<img class="mediaIcons" src="'+this.resourceBase+'/css/images/agent-info-skills-work-item.png" />').css({width:"16px",height:"17px","margin-top":"-2px"}).appendTo(this.workItemTabDiv),this.workItemTabDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.elements.multiCallControl.appendTo(this.elements.contactsRootPanel),this.elements.omniContactTab=$('<div class="activeContactsPanel" id = "mainWin_ActiveContactsPanelId" />').appendTo(this.elements.contactsRootPanel),this.elements.phoneContactTab=$('<div class="activeContactsPanel"/>').appendTo(this.elements.contactsRootPanel),this.elements.phoneContacts=$("<div/>").appendTo(this.elements.phoneContactTab),this.elements.phoneContainer=$("<div/>").appendTo(this.elements.phoneContacts),this.elements.chatContactTab=$('<div class="activeContactsPanel"/>').appendTo(this.elements.contactsRootPanel),this.elements.emailContactTab=$('<div class="activeContactsPanel"/>').appendTo(this.elements.contactsRootPanel),this.elements.voiceMailContactTab=$('<div class="activeContactsPanel" />').appendTo(this.elements.contactsRootPanel),this.elements.workItemContactTab=$('<div class="activeContactsPanel" />').appendTo(this.elements.contactsRootPanel),this.elements.pcInventoryAndRinging=$("<div/>").appendTo(this.elements.phoneContacts),this.element.callQueuePanel=$('<div class="ringName"/>'),this.element.callQueuePanel.appendTo(this.elements.pcInventoryAndRinging),this.element.skillRunningLow=$('<div class="skillRunningLow btnDivEnable" />'),this.element.skillRunningLow.text(IC_Localization.recordInventoryLow),this.element.skillRunningLow.appendTo(this.elements.pcInventoryAndRinging),this.elements.emailListControlPanel.appendTo(this.elements.emailContactTab)},showOmniContactTab:function(){var getSelected=this.getCurrentSelectedMediaTab();"OmniContact"!==getSelected?(this.hideSelectedMediaTabControl(getSelected),this.elements.omniContactTab.showfn(),this.enableTabBGColor(this.omniTabDiv),this.updateContactResultPnl()):this.enableTabBGColor(this.omniTabDiv)},showPhoneContactTab:function(){var getSelected=this.getCurrentSelectedMediaTab();"Phone"!==getSelected?(this.hideSelectedMediaTabControl(getSelected),this.elements.phoneContactTab.showfn(),this.enableTabBGColor(this.phoneTabDiv),this.updateContactResultPnl()):this.enableTabBGColor(this.phoneTabDiv)},showChatContactTab:function(){var getSelected=this.getCurrentSelectedMediaTab();this.chatIndicateIcon.addClass("viewedContactTabIndicate"),this.chatIndicateIcon.removeClass("newContactTabIndicate noReplyNewContact"),"Chat"!==getSelected?(this.hideSelectedMediaTabControl(getSelected),this.elements.chatContactTab.showfn(),this.enableTabBGColor(this.chatTabDiv),this.chatIndicateIcon.addClass("viewedContactTabIndicate").removeClass("newContactTabIndicate"),this.updateContactResultPnl()):this.enableTabBGColor(this.chatTabDiv)},showEmailContactTab:function(){var getSelected=this.getCurrentSelectedMediaTab();"Email"!==getSelected?(this.hideSelectedMediaTabControl(getSelected),this.elements.emailContactTab.showfn(),this.enableTabBGColor(this.emailTabDiv),this.updateContactResultPnl()):this.enableTabBGColor(this.emailTabDiv)},showVoiceMailContactTab:function(){var getSelected=this.getCurrentSelectedMediaTab();"VoiceMail"!==getSelected?(this.hideSelectedMediaTabControl(getSelected),this.elements.voiceMailContactTab.showfn(),this.enableTabBGColor(this.voicemailTabDiv),this.updateContactResultPnl()):this.enableTabBGColor(this.voicemailTabDiv)},showWorkItemContactTab:function(){var getSelected=this.getCurrentSelectedMediaTab();"WorkItem"!==getSelected?(this.hideSelectedMediaTabControl(getSelected),this.elements.workItemContactTab.showfn(),this.enableTabBGColor(this.workItemTabDiv),this.updateContactResultPnl()):this.enableTabBGColor(this.workItemTabDiv)},authenticateAndLoginAgent:function(isAutoLoginDisabled){AgentConsoleDataStore.isTokenExpired()?AgentConsoleDataStore.redirectToLoginPage(isAutoLoginDisabled):this.loginAgent(isAutoLoginDisabled)},loginAgent:function(isAutoLoginDisabled){logger.trace("loginAgent: ...");AgentConsoleDataStore.sfMode=!1===IC_Validation.isNotNullOrEmpty(this.options.sfMode)?"Classic":this.options.sfMode,AgentConsoleDataStore.loginAgent(this.options.sfUserId,this.options.stationId,this.options.phoneNo,$.proxy(this.onLoginSuccess,this),$.proxy(this.onLoginFailure,this),isAutoLoginDisabled)},onLoginSuccess:function(data){this.isWebRTC()&&this.startWebRTCSession()},startWebRTCSession:function(){logger.debug("startWebRTCSession >>"),this.createAudioElement(),$(document).on(webRTC.WebRTCStatusChangedEvent,$.proxy(this.WebRTCStatusChangedEvent,this)),webRTC.startSession(),logger.debug("startWebRTCSession <<")},createAudioElement:function(){IC_Validation.isNullOrEmpty(this.elements.audioElement)&&(this.elements.audioElement=$("<audio id='audio'>").attr({autoplay:"autoplay",controls:"controls"}).hide().prop("volume",this.defaultSoftPhoneVolume),this.elements.rootDiv.append(this.elements.audioElement))},isWebRTC:function(){return this.options.phoneNo==IC_Util.WebRTC},onLoginFailure:function(statusCode,statusText,statusResponse,isAuthenticationFailure){logger.debug("onLoginFailure - statusCode :"+statusCode+", statusText :"+statusText);var error={ShowError:!0,msg:void 0!==statusText?IC_Localization.loginFailedError+statusCode+" ("+statusText+")":IC_Localization.loginFailedErrorAttempt,response:IC_Validation.isNotNullOrEmpty(statusResponse)?IC_Common.parseJSON(statusResponse):null};this.onOptionsPanelOpen(!1,error)},isApiMessage:function(event,apiEndPoint){return"string"==typeof event.data&&(event.data&&0===event.data.indexOf(apiEndPoint))},processPostMessage:function(event){var message;if(event.origin===this.options.sfdcOrigin)try{this.isApiMessage(event,this.IC_AGENT_CONSOLE_API)&&(message=IC_Common.parseJSON(event.data.replace(this.IC_AGENT_CONSOLE_API,"")),logger.debug("processPostMessage - ClickToDial :",message),"clickToDial"===message.type?this.onClickToDial(message.data):"focusevent"===message.type?AgentConsoleDataStore.onWindowFocusChanged(!1,message.data):"skillListReceived"===message.type&&(logger.trace("skillList posted to home page component successfully."),this.isSkillListPostSuccess=!0,clearInterval(this.skillListCheckInterval),this.currentSkillPostCount=0))}catch(e){logger.error("Failed to process post message from "+this.options.sfdcOrigin,e)}},showPopup:function(id,messages,timeout){var i=0,message="",levelCss="";if(logger.trace("showPopup id :"+id),IC_Validation.isNotNullOrEmptyArray(messages)){if(this.elements.msgDiv.children("span, br").remove(),"block"!==this.elements.loginPopupDiv.css("display")){for(i=0;i<messages.length;i++)message=messages[i].message,levelCss=messages[i].levelCss,this.addMessage(levelCss,message);this.currentPopupId=id}if("Logged out"===this.agentInfo.cState.state)logger.trace("showPopup login popup isAutoLoginErr:"+this.isAutoLoginErr),this.elements.popupDiv.hide(),this.elements.loginPopupDiv.showfn(),this.isAutoLoginErr?this.elements.loginMsgDiv.hide():this.elements.loginMsgDiv.showfn();else if("block"!==this.elements.loginPopupDiv.css("display")){if(logger.trace("showPopup : popup div"),this.elements.msgDiv.children("span").text()===IC_EventErrorMessages.Custom_SessionEnd)return;this.elements.popupDiv.showfn(),this.elements.msgDiv.css("display","block"),this.elements.msgDiv.trigger("focus"),IC_Validation.isNumber(timeout)&&setTimeout($.proxy(this.hidePopup,this),timeout)}}},hidePopup:function(){var popupDiv,removeDiv,msgDiv=this.elements.msgDiv,that=this;if("block"===this.elements.loginPopupDiv.css("display")){if(logger.trace("hidePopup : login popup div"),popupDiv=this.elements.loginPopupDiv,"Logged out"===this.agentInfo.cState.state)return}else logger.trace("hidePopup : popup div"),popupDiv=this.elements.popupDiv,removeDiv=msgDiv.children("span, br");popupDiv.fadeOut(function(){IC_Validation.isNotNullOrEmpty(removeDiv)&&removeDiv.remove(),msgDiv.removeClass("msgWithNoBtns"),0===that.currentPopupId?that.currentPopupId=null:(AgentConsoleDataStore.removeErrorFromStore(that.currentPopupId),that.currentPopupId=null),setTimeout($.proxy(that.showEventErrorMessages,that),0)})},addMessage:function(msgClass,message){logger.trace("addMessage - message :"+message),this.elements.msgDiv.children().length>1&&$("<br/><br/>").appendTo(this.elements.msgDiv),$('<span class="'+msgClass+'" id="infoMsgId"/>').html(message).appendTo(this.elements.msgDiv)},addCallMessage:function(msgClass,message){logger.trace("addCallMessage - message :"+message),this.elements.msgDiv.css("display","none").removeClass("msgWithNoBtns"),this.elements.callMsgDiv.css("display","block"),this.elements.callMsgDiv.children().length>1&&$("<br/><br/").appendTo(this.elements.callMsgDiv),$('<span class="'+msgClass+'" id="confirmationPrompt"/>').text(message).appendTo(this.elements.callMsgDiv)},showEventErrorMessages:function(){if(IC_Validation.isNotNullOrEmpty(AgentConsoleDataStore.errorList)&&AgentConsoleDataStore.errorList.length>0){logger.trace("showEventErrorMessages - Error length :"+AgentConsoleDataStore.errorList.length);var errMsgObj,message,timeOut,errorMessages=AgentConsoleDataStore.errorList[0].messages,i=0,messages=[],levelCss="";for(i=0;i<errorMessages.length;i++)levelCss="Medium"===(errMsgObj=errorMessages[i]).level||"Critical"===errMsgObj.level?"eMsg":"iMsg","Custom_GetNextErrorAttemptWarn"===errMsgObj.code&&(timeOut=25e3,this.elements.msgDiv.addClass("msgWithNoBtns")),IC_EventErrorMessages[errMsgObj.code]?message=IC_EventErrorMessages[errMsgObj.code]:(logger.trace("Unexpected Agent Error:"+errMsgObj.code),message=IC_EventErrorMessages.Generic_Custom_Error),IC_Validation.isNotNullOrEmpty(message)&&messages.push({message:message,levelCss:levelCss});messages.length>0&&this.showPopup(AgentConsoleDataStore.errorList[0].id,messages,timeOut)}},getGlobalLogLevel:function(){return AgentConsoleDataStore.getGlobalLogLevel()},onAPIErrorEventUpdate:function(){if(IC_Validation.isNotNullOrEmpty(this.currentPopupId)){if(logger.trace("onAPIErrorEventUpdate - currentPopupId :"+this.currentPopupId),0===this.currentPopupId)return;logger.trace("onAPIErrorEventUpdate - error length"+AgentConsoleDataStore.errorList.length),0!==AgentConsoleDataStore.errorList.length&&AgentConsoleDataStore.errorList[0].id===this.currentPopupId||this.hidePopup()}this.showEventErrorMessages()},onAgentSessionStart:function(){var messages=[],aInfo=AgentConsoleDataStore.agentInfo;if(logger.trace("onAgentSessionStart - session joined : "+aInfo.joinSession),this.agentInfo.id=aInfo.id,this.agentInfo.phNo=aInfo.phNo,this.agentInfo.busNo=aInfo.busNo,this.agentInfo.stationId=aInfo.stationId,this.agentInfo.enabledForMCH=aInfo.enabledForMCH,IC_Validation.isNotNullOrUndefinedString(aInfo.mask)&&(this.agentInfo.mask=aInfo.mask),!0===aInfo.joinSession){var msg1=IC_Validation.isNotNullOrUndefinedString(this.agentInfo.stationId)&&"0"!==this.agentInfo.stationId?this.agentInfo.stationId:this.agentInfo.phNo;if(messages.push({message:IC_Localization.joinedSessionAlreadyInProgress+' <span class="joinSessionPnNo" title="'+msg1+'">'+msg1+"</span>",levelCss:"iMsg"}),IC_Validation.isNotNullOrUndefinedString(this.options.phoneNo)&&this.agentInfo.phNo!==this.options.phoneNo||IC_Validation.isNotNullOrUndefinedString(this.options.stationId)&&this.agentInfo.stationId!==this.options.stationId){var msg2=IC_Validation.isNotNullOrUndefinedString(this.options.stationId)&&"0"!==this.options.stationId?this.options.stationId:this.options.phoneNo;messages.push({message:IC_Localization.stationIDErrorAttempt+msg2,levelCss:"eMsg"})}this.showPopup(0,messages,1e4)}if(IC_Validation.isNotNullOrUndefinedString(this.options.agentAudioSettings)){var userCredential=AgentConsoleDataStore.getCustomVar("UserAVSettings");IC_Validation.isValidObject(userCredential)||(userCredential={agentAudioSettings:this.options.agentAudioSettings,agentVisualSettings:this.options.agentVisualSettings},AgentConsoleDataStore.setCustomVar("UserAVSettings",userCredential))}IC_Validation.isNotNullOrEmpty(this.elements.optionPanel)&&this.elements.optionPanel.userSetting("showLogoutbtn"),this.agentInfo.dialerCampaign=aInfo.dialerCampaign,this.agentInfo.dialerLoginTime=aInfo.dialerLoginTime,this.elements.footerPanel.footer("toggleFooterCount",!0)},onAgentSessionEnd:function(){this.isAutoLoginErr=!1;var userCredential=AgentConsoleDataStore.getCustomVar("UserCredential"),userAVSettings=AgentConsoleDataStore.getCustomVar("UserAVSettings");that=this,this.isWebRTC()&&webRTC.stopSession(),!0!==AgentConsoleDataStore.getCustomVar("UserLoginRequested")?(logger.debug("onAgentSessionEnd - UserLoginRequested: false"),AgentConsoleDataStore.addCustomError("Custom_SessionEnd","Info")):(logger.debug("onAgentSessionEnd - UserLoginRequested: true"),IC_Validation.isValidObject(userCredential)&&(this.options.username=userCredential.username,this.options.stationId=userCredential.stationId,this.options.phoneNo=userCredential.phoneNo,this.options.isAutoLogin=userCredential.isAutoLogin,this.options.isTooltipEnabled=userCredential.isTooltipEnabled,this.options.agentAudioSettings=userAVSettings.agentAudioSettings,this.options.agentVisualSettings=userAVSettings.agentVisualSettings),this.authenticateAndLoginAgent(!0)),this.hideContactsRootPanel(),this.closeUserSetting(),this.elements.footerPanel.footer("toggleFooterCount",!1),AgentConsoleDataStore.setCustomVar("UserLoginRequested",!1)},onAgentInfoUpdate:function(){var aInfo=AgentConsoleDataStore.agentInfo,muteState="disabled";if(IC_Validation.isNotNull(aInfo)){if(this.agentInfo.mask=aInfo.mask,this.agentInfo.dialerCampaign=aInfo.dialerCampaign,this.agentInfo.dialerLoginTime=aInfo.dialerLoginTime,IC_Validation.isNotNullOrEmpty(aInfo.cState)&&(this.agentInfo.cState=aInfo.cState,this.agentInfo.nState=aInfo.nState,this.elements.agentStatePanel.agentState("updateData",this.agentInfo),logger.debug("onAgentInfoUpdate - cState :"+JSON.stringify(aInfo.cState)+", nState :"+JSON.stringify(aInfo.nState)),"Logged out"===aInfo.cState.state?(this.hideContentPanelWrapper(),this.isAutoLoginErr=!1,this.elements.loginPopupDiv.showfn(),this.elements.loginMsgDiv.showfn()):"Logging in"!==aInfo.cState.state&&this.showContentPanelWrapper(),"Logged out"!==aInfo.cState.state&&this.elements.loginPopupDiv.hide(),"PromisePending"===aInfo.cState.reason?this.showPromiseKeeperLayer():this.hidePromiseKeeperLayer()),IC_Validation.isNotNullOrEmpty(aInfo.lgState)&&(logger.debug("onAgentInfoUpdate - leg state :"+aInfo.lgState+", Id :"+aInfo.lgId),this.agentInfo.lgState=aInfo.lgState,this.agentInfo.lgId=aInfo.lgId,"Dialing"===this.agentInfo.lgState?(this.elements.agentLegState.attr("src",this.resourceBase+"/css/images/leg-ring.png"),this.elements.agentLegState.attr("title",IC_Localization.agentLegDialing)):"Active"===this.agentInfo.lgState?(this.elements.agentLegState.attr("src",this.resourceBase+"/css/images/leg-oncall.png"),this.elements.agentLegState.attr("title",IC_Localization.agentLegConnected)):(this.elements.agentLegState.attr("src",this.resourceBase+"/css/images/leg-off.png"),this.elements.agentLegState.attr("title",IC_Localization.agentLegDisconnected)),IC_Validation.isValidObject(this.acceptRejectPanel)&&("consultAcceptRejectPanel"===this.acceptRejectPanelType?this.acceptRejectPanel.consultAcceptRejectPanel("updateData","agentLeg",this.agentInfo.lgState):"pcAcceptRejectControl"===this.acceptRejectPanelType&&this.acceptRejectPanel.pcAcceptRejectControl("updateData","agentLeg",this.agentInfo.lgState))),void 0!==this.callContacts&&(muteState=this.callContacts.length>0?"enabled":muteState),IC_Validation.isNotNullOrEmpty(aInfo.lgMuted)&&(this.agentInfo.lgMuted=aInfo.lgMuted,muteState=!0===aInfo.lgMuted?"selected":muteState,IC_Validation.isValidObject(this.activeContactWidgets)))for(i=0;i<aInfo.contacts.length;i++)"CallContactEvent"===aInfo.contacts[i].contactType&&this.activeContactWidgets.hasOwnProperty(aInfo.contacts[i].id)&&this.activeContactWidgets[aInfo.contacts[i].id].sideBarCallControl("onMute",aInfo.lgMuted);if(this.elements.multiCallControl&&(logger.debug("onAgentInfoUpdate - multiCallControl mute state :"+muteState),this.elements.multiCallControl.multiCallControl("setVisibilityMute",muteState)),this.elements.agentInfoControl.agentInformation("updateMetaData","Info",AgentConsoleDataStore.agentInfo),this.elements.agentStatePanel.agentState("updateMetaData","Info",AgentConsoleDataStore.agentInfo),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("updateMetaData","Info",AgentConsoleDataStore.agentInfo),IC_Validation.isNotNullOrEmpty(aInfo.nState)){var lastState=aInfo.nState[aInfo.nState.length-1];this.isEmailValidState="Unavailable"!==aInfo.cState.state&&"Unavailable"!==lastState.state&&"Available"!==aInfo.cState.state}this.addEmail(),this.elements.emailListControlPanel.emailListControl("updateControlPanel")}},addEmail:function(){var parkedEmailList=AgentConsoleDataStore.parkedEmailList;$.grep(parkedEmailList,function(item){return item.targetAgentId!=AgentConsoleDataStore.agentInfo.id}).length>=AgentConsoleDataStore.agentInfo.maxEmailInboxAllowed&&(this.isEmailLimitReached=!0),this.emailQueueCount>0&&this.isEmailValidState&&(clearTimeout(this.emailInboxTimerId),this.emailInboxTimer())},timeDiff:function(timeStamp){var now=(new Date).getTime(),ms=Math.abs(now-timeStamp);return Math.round(ms)},emailInboxTimer:function(){var lastAddEmailTimeStamp=IC_Validation.isNotNullOrUndefinedString(localStorage.lastAddEmailTimeStamp)?parseInt(localStorage.lastAddEmailTimeStamp):0;12e4<(lastAddEmailTimeStamp=this.timeDiff(lastAddEmailTimeStamp))&&(AgentConsoleDataStore.addEmail(),localStorage.lastAddEmailTimeStamp=(new Date).getTime())},showPromiseKeeperLayer:function(){this.commitmentPendingLayer.showfn(),this.commitmentPendingLayer.css("bottom",this.getFooterAndBrandingHeight()),this.hideAllTabs(),this.showHomeOrContactsRootPanel()},hidePromiseKeeperLayer:function(){this.commitmentPendingLayer.hide(),AgentConsoleDataStore.commitmentReminderWnd&&!1===AgentConsoleDataStore.commitmentReminderWnd.closed&&AgentConsoleDataStore.commitmentReminderWnd.destroyReminder()},onAllUnavailableListUpdate:function(){},onUnavailableListUpdate:function(){logger.trace("onUnavailableListUpdate ..."),this.elements.agentStatePanel.agentState("updateMetaData","teamUnavailable",AgentConsoleDataStore.teamUnavailableList)},updateAllContactWidgets:function(){logger.trace("updateAllContactWidgets ...");var i=0,len=AgentConsoleDataStore.contacts.length,contact=null;for(i=0;i<len;i++)contact=AgentConsoleDataStore.contacts[i],IC_Validation.isValidObject(contact)&&(this.activeContactWidgets.hasOwnProperty(contact.id)&&(this.addContactMetaData(contact),"CallContactEvent"===contact.contactType?(this.activeContactWidgets[contact.id].sideBarCallControl("setCanMask",this.agentInfo.mask),this.activeContactWidgets[contact.id].sideBarCallControl("updateData",contact)):"WorkItemContactEvent"===contact.contactType?this.activeContactWidgets[contact.id].sideBarWorkItemControl("updateData",contact):"EmailContactEvent"===contact.contactType?this.activeContactWidgets[contact.id].sideBarEmailControl("refresh",contact):"ChatContactEvent"===contact.contactType?this.activeContactWidgets[contact.id].sideBarChatControl("updateData",contact):"VoiceMailContactEvent"===contact.contactType&&this.activeContactWidgets[contact.id].sideBarVoiceMailControl("updateData",contact)),IC_Validation.isValidObject(this.acceptRejectPanel)&&"consultAcceptRejectPanel"===this.acceptRejectPanelType&&"Consult"===contact.type&&(this.addContactMetaData(contact),this.acceptRejectPanel.consultAcceptRejectPanel("updateAgentName",contact)))},showDialerNotification:function(){var nonParkedContacts=AgentConsoleDataStore.getNonParkedContacts(),nonParkedContactsLength=nonParkedContacts.length;if(AgentConsoleDataStore.pcQueueContacts.length||!1===AgentConsoleDataStore.isSkillRunningLow)if(1===nonParkedContactsLength){var status=nonParkedContacts[0].status;if("NaturalCallRinging"===status||"NaturalCallDialing"===status||"NaturalCallAMD"===status||"Disconnected"===status)return logger.trace("showDialerNotification : true"),!0}else if(0===nonParkedContactsLength)return logger.trace("showDialerNotification : true"),!0;return logger.trace("showDialerNotification : false"),!1},onPCQueueCountUpdate:function(){if(IC_Validation.isNotNullOrUndefinedString(this.element.callQueuePanel))if(AgentConsoleDataStore.pcQueueContacts.length>0){for(this.isPCQueueContactActive=!0,this.initialTimerVal=0,this.lastServerTimestamp=this.getServerTimestamp(),this.startTimer(),$(".ringNameTemp.callQueuePanel").remove(),i=0;i<AgentConsoleDataStore.pcQueueContacts.length;i++)if("Active"===AgentConsoleDataStore.pcQueueContacts[i].status||"Disconnected"===AgentConsoleDataStore.pcQueueContacts[i].status)AgentConsoleDataStore.pcQueueContacts.splice(i,1),this.isPCQueueContactActive=!1;else{var callQueuePanelRingName=$('<div class="ringNameTemp callQueuePanel btnDivEnable" />'),callQueueInfo=$('<div class="callQueueInfo" />'),ringTimer=$('<div id="ringTimerId" class="ringTimer" />');if(callQueueInfo.text(AgentConsoleDataStore.pcQueueContacts[i].name),callQueuePanelRingName.append(callQueueInfo),callQueuePanelRingName.append(ringTimer),0===i){var dnis=$('<div class="dnis" />');dnis.text(AgentConsoleDataStore.pcQueueContacts[i].dnis),callQueuePanelRingName.append(dnis),callQueuePanelRingName.css("height","40px")}this.element.callQueuePanel.append(callQueuePanelRingName)}$(".callQueueInfo").each(function(index){var callQueueInfoWith=$(this).css("width").replace("px",""),name=$(this).text();$(this).css("height").replace("px","")!=$(this).prop("scrollHeight")&&(IC_Common.setTextWithEllipsis($(this),name,callQueueInfoWith,!0),$(this).attr("title",name))}),this.onNewContactWidgetCreated(),this.isPCQueueContactActive?(this.element.callQueuePanel.showfn(),this.showPhoneContactTab(),this.enableDisableMediaTab()):this.element.callQueuePanel.hide(),logger.trace("onPCQueueCountUpdate : callQueuePanel show")}else this.clearTimer(),this.isPCQueueContactActive=!1,this.element.callQueuePanel.hide(),0===AgentConsoleDataStore.getNonParkedContactsCount()&&0===Object.keys(this.activeContactWidgets).length&&!IC_Validation.isValidObject(this.acceptRejectPanel)&&IC_Validation.isNullOrEmpty(this.agentInfo.dialerCampaign)&&(logger.trace("onPCQueueCountUpdate : hideContactsRootPanel hide"),this.hideContactsRootPanel())},onChatMsgUpdate:function(eventData,isIntialLoad){if(AgentConsoleDataStore.contacts.length>0){var contact,i=0,contacts=Object.clone(AgentConsoleDataStore.contacts),chatWidget=null,lastContactId=AgentConsoleDataStore.chatMsgUpdatedContactId;for(logger.trace("ContactID: "+lastContactId," onChatMsgUpdate - updated"),i=0;i<contacts.length;i++)contact=contacts[i],IC_Validation.isNullOrEmpty(lastContactId)||!0===AgentConsoleDataStore.chatMsgIntialLoad?"ChatContactEvent"===contact.contactType&&this.activeContactWidgets.hasOwnProperty(contact.id)&&(chatWidget=this.activeContactWidgets[contact.id],IC_Validation.isNotNullOrEmptyArray(AgentConsoleDataStore.chatMsg[contact.id])&&chatWidget.sideBarChatControl("updateMetaData","chatText",AgentConsoleDataStore.chatMsg[contact.id])):lastContactId===contact.id&&this.activeContactWidgets.hasOwnProperty(contact.id)&&(chatWidget=this.activeContactWidgets[contact.id],IC_Validation.isNotNullOrEmptyArray(AgentConsoleDataStore.chatMsg[contact.id])&&chatWidget.sideBarChatControl("updateMetaData","chatText",AgentConsoleDataStore.chatMsg[contact.id]))}!0===isIntialLoad&&(AgentConsoleDataStore.chatMsgIntialLoad=!1)},chatContactCount:function(){var contact,i=0,chatContactCount=0,contacts=AgentConsoleDataStore.contacts,contactToShow="",contactStatus="",lstChatId=[];for(this.chatContacts=[],i=0;i<contacts.length;i++)"ChatContactEvent"===(contact=contacts[i]).contactType&&(lstChatId[contact.id]=!0,chatContactCount++,this.chatContacts.push(contact)),!0===contact.active&&(contactStatus=contact.status,contactToShow=contact.id,contact.lastStateTime);for(contactId in this.chatDisconnectedWidget)this.chatDisconnectedWidget.hasOwnProperty(contactId)&&!lstChatId.hasOwnProperty(contactId)&&chatContactCount++;var chatResult={id:contactToShow,count:chatContactCount};return logger.debug("chatContactCount - count :"+chatContactCount+", idToShow :"+contactToShow+", status :"+contactStatus),chatResult},isVoicemailContact:function(){if(AgentConsoleDataStore.contacts.length>0){var isVoiceMail=!1,i=0;for(i=0;i<AgentConsoleDataStore.contacts.length;i++){var contact=AgentConsoleDataStore.contacts[i];if("VoiceMailContactEvent"===contact.contactType&&("Discarded"!==contact.status||!0!==contact.finalState)){isVoiceMail=!0;break}}return logger.info("isVoicemailContact : "+isVoiceMail),isVoiceMail}return!1},onContactUpdate:function(event,eventType){var that=this;if(AgentConsoleDataStore.contacts.length>0){var contact,i=0,nonParkedContacts=AgentConsoleDataStore.getNonParkedContacts(),contacts=Object.clone(AgentConsoleDataStore.contacts),canRoundTopCorners=!1,canRoundBottomCorners=!1,aInfo=AgentConsoleDataStore.agentInfo,chatResult=this.chatContactCount(),chatContactCount=chatResult.count;for(this.isChatContactPanel=0!==chatContactCount,this.isDialerAlive(this.isDialerPanel),aInfo.contacts=AgentConsoleDataStore.contacts,i=0,length=contacts.length;i<length;i++)canRoundTopCorners=getCanRoundTopCorners(contact=this.addContactMetaData(contacts[i]),i),canRoundBottomCorners=getCanRoundBottomCorners(contact,i),null!==contact&&void 0!==contact&&(!0===contact.finalState&&"Parked"!==contact.status||AgentConsoleDataStore.getTagsUpdateToContact(contact),"CallContactEvent"===contact.contactType?(this.onCallContact(contact,canRoundTopCorners,canRoundBottomCorners),this.updateContactResult(contact)):"WorkItemContactEvent"===contact.contactType?(this.resetAgentSkillListSize(),this.onWorkItemContact(contact,canRoundTopCorners,canRoundBottomCorners),this.updateContactResult(contact)):"ChatContactEvent"===contact.contactType?(this.onChatContact(contact,chatContactCount,canRoundTopCorners,canRoundBottomCorners,chatResult.id),!1!==contact.canUpdateResult&&this.updateContactResultNotesPanel(contact)):"EmailContactEvent"===contact.contactType?(this.onEmailContact(contact,canRoundTopCorners,canRoundBottomCorners),this.updateContactResultNotesPanel(contact)):"VoiceMailContactEvent"===contact.contactType&&(this.onVoiceMailContact(contact,eventType),this.updateContactResult(contact)));!1===this.showDialerNotification()?(this.element.callQueuePanel.hide(),this.element.skillRunningLow.hide()):(this.onSkillRunningLowUpdate(),this.onPCQueueCountUpdate()),this.elements.agentStatePanel.agentState("agentStateLoginCtrl"),this.toggleMulticallControls_Base(),this.elements.agentInfoControl.agentInformation("updateMetaData","Info",aInfo)}function getCanRoundTopCorners(contact,contactIndex){for(var j=0,rtLength=nonParkedContacts.length;j<rtLength;j++)if(nonParkedContacts[j].id==contact.id)return"Disconnected"===contact.status||(0==j||nonParkedContacts[j].contactType!=nonParkedContacts[j-1].contactType);return!0}function getCanRoundBottomCorners(contact,contactIndex){for(var j=0,rbLength=nonParkedContacts.length;j<rbLength;j++)if(nonParkedContacts[j].id==contact.id)return"WorkItemContactEvent"==nonParkedContacts[j].contactType||"EmailContactEvent"==nonParkedContacts[j].contactType||(1===nonParkedContacts.length&&"Consult"===contact.type||"Disconnected"===contact.status&&(0!=j&&"CallContactEvent"==contact.contactType||(!contact.useDisposition&&!contact.useAcw||contact.finalState)));return!0}IC_Validation.isNotNullOrEmpty(this.callContacts)&&1===this.callContacts.length&&this.toggleHpIconDialPad(),this.elements.agentIndicatorPanel.indicator("updateData","contact",AgentConsoleDataStore.contacts),this.isTabNeedToShow()?this.noQueueParkedEmailList.length>0&&0===AgentConsoleDataStore.getNonParkedContactsCount()&&this.showContactsRootPanel():(logger.trace("onContactUpdate : hideContactsRootPanel"),setTimeout(function(){that.isTabNeedToShow()||that.hideContactsRootPanel()},2e3),this.OnAgentIndicatorUpdate())},onWorkItemContact:function(contact,canRoundTopCorners,canRoundBottomCorners){var workItemWidget=null;return contact=this.addContactMetaData(contact),logger.debug("ContactID: "+contact.id," onWorkItemContact - status :"+contact.status),"Incoming"===contact.status?(IC_Validation.isValidObject(this.acceptRejectPanel)||(logger.debug("onWorkItemContact - creating accept reject panel"),this.onAcceptRejectPanelShow(contact),this.acceptRejectPanel=$('<div class="ContactRootPnl" />').workItemAcceptRejectPanel({controller:this,contact:contact,resourceBase:this.options.resourceBase}).appendTo(this.elements.workItemContactTab),this.acceptRejectPanelType="workItemAcceptRejectPanel"),void this.onWorkItemContactAcceptRejectPanelShow(contact)):IC_Validation.isValidObject(this.acceptRejectPanel)&&contact.id===this.acceptRejectPanel.workItemAcceptRejectPanel("getContactId")&&(logger.debug("onWorkItemContact - destroy accept reject panel"),this.acceptRejectPanel.workItemAcceptRejectPanel("destroy"),"Disconnected"===contact.status)?(this.destroyContactWidget(contact),void this.onWorkItemContactAcceptRejectPanelDestroy(contact)):(this.activeContactWidgets.hasOwnProperty(contact.id)?(logger.debug("onWorkItemContact - updating contact panel"),workItemWidget=this.activeContactWidgets[contact.id]):"Disconnected"===contact.status&&!0===contact.finalState||(this.onNewContactWidgetCreated(contact),logger.debug("onWorkItemContact - creating contact panel"),workItemWidget=$('<div class="ContactRootPnl" id="workItemWidgetId" />').sideBarWorkItemControl({container:this,contact:contact}).appendTo(this.elements.workItemContactTab),this.activeContactWidgets[contact.id]=workItemWidget,this.activeContactTypes[contact.id]=contact.contactType,this.contactType=contact.contactType),IC_Validation.isNotNull(workItemWidget)&&workItemWidget.sideBarWorkItemControl("updateData",contact),void("Disconnected"===contact.status&&this.destroyContactWidget(contact)))},onCallContact:function(contact,canRoundTopCorners,canRoundBottomCorners){var callWidget=null,isConsult=this.isNaturalCall(contact)&&"Consult"===contact.type&&("Incoming"===contact.status||"Ringing"===contact.status);if(contact=this.addContactMetaData(contact),this.elements.phoneContacts.mCustomScrollbar("destroy"),this.elements.phoneContacts.removeAttr("style"),logger.debug("ContactID: "+contact.id," onCallContact - status :"+contact.status),"Consult"===contact.type||this.isNaturalCall(contact)&&contact.hasOwnProperty("deliveryType")&&"ClickToCall"===contact.deliveryType){if(("Incoming"===contact.status||"Ringing"===contact.status)&&!1===this.isNaturalCall(contact)&&"Consult"===contact.type)return IC_Validation.isValidObject(this.acceptRejectPanel)||(this.onAcceptRejectPanelShow(contact),logger.debug("onCallContact - creating consult accept reject panel"),this.acceptRejectPanel=$('<div class="ContactRootPnl" />').consultAcceptRejectPanel({controller:this,contact:contact,agentLegState:this.agentInfo.lgState,resourceBase:this.options.resourceBase}).appendTo(this.elements.phoneContainer),this.acceptRejectPanelType="consultAcceptRejectPanel"),void this.renderCustomScroll(this.elements.phoneContacts);if(this.isNaturalCall(contact)&&"Preview"===contact.status||isConsult)return IC_Validation.isValidObject(this.acceptRejectPanel)||(this.onAcceptRejectPanelShow(contact),logger.debug("onCallContact - creating PC accept reject panel"),this.accpId=contact.id,this.acceptRejectPanel=$('<div class="ContactRootPnl" />').pcAcceptRejectControl({controller:this,contact:contact,agentLegState:this.agentInfo.lgState,resourceBase:this.options.resourceBase,isConsult:isConsult}).appendTo(this.elements.phoneContainer),this.acceptRejectPanelType="pcAcceptRejectControl",this.updateDispositionPanel(contact)),void this.renderCustomScroll(this.elements.phoneContacts);if(IC_Validation.isValidObject(this.acceptRejectPanel))if(logger.trace("ContactID: "+contact.id," onContactUpdate: Valid AcceptRejectPanel"),this.isNaturalCall(contact)&&contact.id===this.acceptRejectPanel.pcAcceptRejectControl("getContactId")){if(logger.debug("ContactID: "+contact.id," onContactUpdate: Destroy AcceptRejectPanel"),this.acceptRejectPanel.pcAcceptRejectControl("destroy"),AgentConsoleDataStore.pcPreviewNotesUpdate(),"Disconnected"===contact.status)return void this.destroyContactWidget(contact)}else if("consultAcceptRejectPanel"===this.acceptRejectPanelType&&contact.id===this.acceptRejectPanel.consultAcceptRejectPanel("getContactId")&&(logger.debug("ContactID: "+contact.id," onContactUpdate: Destroy AcceptRejectPanel"),this.acceptRejectPanel.consultAcceptRejectPanel("destroy"),"Disconnected"===contact.status))return void this.destroyContactWidget(contact)}this.activeContactWidgets.hasOwnProperty(contact.id)?(logger.debug("onContactUpdate- updating : callContactPanel "),(callWidget=this.activeContactWidgets[contact.id]).sideBarCallControl("updateView",canRoundTopCorners,canRoundBottomCorners)):"Disconnected"===contact.status&&!0===contact.finalState||(this.onNewContactWidgetCreated(contact),logger.debug("onContactUpdate- create : callContactPanel "),callWidget=$('<div class="ContactRootPnl" id = "callContactWidgetId" />').sideBarCallControl({container:this,contact:contact}).appendTo(this.elements.phoneContainer),this.activeContactWidgets[contact.id]=callWidget,this.activeContactTypes[contact.id]=contact.contactType,this.contactType=contact.contactType,callWidget.sideBarCallControl("updateView",canRoundTopCorners,canRoundBottomCorners)),IC_Validation.isNotNull(callWidget)&&(callWidget.sideBarCallControl("updateData",contact),callWidget.sideBarCallControl("updatePermissionsList",AgentConsoleDataStore.permissionsList),this.renderCustomScroll(this.elements.phoneContacts)),"Holding"!==contact.status&&this.showOrHideDialPadPC(contact,!1),"Disconnected"===contact.status&&(this.destroyContactWidget(contact),this.onCallContactDisconnect(contact))},renderCustomScroll:function(element){var _height=this.getContentPanelHeight();this.getDialerPanelAndIndicator();IC_Validation.isNotNull(element)&&(element.addClass("mscrollTheme1"),element.css({height:_height-104+"px"}),element.mCustomScrollbar("destroy"),element.mCustomScrollbar({scrollButtons:{enable:!0},scrollInertia:0,advanced:{autoScrollOnFocus:!1,updateOnContentResize:!0}}))},showOrHideDialPadPC:function(contact,isUpdateView){var that=this;if(this.isNaturalCall(contact)&&"Preview"!==contact.status){var contactLength=AgentConsoleDataStore.getNonParkedContactsCount(),len=!0===isUpdateView?contactLength:Object.keys(this.activeContactWidgets).length;"Preview"===contact.status&&{TenDigitDialAuto:!0,TenDigitDial:!0}.hasOwnProperty(contact.deliveryType)&&1===len?!1===this.isPCDialPad&&(this.isPCDialPad=!0,this.toggleHpIconDialPad(),this.elements.dialPadControl.dialPad("miniDialPadCss",!0,contact),this.elements.dialPadControl.stop(!0,!0),this.showDialpad()):!0===this.isPCDialPad&&(this.isPCDialPad=!1,this.toggleHpIconDialPad(),this.closeDialPad(function(){that.elements.dialPadControl.dialPad("miniDialPadCss",!1)}))}else!0===this.isVMDialPad&&(this.isVMDialPad=!1,this.toggleHpIconDialPad(),this.closeDialPad(function(){that.elements.dialPadControl.dialPad("miniDialPadCss",!1)}))},showDialPadVM:function(contact){this.isVMDialPad=!0,this.elements.dialPadControl.dialPad("dialPadVM",contact),this.elements.dialPadControl.stop(!0,!0),this.sccPhoneNumber=contact.from,this.showDialpad()},dialPCContact:function(phNumber,dnis,contactId){if(phNumber!==dnis){if("block"===this.elements.popupDiv.css("display"))return;return this.addMessage("eMsg",IC_EventErrorMessages.Custom_DialNoError),this.isPCConfirmErrorMsgDisplayed=!0,this.elements.popupDiv.showfn(),void this.elements.msgDiv.trigger("focus")}AgentConsoleDataStore.acceptContact(contactId)},onVoiceMailPlayBackUpdate:function(){var vmPlayBack=AgentConsoleDataStore.vmPlayBack;for(contactId in vmPlayBack)vmPlayBack.hasOwnProperty(contactId)&&this.activeContactWidgets.hasOwnProperty(contactId)&&this.activeContactWidgets[contactId].sideBarVoiceMailControl("updateVoiceMailPlayBackData",vmPlayBack[contactId])},onVoiceMailContact:function(contact,eventType){var voiceMailWidget=null;if(contact=this.addContactMetaData(contact),this.activeContactWidgets.hasOwnProperty(contact.id)?(logger.debug("onVoiceMailContact - updating voiceMailwidget"),voiceMailWidget=this.activeContactWidgets[contact.id]):"Discarded"===contact.status&&!0===contact.finalState&&"Disconnected"===contact.status||(this.onNewContactWidgetCreated(contact),logger.debug("onVoiceMailContact - creating voiceMailwidget"),voiceMailWidget=$('<div class="ContactRootPnl" id = "voiceMailContactWidgetId" />').sideBarVoiceMailControl({container:this,contact:contact}).appendTo(this.elements.voiceMailContactTab),this.activeContactWidgets[contact.id]=voiceMailWidget,this.activeContactTypes[contact.id]=contact.contactType,this.contactType=contact.contactType),IC_Validation.isNotNull(voiceMailWidget)){voiceMailWidget.sideBarVoiceMailControl("updateData",contact);var duration=voiceMailWidget.sideBarVoiceMailControl("getPlayPosition");"Discarded"!==contact.status&&"Disconnected"!==contact.status||(!0===AgentConsoleDataStore.isVoiceMailDurationSave()?AgentConsoleDataStore.saveLastVoiceMailDuration(duration):(duration=AgentConsoleDataStore.getLastVoiceMailDuration(),voiceMailWidget.sideBarVoiceMailControl("setPlayPosition",duration)))}"Discarded"!==contact.status&&"Disconnected"!==contact.status||this.destroyContactWidget(contact)},playVoiceMail:function(playTimeStamp,position,contactId){AgentConsoleDataStore.playVoiceMail(playTimeStamp,position,contactId)},pauseVoiceMail:function(contactId){AgentConsoleDataStore.pauseVoiceMail(contactId)},onEmailContact:function(contact,canRoundTopCorners,canRoundBottomCorners){IC_Validation.isNotNull(this.elements.emailListControlPanel)&&this.elements.emailListControlPanel.emailListControl("onEmailContactUpdate",contact)},forceDestroyContactWidget:function(contact){if(this.activeContactWidgets.hasOwnProperty(contact.id)){logger.debug("ContactID: "+contact.id," forceDestroyContactWidget - type :"+contact.contactType);var widget=this.activeContactWidgets[contact.id];this.closeSkillListAndShowHome(),this.closeAgentListAndShowHome(),widget.sideBarEmailControl("destroy")}},onChatContact:function(contact,chatContactCount,canRoundTopCorners,canRoundBottomCorners,idToShow){var that=this,chatWidget=null,isChatWidgetCreated=!1;if(contact=this.addContactMetaData(contact),logger.trace("ContactID: "+contact.id," onChatContact - status :"+contact.status),"Incoming"!==contact.status){if(IC_Validation.isValidObject(this.acceptRejectPanel)&&contact.id===this.acceptRejectPanel.chatAcceptRejectPanel("getContactId")&&(logger.debug("onChatContact - deleting accept reject panel"),this.acceptRejectPanel.chatAcceptRejectPanel("destroy"),"Disconnected"===contact.status&&!0===contact.finalState))return this.destroyContactWidget(contact),void(sessionStorage.lastOpenedAcceptRejectId="");if(this.activeContactWidgets.hasOwnProperty(contact.id)?(logger.debug("onChatContact - updating chatwidget"),(chatWidget=this.activeContactWidgets[contact.id]).sideBarChatControl("updateMetaData","chatViewData",{chatCount:chatContactCount,canRoundTopCorners:canRoundTopCorners,canRoundBottomCorners:canRoundBottomCorners,idToShow:idToShow})):"Disconnected"===contact.status&&!0===contact.finalState||(this.onNewContactWidgetCreated(contact),logger.debug("onChatContact - creating chatwidget"),chatWidget=$('<div class="ContactRootPnl" id = "chatID_'+contact.id+'" />').sideBarChatControl({chatContactCount:chatContactCount,idToShow:idToShow,container:this,contact:contact}).appendTo(this.elements.chatContactTab),this.activeContactWidgets[contact.id]=chatWidget,this.activeContactTypes[contact.id]=contact.contactType,this.contactType=contact.contactType,isChatWidgetCreated=!0),IC_Validation.isNotNull(chatWidget)){chatWidget.sideBarChatControl("updateData",contact),isChatWidgetCreated&&this.onChatMsgUpdate(),"Active"===contact.status&&AgentConsoleDataStore.getSkillDetails(contact.skillId,function(skillDetails){0!==Object.keys(skillDetails).length?chatWidget.sideBarChatControl("isTypingPreviewEnabled",skillDetails.agentTypingIndicator,skillDetails.patronTypingPreview):chatWidget.sideBarChatControl("isTypingPreviewEnabled",!1,!1)});this.showIndicator;var _height=this.elements.contentPanel.height(),mediaHeight=104;this.elements.chatContactTab.css({height:_height-mediaHeight+"px"}),chatContactCount>=2&&(mediaHeight=110,this.elements.chatContactTab.addClass("mscrollTheme1"),this.elements.chatContactTab.css({height:_height-mediaHeight+"px"}),this.elements.chatContactTab.mCustomScrollbar("destroy"),this.elements.chatContactTab.mCustomScrollbar({scrollButtons:{enable:!0},scrollInertia:0,advanced:{autoScrollOnFocus:!1,updateOnContentResize:!0}}))}"Disconnected"===contact.status&&(sessionStorage.lastOpenedAcceptRejectId="",this.destroyContactWidget(contact))}else!0===this.showChatAcceptReject()?(sessionStorage.lastOpenedAcceptRejectId!=contact.id||sessionStorage.lastOpenedAcceptRejectId==contact.id&&!IC_Validation.isValidObject(this.acceptRejectPanel))&&(sessionStorage.lastOpenedAcceptRejectId=contact.id,IC_Validation.isValidObject(this.acceptRejectPanel)||(logger.debug("onChatContact - creating accept reject panel"),this.onAcceptRejectPanelShow(contact),this.acceptRejectPanel=$('<div class="ContactRootPnl" />').chatAcceptRejectPanel({controller:this,contact:contact,resourceBase:this.options.resourceBase}).appendTo(this.elements.chatContactTab),$(window).on("unload.lastOpenedAcceptRejectId",function(){IC_Validation.isNotNull(that.acceptRejectPanel)&&(sessionStorage.lastOpenedAcceptRejectId=""),$(window).off("unload.lastOpenedAcceptRejectId")}),this.acceptRejectPanelType="chatAcceptRejectPanel")):AgentConsoleDataStore.acceptContact(contact.id)},showChatAcceptReject:function(){var contact,i=0,chatContactCount=0,contacts=AgentConsoleDataStore.contacts;for(i=0;i<contacts.length;i++)"ChatContactEvent"===(contact=contacts[i]).contactType&&!0!==contact.finalState&&chatContactCount++;return 1===chatContactCount?(logger.debug("showChatAcceptReject - show true"),!0):(logger.debug("showChatAcceptReject - show false"),!1)},addContactMetaData:function(contact){var skillObj=AgentConsoleDataStore.allSkillList[contact.skillId],agentId="";return IC_Validation.isNotNullOrEmpty(skillObj)&&(contact.skillName=skillObj.name,contact.useAcw=skillObj.useAcw,contact.useDisposition=skillObj.useDisposition,contact.reqDisposition=skillObj.reqDisposition,contact.useSecDispositions=skillObj.useSecDispositions,contact.emailFromAddress=skillObj.emailFromAddress,contact.emailFromEditable=skillObj.emailFromEditable,!0!==skillObj.useDisposition&&!0!==skillObj.reqDisposition||IC_Validation.isNotNullOrEmptyArray(skillObj.dispositions)||!IC_Validation.isNullOrEmpty(contact.allowDisp)&&!contact.allowDisp||AgentConsoleDataStore.getDispositions(skillObj)),"CallContactEvent"===contact.contactType&&("Consult"!==contact.type&&"PersonalQueue"!==contact.type||(agentId=!0===contact.inbound?contact.ani:contact.dnis,IC_Validation.isNotNullOrEmpty(AgentConsoleDataStore.agentListMap[agentId])&&(contact.consultAgentName=AgentConsoleDataStore.agentListMap[agentId].fn+" "+AgentConsoleDataStore.agentListMap[agentId].ln))),contact},onDispositionUpdate:function(event,skillId){logger.debug("Disposition Changed for skill id :",skillId);var contact,sfResult,contacts=AgentConsoleDataStore.contacts;if(IC_Validation.isNotNullOrEmptyArray(AgentConsoleDataStore.sfResult)){for(i=0;i<contacts.length;i++)if(contact=contacts[i],sfResult=AgentConsoleDataStore.getSfResult(contact.id),IC_Validation.isValidObject(sfResult)&&contact.skillId===skillId.toString()){this.updateDispositionPanel(contact);break}}else this.resizePCPanel()},updateDispositionPanel:function(contact,doNotUpdate){var skill=AgentConsoleDataStore.allSkillList[contact.skillId],that=this,validPCContact=$.grep(AgentConsoleDataStore.contacts,function(item){return"ClickToCall"===item.deliveryType||"TenDigitDialAuto"===item.deliveryType||"TenDigitDial"===item.deliveryType});IC_Validation.isValidObject(skill)&&"Consult"!==contact.type&&(validPCContact.length>0&&IC_Validation.isValidObject(this.acceptRejectPanel)&&this.acceptRejectPanel.pcAcceptRejectControl?AgentConsoleDataStore.getSkillDetails(contact.skillId,function(skillDetails){0!==Object.keys(skillDetails).length&&IC_Validation.isValidObject(that.acceptRejectPanel)&&that.acceptRejectPanel.pcAcceptRejectControl&&that.acceptRejectPanel.pcAcceptRejectControl("updatePanel",skillDetails),IC_Validation.isNotNullOrEmptyArray(skill.dispositions)&&IC_Validation.isNotNullOrUndefinedString(that.acceptRejectPanel)&&(that.acceptRejectPanel.pcAcceptRejectControl("updatePreviewNotes",AgentConsoleDataStore.pcPreviewNotes),that.acceptRejectPanel.pcAcceptRejectControl("updateDispositions",skill.dispositions,contact.type))}):validPCContact.length>0&&"Preview"===contact.status&&AgentConsoleDataStore.getSkillDetails(contact.skillId,function(skillDetails){IC_Validation.isNotNullOrEmptyArray(skill.dispositions)&&IC_Validation.isNotNullOrUndefinedString(that.activeContactWidgets[contact.id])&&that.activeContactWidgets[contact.id].sideBarCallControl("updatePreviewNotesAndDisposition",skill.dispositions,contact.type),0!==Object.keys(skillDetails).length&&IC_Validation.isValidObject(that.activeContactWidgets[contact.id])&&"Preview"===contact.status&&that.activeContactWidgets[contact.id].sideBarCallControl("updatePanel",skillDetails)})),validPCContact.length>0&&this.resizePCPanel()},destroyContactWidget:function(contact){var that=this;if(this.clearTimer(),IC_Validation.isValidObject(contact)){if(!0===contact.finalState){if(AgentConsoleDataStore.removeLastVoiceMailDuration(),this.activeContactWidgets.hasOwnProperty(contact.id)){logger.debug("ContactID: "+contact.id," destroyContactWidget - type :"+contact.contactType);var widget=this.activeContactWidgets[contact.id];"block"===this.elements.popupDiv.css("display")&&!0===this.isPCConfirmErrorMsgDisplayed&&(this.isPCConfirmErrorMsgDisplayed=!1,this.hidePopup()),"CallContactEvent"===contact.contactType?widget.sideBarCallControl("destroy"):"WorkItemContactEvent"===contact.contactType?(this.closeSkillListAndShowHome(),this.closeAgentListAndShowHome(),this.closeCallMsgPopup(),widget.sideBarWorkItemControl("destroy")):"ChatContactEvent"===contact.contactType?(this.closeSkillListAndShowHome(),this.closeAgentListAndShowHome(),this.closeAddressBookAndShowHome(),this.closeCallMsgPopup(),AgentConsoleDataStore.clearChatPatronId(contact.roomId),widget.sideBarChatControl("destroy"),this.elements.chatContactTab.css({height:"auto"}),this.elements.chatContactTab.mCustomScrollbar("destroy"),this.chatDisconnectedWidget[contact.id]=!0):"EmailContactEvent"===contact.contactType?(this.closeSkillListAndShowHome(),this.closeAgentListAndShowHome(),widget.sideBarEmailControl("destroy")):"VoiceMailContactEvent"===contact.contactType&&(this.closeSkillListAndShowHome(),this.closeAgentListAndShowHome(),widget.sideBarVoiceMailControl("destroy"))}this.submitTags(contact),"ChatContactEvent"!==contact.contactType||this.activeContactWidgets.hasOwnProperty(contact.id)||(this.closeSkillListAndShowHome(),this.closeAgentListAndShowHome(),this.closeAddressBookAndShowHome(),this.closeCallMsgPopup()),IC_Validation.isValidObject(this.acceptRejectPanel)&&(logger.debug("ContactID: "+contact.id," destroyContactWidget - accept reject panel"),this.accpId="",this.acceptRejectPanel=null,AgentConsoleDataStore.pcPreviewNotesUpdate()),AgentConsoleDataStore.removeContactFromStore(contact.id)}AgentConsoleDataStore.reloadSFResult();var sfResult=AgentConsoleDataStore.getSfResult(contact.id);if(!0===contact.finalState&&IC_Validation.isValidObject(sfResult)){var notesResult,data,jobType="",popTask="NaturalCalling"===contact.type?sfResult.canPopTask:sfResult.isScreenPopped;notesResult={whoId:sfResult.task.who,whatId:sfResult.task.what,disp:sfResult.task.disp,secDisp:sfResult.task.secDisp,notes:sfResult.task.notes,dispPayload:sfResult.task.dispPayload},data={contactId:contact.id,contact:contact,notesResult:notesResult,whatList:sfResult.whatLst,whoList:sfResult.whoLst,taskId:sfResult.task.id,popTask:popTask,searchResult:sfResult.results.result,entityMappingType:sfResult.entityMappingType},contact.isRefused||AgentConsoleDataStore.addCallWrapJobs(data)}!0===contact.finalState&&(IC_Validation.isValidObject(sfResult)&&(!1!==contact.taskCreation&&sfResult.create&&!contact.isRefused||contact.isRefused&&sfResult.createForRefused)?(jobType="PopTask",logger.debug("ContactID: "+contact.id," destroyContactWidget - adding job :"+jobType),IC_Validation.isNotNullOrEmpty(jobType)&&AgentConsoleDataStore.addPollingWindowJob({id:IC_Common.generateUniqueId("job"),type:jobType,data:data,sync:!0})):AgentConsoleDataStore.removeContactResult(contact.id)),!1===contact.finalState&&"EmailContactEvent"===contact.contactType&&("block"===this.elements.skillListControl.css("display")?this.hideSkillList(function(){that.showHomeOrContactsRootPanel(),that.resetAgentSkillListSize()}):"block"===this.elements.agentListControl.css("display")?this.hideAgentList(function(){that.showHomeOrContactsRootPanel(),that.resetAgentSkillListSize()}):(this.showHomeOrContactsRootPanel(),this.resetAgentSkillListSize()))}},submitTags:function(contact){if(0!=contact.finalState){if(IC_Validation.isNotNullOrEmpty(contact.tags)&&contact.tags.length>0){for(var tag={tags:[]},i=0;i<contact.tags.length;i++)tag.tags.push({tagId:contact.tags[i].tagId});AgentConsoleDataStore.updateTagsForContact(tag,contact.id)}AgentConsoleDataStore.removeSkillTags(contact.skillId)}},isDisconnectedChat:function(){for(var isDisconnectedChat=!1,contact=null,contacts=AgentConsoleDataStore.contacts,len=contacts.length,i=0;i<len;i++)if("ChatContactEvent"===(contact=contacts[i]).contactType&&!0===contact.active&&"Disconnected"===contact.status){isDisconnectedChat=!0;break}return logger.debug("isDisconnectedChat - "+isDisconnectedChat),isDisconnectedChat},hideEmailDisposition:function(contactId){var that=this;logger.debug("ContactID: "+contactId," hideEmailDisposition"),IC_Validation.isValidObject(this.elements.dispositionPanel)&&this.elements.dispositionPanel.toggle("slide",{direction:"down"},250,function(){var emailWidget=that.activeContactWidgets[contactId];IC_Validation.isValidObject(emailWidget)&&emailWidget.sideBarEmailControl("updateMetaData","dispositionPanel",!1),that.showContactsRootPanel()})},getFirstContactForContactResult:function(){var i=0,contacts=AgentConsoleDataStore.contacts;for(i=0;i<contacts.length;i++)if("Consult"!==contacts[i].type&&"ChatContactEvent"!==contacts[i].contactType&&"EmailContactEvent"!==contacts[i].contactType&&!1!==contacts[i].canUpdateResult)return contacts[i];return null},getcontactResultPanelHeight:function(){var panelHt=this.getContentPanelHeight(),mediaTab=this.elements.mediaTabsDiv.outerHeight(),tabPanelDivHt=this.elements.tabPanel.outerHeight(),diffHeight=this.isDialerPanel&&this.isChatContactPanel?-30:0;return panelHt-=(diffHeight+=this.getResultNotesdispHeight())+mediaTab+tabPanelDivHt+8},getResultNotesdispHeight:function(){var height=0;return IC_Validation.isValidObject(this.dispPanelDiv)&&"block"===this.dispPanelDiv.css("display")&&(height=0===this.dispPanelDiv.height()?27:this.dispPanelDiv.height()-3),height},getContactResults:function(contact,isScreenPop){logger.trace("ContactID: "+contact.id," getContactResults - screenpop :"+isScreenPop),this.updateDispositionPanel(contact,!1);var sfResult=AgentConsoleDataStore.getSfResult(contact.id);IC_Validation.isValidObject(sfResult)?this.onContactResultListUpdate():AgentConsoleDataStore.addPollingWindowJob({id:IC_Common.generateUniqueId("job"),type:"ContactSearch",data:{contact:contact,isScreenPop:isScreenPop},sync:!0,processTimeout:3e4})},onContactDestroy:function(contact,widgetReference){if(this.chatDisconnectedWidget.hasOwnProperty(contact.id)&&delete this.chatDisconnectedWidget[contact.id],this.updateContactViews(),this.toggleHpIconDialPad(),"consultAcceptRejectPanel"===widgetReference.widgetName||"workItemAcceptRejectPanel"===widgetReference.widgetName||"chatAcceptRejectPanel"===widgetReference.widgetName||"pcAcceptRejectControl"===widgetReference.widgetName)IC_Validation.isValidObject(this.acceptRejectPanel)&&(IC_Validation.isNullOrEmpty(this.accpId)?(logger.debug("onContactDestroy : accept reject panel destroyed"),this.acceptRejectPanel=null,this.acceptRejectPanelType=""):this.accpId===contact.id&&(this.accpId="",this.acceptRejectPanel=null,this.acceptRejectPanelType=""));else if(IC_Validation.isValidObject(contact)){if(logger.debug("onContactDestroy : remove active contact widget"),this.activeContactWidgets.hasOwnProperty(contact.id))this.activeContactWidgets[contact.id].remove();delete this.activeContactWidgets[contact.id],delete this.activeContactTypes[contact.id],this.contactType=null}this.isNaturalCall(contact)&&(this.containsDialerCall=!1);for(var i=0;i<this.contactIndicatorsAdded.length;i++)this.contactIndicatorsAdded[i]===contact.id&&!0===contact.finalState&&(this.indicatorHt>0&&(this.indicatorHt=this.indicatorHt-24),AgentConsoleDataStore.clearContactIndicator(contact.id),this.showContactIndicator=!1);0===this.contactIndicatorsAdded.length&&(this.indicatorHt=0,AgentConsoleDataStore.clearContactIndicator(contact.id),this.showContactIndicator=!1),IC_Validation.isNullOrEmpty(this.panelDisplayed)&&(this.isTabNeedToShow()||(logger.debug("onContactDestroy : hideContactsRootPanel"),this.toggleHpIconEmail(),this.hideContactsRootPanel()))},toggleHpIconPromiseKeeper:function(){this.enableHpDialIcon?(logger.debug("toggleHpIconPromiseKeeper : Enable"),IC_Common.enableButton(this.elements.HomePromiseKeeperIconDiv,this.elements.HomePromiseKeeperIconImg,this.resourceBase+"/css/images/home-pin.png"),IC_Common.enableButton(this.elements.tabPromiseKeeperIconDiv,this.elements.tabPromiseKeeperIconImg,this.resourceBase+"/css/images/pin.png"),this.elements.HomePromiseKeeperIconDiv.on("click",$.proxy(this.onClickHomePromiseKeeper,this))):(logger.debug("toggleHpIconPromiseKeeper : Disable"),IC_Common.disableButton(this.elements.HomePromiseKeeperIconDiv,this.elements.HomePromiseKeeperIconImg,this.resourceBase+"/css/images/home-pin-disabled.png"),IC_Common.disableButton(this.elements.tabPromiseKeeperIconDiv,this.elements.tabPromiseKeeperIconImg,this.resourceBase+"/css/images/pin-disabled.png"),this.elements.HomePromiseKeeperIconDiv.off("click"))},toggleHpIconDialPad:function(){!this.enableHpDialIcon||!0===this.isChatContactPanel&&!0===this.isChatContact()||!0===this.isPCDialPad||!0===this.isVMDialPad||!0===this.isEmailContact()||!0!==AgentConsoleDataStore.isSkillRunningLow&&!1!==this.isPCQueueContactActive?(logger.debug("toggleHpIconDialPad : Disable Dialpad"),IC_Common.disableButton(this.elements.HomeDialPadIconDiv,this.elements.HomeDialPadIconImg,this.resourceBase+"/css/images/hp-phone-disabled.png"),IC_Common.disableButton(this.elements.tabDialpadIconDiv,this.elements.tabDialpadIconImg,this.resourceBase+"/css/images/hp-sm-phone-disabled.png"),this.elements.multiCallControl.multiCallControl("setVisibilityAdd","disabled")):(logger.debug("toggleHpIconDialPad : Enable Dialpad"),IC_Common.enableButton(this.elements.HomeDialPadIconDiv,this.elements.HomeDialPadIconImg,this.resourceBase+"/css/images/hp-phone.png"),this.onMultiConferenceEnabled());var vmPlayBack=AgentConsoleDataStore.vmPlayBack;for(contactId in vmPlayBack)vmPlayBack.hasOwnProperty(contactId)&&this.activeContactWidgets.hasOwnProperty(contactId)&&this.activeContactWidgets[contactId].sideBarVoiceMailControl("enableDisableCallBack",this.enableHpDialIcon)},toggleHpIconEmail:function(){AgentConsoleDataStore.isEmailFeatureEnabled?(logger.debug("toggleHpIconEmail: Email Feature Is Enabled"),this.elements.HomeOBEmailIconDiv.showfn(),this.enableHpEmailIcon?(logger.debug("toggleHpIconEmail : Enable Email"),IC_Common.enableButton(this.elements.HomeOBEmailIconDiv,this.elements.HomeOBEmailIconImg,this.resourceBase+"/css/images/mail.png"),IC_Common.enableButton(this.elements.tabOBEmailIconDiv,this.elements.tabOBEmailIconImg,this.resourceBase+"/css/images/mail.png")):(logger.debug("toggleHpIconEmail : Disable Email"),IC_Common.disableButton(this.elements.HomeOBEmailIconDiv,this.elements.HomeOBEmailIconImg,this.resourceBase+"/css/images/mail-disable.png"),IC_Common.disableButton(this.elements.tabOBEmailIconDiv,this.elements.tabOBEmailIconImg,this.resourceBase+"/css/images/mail-disable.png"))):logger.debug("toggleHpIconEmail: Email Feature Is NOT Enabled")},onClickToDial:function(data){var number=data.number.replace(/[^0-9]/g,"");logger.debug("onClickToDial :"+JSON.stringify(data)),this.showAddCallPrompt(function(){var isDetail=AgentConsoleDataStore.getCurrentFocusedWindowId()===data.objectId;clickData={number:number,isDetail:isDetail,info:{id:data.objectId,name:data.objectName,objectType:data.object}},AgentConsoleDataStore.setCustomVar("ClickToDialDetail",clickData),AgentConsoleDataStore.dialPhone(number,AgentConsoleDataStore.allSkillList[data.skillId].name)})},onAgentListUpdate:function(){logger.trace("onAgentListUpdate - fired"),this.updateAllContactWidgets()},onAgentStateChange:function(){logger.trace("onAgentStateChange - fired"),this.elements.agentListControl.agentList("updateData",AgentConsoleDataStore.agentListMap,AgentConsoleDataStore.agentInfo.id),this.elements.skillListControl.skillList("updateData",AgentConsoleDataStore.agentListMap)},onTeamListUpdate:function(){logger.trace("onTeamListUpdate - fired"),this.elements.agentListControl.agentList("updateMetaData","teams",AgentConsoleDataStore.teamList),this.elements.skillListControl.skillList("updateMetaData","teams",AgentConsoleDataStore.teamList)},onPromiseKeeperUpdate:function(){logger.trace("onPromiseKeeperUpdate - fired"),this.elements.promiseKeeperControl.promiseKeeper("updatePromiseKeeper","promiseKeeperList",AgentConsoleDataStore.promiseKeeperList),this.elements.evolveScheduleControl.evolveSchedule("updateCommitments",AgentConsoleDataStore.promiseKeeperList)},onChatPatronTypingUpdate:function(){var contact,contacts=AgentConsoleDataStore.getNonParkedContacts(),chatPatron=AgentConsoleDataStore.chatPatronTyping,i=0,j=0;for(i=0;i<contacts.length;i++)if(contact=contacts[i],this.activeContactWidgets.hasOwnProperty(contact.id))for(j=0;j<chatPatron.length;j++)if(("True"===chatPatron[j].isTyping||"True"===chatPatron[j].isTextEntered)&&contact.roomId===chatPatron[j].roomId){this.activeContactWidgets[contact.id].sideBarChatControl("chatPatronTypingUpdate",chatPatron[j]);break}},onChatPreviewUpdate:function(){var contact,contacts=AgentConsoleDataStore.getNonParkedContacts(),chatPreview=AgentConsoleDataStore.chatPreview,i=0,j=0;for(i=0;i<contacts.length;i++)if(contact=contacts[i],this.activeContactWidgets.hasOwnProperty(contact.id))for(j=0;j<chatPreview.length;j++)if(contact.roomId===chatPreview[j].roomId){this.activeContactWidgets[contact.id].sideBarChatControl("chatPreviewUpdate",chatPreview[j]);break}},onChatAgentTyping:function(typing,contactId,callback){AgentConsoleDataStore.onChatAgentTyping(typing,contactId,callback)},onTimeZoneEvent:function(){this.elements.promiseKeeperDateTimeControl.promiseKeeperDateTime("setTimezones",AgentConsoleDataStore.timeZoneList),this.elements.rescheduleDateTimeControl.rescheduleDateTime("setTimezones",AgentConsoleDataStore.timeZoneList)},RescheduleCommitmentReminderEvent:function(event,data){this.hideTabs(),this.viewPromiseKeeperDetails(data,!1),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("rescheduleCommitmentReminder",data,AgentConsoleDataStore.agentSkillList)},RescheduleCommitmentReminderCompletedEvent:function(event,data){var that=this;localStorage.openedCommitmentReminderWindow="",this.hidePromiseKeeperDetails(function(){that.showHomeOrContactsRootPanel()})},ProceedCommitmentReminderEvent:function(event,data){function allowProceedCommitmentReminderApis(){localStorage.ProceedCommitmentReminderPending="0"}localStorage.openedCommitmentReminderWindow="","1"!==localStorage.ProceedCommitmentReminderPending&&AgentConsoleDataStore.proceedPromiseKeeper(data.callbackId,allowProceedCommitmentReminderApis,allowProceedCommitmentReminderApis)},reschedulePromieKeeper:function(callbackId,rescheduleDate,successCallback,failureCallback){logger.debug("reschedulePromieKeeper - fired"),AgentConsoleDataStore.reschedulePromieKeeper(callbackId,rescheduleDate,successCallback,failureCallback)},deleteCallback:function(callbackId,notes){var that=this;this.showConfirmationPrompt(IC_Localization.deleteCommitmentConfirmation,function(){AgentConsoleDataStore.deleteCallback(callbackId,notes,function(){that.hidePromiseKeeperDetails()})},function(){that.elements.promiseKeeperDetailsControl.promiseKeeperDetails("hideDeleteCommitmentPage")},175)},hideTabs:function(){logger.debug("hideTabs -  fired"),this.panelDisplayed="",this.hideAgentList(),this.hideSkillList(),this.hideAddressBook(),this.hideContactHistory(),this.hideAgentInfo(),this.hidefeedbackOptionPanel(),this.hidePromiseKeeper(),this.hidePromiseKeeperDateTime(),this.hideAgentReports(),this.hideAgentReportsPerformance(),this.hideEvolveSchedule(),this.hideMessagePanel()},onBradingProfilesUpdate:function(){logger.trace("onBradingProfilesUpdate - fired");var sfdcLogoSrc,brandingLogoSrc;this.elements.sfdcLogo.removeClass("sfdcLogo"),this.elements.cobrandImg.removeClass("brandingImg"),IC_Validation.isNotNull(AgentConsoleDataStore.brandingProfile)&&(IC_Validation.isNotNull(AgentConsoleDataStore.brandingProfile.sfdcAgentLogo)?(AgentConsoleDataStore.isEvolve()?this.elements.sfdcLogo.attr("src",AgentConsoleDataStore.brandingProfile.sfdcAgentLogo):(sfdcLogoSrc="data:image;base64,"+AgentConsoleDataStore.brandingProfile.sfdcAgentLogo,this.elements.sfdcLogo.attr("src",sfdcLogoSrc)),this.elements.sfdcLogo.addClass("sfdcLogo").showfn()):this.elements.sfdcLogo.hide(),AgentConsoleDataStore.brandingProfile.coBrand?(brandingLogoSrc=this.resourceBase+"/css/images/power-nice-incontact.svg",this.elements.cobrandImg.attr("src",brandingLogoSrc).showfn(),this.elements.cobrandImg.addClass("brandingImg")):this.elements.cobrandImg.hide()),this.elements.contentPanel.css("height",this.getContentPanelHeight()+"px"),this.resizeAllWidget(),IC_Validation.isNotNull(this.commitmentPendingLayer)&&"block"===this.commitmentPendingLayer.css("display")&&this.commitmentPendingLayer.css("bottom",this.getFooterAndBrandingHeight()),this.renderCustomScroll(this.elements.phoneContacts),this.resizeContactWidget()},resizeContactWidget:function(){logger.trace("resizeContactWidget ...");var activeContactWidget,i=0,len=AgentConsoleDataStore.contacts.length,contact=null;for(i=0;i<len;i++)contact=AgentConsoleDataStore.contacts[i],activeContactWidget=this.activeContactWidgets.hasOwnProperty(contact.id)?this.activeContactWidgets[contact.id]:null,IC_Validation.isValidObject(contact)&&IC_Validation.isValidObject(activeContactWidget)&&("CallContactEvent"===contact.contactType?activeContactWidget.sideBarCallControl("resizeContactWidget"):"WorkItemContactEvent"===contact.contactType?activeContactWidget.sideBarWorkItemControl("resizeContactWidget"):"ChatContactEvent"===contact.contactType?activeContactWidget.sideBarChatControl("resizeContactWidget"):"VoiceMailContactEvent"===contact.contactType?activeContactWidget.sideBarVoiceMailControl("resizeContactWidget"):"EmailContactEvent"===contact.contactType&&IC_Validation.isNotNull(this.elements.emailListControlPanel)&&(this.elements.emailListControlPanel.emailListControl("resizeScrollBar"),activeContactWidget.sideBarEmailControl("resizeContactWidget"))),"Preview"!==contact.status||!IC_Validation.isValidObject(this.acceptRejectPanel)||"ClickToCall"!==contact.deliveryType&&"TenDigitDialAuto"!==contact.deliveryType||this.updateDispositionPanel(contact)},onAutoLoginDisabled:function(){logger.info("_init - icCredentials exist, autoLogin disabled"),this.agentInfo.cState.state="Logged out",this.elements.agentStatePanel.agentState("updateData",this.agentInfo),AgentConsoleDataStore.isEvolve()?this.onOptionsPanelOpen(!1):(this.elements.loginMsgDiv.hide(),this.elements.loginPopupDiv.showfn(),this.isAutoLoginErr=!0,this.elements.footerPanel.footer("toggleFooterCount",!1),AgentConsoleDataStore.updateAgentLogoutState(!0))},onMailProgressUpdate:function(){var mailSending=AgentConsoleDataStore.isMailSending;logger.trace("onMailProgressUpdate - fired"," MailSending:"+mailSending);var emailContact=this.getEmailContact();IC_Validation.isNotNull(emailContact)&&this.activeContactWidgets[emailContact.id].sideBarEmailControl("enableDisableDiscardButton",!mailSending)},onSkillListUpdate:function(){var i=0,contacts=AgentConsoleDataStore.contacts;if(logger.trace("onSkillListUpdate - fired"),IC_Validation.isNotNullOrEmptyArray(AgentConsoleDataStore.sfResult))for(i=0;i<contacts.length;i++){var sfResult=AgentConsoleDataStore.getSfResult(contacts[i].id);if(IC_Validation.isValidObject(sfResult)){logger.debug("ContactID: "+contacts[i].id," onSkillListUpdate - adding contact meta data"),this.addContactMetaData(contacts[i]);break}}this.elements.agentListControl.agentList("updateMetaData","skills",AgentConsoleDataStore.allSkillList),this.elements.skillListControl.skillList("updateMetaData","skills",AgentConsoleDataStore.allSkillList),this.elements.contactHistoryControl.contactHistory("updateMetaData",AgentConsoleDataStore.allSkillList),this.elements.agentStatePanel.agentState("updateMetaData","skills",AgentConsoleDataStore.allSkillList),this.updateAllContactWidgets()},onCustomVariablesUpdate:function(){var value,customVar=AgentConsoleDataStore.customVariables;for(key in customVar)customVar.hasOwnProperty(key)&&(value=customVar[key],"ChatTextChanged"===key&&this.activeContactWidgets.hasOwnProperty(value.id)&&(logger.debug("ContactID: "+value.id," onCustomVariablesUpdate - updating chat message"),this.activeContactWidgets[value.id].sideBarChatControl("updateMetaData","userInput",value.msg)))},onAgentSkillAssignmentsUpdate:function(){logger.trace("onAgentSkillAssignmentsUpdate - fired"),this.elements.agentListControl.agentList("updateMetaData","agentSkill",AgentConsoleDataStore.agentSkillMap),this.elements.skillListControl.skillList("updateMetaData","agentSkill",AgentConsoleDataStore.agentSkillMap)},onSkillQueueUpdate:function(){this.updateSkillListQueue&&this.elements.skillListControl.skillList("updateQueueData",AgentConsoleDataStore.skillQueueMap),this.updateQueueCount()},onSkillClosedHours:function(showReskillPrompt){if(this.isSkillSelectedHere){var that=this;logger.trace("onSkillClosedHours - fired"),IC_Validation.isNullOrEmpty(AgentConsoleDataStore.skillClosed)||!0!==AgentConsoleDataStore.skillClosed.showPrompt?this.closeCallMsgPopup():(logger.debug("onSkillClosedHours - show prompt"),this.showConfirmationPrompt(IC_Localization.alertMessageHOP,function(){AgentConsoleDataStore.continueReskill(!0),this.isSkillSelectedHere=!1},function(){AgentConsoleDataStore.continueReskill(!1),that.switchTab("skills")}))}},closeOBSkillsMenu:function(){"block"===this.elements.obPhoneSkillsMenu.css("display")?(logger.debug("closeOBSkillsMenu - hide menu"),this.elements.obPhoneSkillsMenu.hide()):"block"===this.elements.obEmailSkillsMenu.css("display")&&(logger.debug("closeOBSkillsMenu - hide menu"),this.elements.obEmailSkillsMenu.hide())},onAgentSkillListUpdate:function(){var skill,menuItem,agentSkills=AgentConsoleDataStore.agentSkillList,skillMenu=this.elements.obPhoneSkillsMenu,emailSkillMenu=this.elements.obEmailSkillsMenu,obPhoneSkills=[],obEmailSkills=[],i=0,length=agentSkills.length,that=this;for(this.elements.agentInfoControl.agentInformation("updateMetaData","Skill",agentSkills),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("updateMetaData","Skill",agentSkills),this.elements.agentStatePanel.agentState("updateMetaData","agentSkill",agentSkills),this.elements.promiseKeeperControl.promiseKeeper("updateMetaData",agentSkills),skillMenu.empty(),emailSkillMenu.empty(),agentSkills=agentSkills.sort(this.sortOBSkillName),i=0;i<length;i++)4===(skill=agentSkills[i]).typeId&&!0===skill.isOutbound&&"Manual"===skill.strategy&&(logger.debug("onAgentSkillListUpdate - Ob skill name : "+skill.name),obPhoneSkills.push(skill),(menuItem=$('<div class="menuItem"/>').appendTo(skillMenu)).hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),IC_Common.setTextWithEllipsis(menuItem,skill.name,145),menuItem.on("click",function(){var skillName=$(this).text();IC_Validation.isNotNullOrEmpty(that.numberToDial)&&that.showAddCallPrompt(function(){AgentConsoleDataStore.dialPhone(that.numberToDial,skillName),delete that.numberToDial},function(){delete that.numberToDial}),that.elements.obPhoneSkillsMenu.hide()})),1===skill.typeId&&!0===skill.isOutbound&&(logger.debug("onAgentSkillListUpdate - Ob skill name : "+skill.name),obEmailSkills.push(skill),(menuItem=$('<div class="menuItem"  id="'+skill.id+'"/>').appendTo(emailSkillMenu)).attr({cus_skillID:skill.id}),menuItem.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),IC_Common.setTextWithEllipsis(menuItem,skill.name,145),menuItem.on("click",function(){var skillId=this.attributes.cus_skillID.value;AgentConsoleDataStore.createEmailOB(skillId,that.toAddress),that.elements.obEmailSkillsMenu.hide()}));this.enableHpDialIcon=obPhoneSkills.length>0,this.toggleHpIconDialPad(),this.toggleHpIconPromiseKeeper(),this.elements.evolveScheduleControl.evolveSchedule("toggleNewButton",this.enableHpDialIcon),this.enableHpEmailIcon=obEmailSkills.length>0,this.toggleHpIconEmail(),this.sccToggleClickToDial(),this.obPhoneSkillsList=obPhoneSkills,logger.debug("onAgentSkillListUpdate - Ob Phone skill length :"+obPhoneSkills.length+"OB Email skill length :"+obEmailSkills.length),obPhoneSkills.length>7?skillMenu.addClass("ic_obSkillListMenuScroll"):skillMenu.removeClass("ic_obSkillListMenuScroll"),obEmailSkills.length>7?emailSkillMenu.addClass("ic_obSkillListMenuScroll"):emailSkillMenu.removeClass("ic_obSkillListMenuScroll"),this.onSkillListUpdate()},sortOBSkillName:function(a,b){var aVal=a.name.toLowerCase(),bVal=b.name.toLowerCase();return aVal===bVal?0:aVal>bVal?1:-1},sccToggleClickToDial:function(){IC_Validation.isNotNullOrEmpty(this.enableHpDialIcon)&&!0===this.enableHpDialIcon?(logger.debug("sccToggleClickToDial : Enable click to dial"),AgentConsoleDataStore.enableClickToDial($.proxy(this.onClickToDialScc,this))):(logger.debug("sccToggleClickToDial : Disable click to dial"),AgentConsoleDataStore.disableClickToDial())},onClickToDialScc:function(data){this.sccPhoneNumber="";var objectId="Lightning"===AgentConsoleDataStore.sfMode?"recordId":"objectId",objectName="Lightning"===AgentConsoleDataStore.sfMode?"recordName":"objectName",object="Lightning"===AgentConsoleDataStore.sfMode?"objectType":"object";logger.debug("onClickToDialScc : "+JSON.stringify(data));var that=this,isDetail=AgentConsoleDataStore.getCurrentFocusedWindowId()===data[objectId],clickData={number:data.number,isDetail:isDetail,info:{id:data[objectId],name:data[objectName],objectType:data[object]}};AgentConsoleDataStore.setCustomVar("ClickToDialDetail",clickData),1===this.obPhoneSkillsList.length?this.showAddCallPrompt(function(){AgentConsoleDataStore.dialPhone(data.number,that.obPhoneSkillsList[0].name)}):"block"===this.elements.dialPadControl.css("display")?this.elements.dialPadControl.dialPad("setDialPhoneNo",data.number):(this.sccPhoneNumber=data.number,AgentConsoleDataStore.getNonParkedContactsCount()>0?this.onClickTabDialPad():(this.hideTabControl(),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("dialPad")})))},onContactResultListUpdate:function(){var contact,sfResult,contacts=AgentConsoleDataStore.contacts;if(IC_Validation.isNotNullOrEmptyArray(AgentConsoleDataStore.sfResult)){this.chatContactCount();for(var i=0;i<contacts.length;i++)if(contact=contacts[i],sfResult=AgentConsoleDataStore.getSfResult(contact.id),IC_Validation.isValidObject(sfResult))if(AgentConsoleDataStore.allSkillList[contact.skillId],"ChatContactEvent"===contact.contactType){var chatWidget=this.activeContactWidgets[contact.id];IC_Validation.isValidObject(chatWidget)&&("Interrupted"===contact.status?chatWidget.sideBarChatControl("hideContactResult"):"Disconnected"!==contact.status&&!1===contact.finalState?(chatWidget.sideBarChatControl("showContactResult"),chatWidget.sideBarChatControl("updateIndicatorInResultsPnl",contact),chatWidget.sideBarChatControl("updateResultAndNotes",contact)):"Disconnected"===contact.status&&!1===contact.finalState&&(chatWidget.sideBarChatControl("hideContactResult"),chatWidget.sideBarChatControl("updateResultAndNotes",contact)))}else{if("EmailContactEvent"!==contact.contactType){this.updateContactResultPanel(contact,sfResult);break}var emailWidget=this.activeContactWidgets[contact.id];IC_Validation.isValidObject(emailWidget)&&("Parked"===contact.status||"Interrupted"===contact.status?emailWidget.sideBarEmailControl("hideContactResult"):"Discarded"!==contact.status&&!1===contact.finalState?(emailWidget.sideBarEmailControl("showContactResult"),emailWidget.sideBarEmailControl("updateIndicatorInResultsPnl",contact),emailWidget.sideBarEmailControl("updateResultAndNotes",contact)):"Discarded"===contact.status&&!1===contact.finalState&&emailWidget.sideBarEmailControl("updateResultAndNotes",contact))}}else logger.trace("onContactResultListUpdate - No result exist")},updateContactResultPanel:function(contact,sfResult){var isScreenPop=!0;!this.isNaturalCall(contact)||"NaturalCallAMD"!==contact.status&&"Active"!==contact.status?"NaturalCalling"===contact.type&&"NaturalCallAMD"!==contact.status&&!1===sfResult.canPopTask&&AgentConsoleDataStore.addPollingWindowJob({id:IC_Common.generateUniqueId("job"),type:"CanPopTask",contactId:contact.id,sync:!0}):isScreenPop=!1,this.isNaturalCall(contact)&&IC_Validation.isNotNullOrEmpty(contact.screenPopUrl)&&"Preview"!==contact.status&&(isScreenPop=this.canScreenpopForNaturalCall(contact),logger.debug("ContactID: "+contact.id," updateContactResultPanel : sfResult.isScreenPopped:"+sfResult.isScreenPopped+" isScreenPop:"+isScreenPop)),!1===sfResult.isScreenPopped&&!0===isScreenPop&&AgentConsoleDataStore.addPollingWindowJob({id:IC_Common.generateUniqueId("job"),type:"ScreenPop",contactId:contact.id,sync:!0}),!IC_Validation.isValidObject(this.acceptRejectPanel)||"Preview"!==contact.status||"ClickToCall"!==contact.deliveryType&&"TenDigitDialAuto"!==contact.deliveryType||this.updateDispositionPanel(contact);var firstContact=this.getFirstContactForContactResult();if("CallContactEvent"===firstContact.contactType){if(IC_Validation.isValidObject(AgentConsoleDataStore.contacts))var _length=AgentConsoleDataStore.contacts.length>0?AgentConsoleDataStore.contacts.length-1:0,_cId=AgentConsoleDataStore.contacts[_length].id;for(contactId in this.activeContactWidgets)if(IC_Validation.isNotNullOrUndefinedString(contactId)&&this.activeContactWidgets.hasOwnProperty(contactId)){var contactWidgets=this.activeContactWidgets[contactId];"CallContactEvent"===this.activeContactTypes[contactId]&&"Preview"!==contact.status?(contactWidgets.sideBarCallControl("updateResultAndNotes",contact),contactWidgets.sideBarCallControl("hideContactResult"),_cId==contactId&&contactWidgets.sideBarCallControl("showContactResult")):"VoiceMailContactEvent"===this.activeContactTypes[contactId]&&(contactWidgets.sideBarVoiceMailControl("updateResultAndNotes",contact),contactWidgets.sideBarVoiceMailControl("showContactResult"))}}else if("VoiceMailContactEvent"===firstContact.contactType){for(contactId in this.activeContactWidgets)if(IC_Validation.isNotNullOrUndefinedString(contactId)&&this.activeContactWidgets.hasOwnProperty(contactId)){contactWidgets=this.activeContactWidgets[contactId];"CallContactEvent"===this.activeContactTypes[contactId]?(contactWidgets.sideBarCallControl("updateResultAndNotes",contact),contactWidgets.sideBarCallControl("showContactResult")):"VoiceMailContactEvent"===this.activeContactTypes[contactId]&&(contactWidgets.sideBarVoiceMailControl("updateResultAndNotes",contact),contactWidgets.sideBarVoiceMailControl("showContactResult"))}}else if("WorkItemContactEvent"===firstContact.contactType)for(contactId in this.activeContactWidgets)if(IC_Validation.isNotNullOrUndefinedString(contactId)&&this.activeContactWidgets.hasOwnProperty(contactId)){contactWidgets=this.activeContactWidgets[contactId];"CallContactEvent"===this.activeContactTypes[contactId]?(contactWidgets.sideBarCallControl("updateResultAndNotes",contact),contactWidgets.sideBarCallControl("showContactResult")):"WorkItemContactEvent"===this.activeContactTypes[contactId]&&(contactWidgets.sideBarWorkItemControl("updateResultAndNotes",contact),contactWidgets.sideBarWorkItemControl("showContactResult"))}},onAddressBooksUpdate:function(){"block"===this.elements.addressBookControl.css("display")&&(logger.trace("onAddressBooksUpdate"),this.elements.addressBookControl.addressBook("updateMetaData",AgentConsoleDataStore.addressBookList))},readAgentMsg:function(msgID){logger.debug("readAgentMsg - message id :"+msgID),AgentConsoleDataStore.updateAgentMsgReadStatus(msgID)},scrollAgentMsg:function(msgID){logger.debug("scrollAgentMsg - message id :"+msgID),AgentConsoleDataStore.updateAgentMsgScrollStatus(msgID)},onAgentMessageUpdate:function(){if(!IC_Validation.isNullOrEmpty(AgentConsoleDataStore.agentMessage)&&!IC_Validation.isNullOrEmpty(AgentConsoleDataStore.agentMessage.message)){var message=AgentConsoleDataStore.agentMessage.message,agentMsgTab=!1,render=!1;for(i=0;i<message.length;i++)if(!1===message[i].scrollMsg&&AgentConsoleDataStore.agentMessage.scrollMsgCount>0){render=!0;break}logger.debug("onAgentMessageUpdate - message length : "+message.length),message.length>0?"block"!==this.elements.agentMessageControl.css("display")?(!0===render&&(logger.debug("onAgentMessageUpdate -show message scroll"),this.elements.headerLogo.fadeOut(),this.elements.agentMsgScroll.addClass("showMsgPanel").removeClass("hideMsgPanel")),"none"===this.elements.agentMsgScroll.css("display")&&(logger.debug("onAgentMessageUpdate -fadein message scroll"),this.elements.agentMsgScroll.fadeIn())):(this.elements.agentMsgScroll.addClass("hideMsgPanel").removeClass("showMsgPanel"),this.elements.agentMsgScroll.fadeIn(),this.elements.headerLogo.fadeIn(),agentMsgTab=!0):(this.elements.agentMsgScroll.fadeOut(),this.elements.headerLogo.fadeIn()),this.elements.agentMsgScroll.agentMessageScroll("updateMetaData",message,agentMsgTab),this.elements.agentMessageControl.agentMessage("updateMetaData",message)}},onFeedbackCategoryUpdate:function(){this.elements.agentFeedbackControl.agentFeedback("updateMetaData",AgentConsoleDataStore.category,AgentConsoleDataStore.priority)},OnAgentIndicatorUpdate:function(){IC_Validation.isNotNullOrEmpty(AgentConsoleDataStore.indicators)&&IC_Validation.isNotNullOrEmpty(AgentConsoleDataStore.indicators.agentIndicator)&&this.elements.agentIndicatorPanel.indicator("updateData","indicator",AgentConsoleDataStore.indicators.agentIndicator);for(var contact,contacts=AgentConsoleDataStore.contacts,i=0;i<contacts.length;i++)if(contact=contacts[i],IC_Validation.isValidObject(contact)&&IC_Validation.isNotNullOrEmpty(AgentConsoleDataStore.indicators)&&IC_Validation.isNotNullOrEmpty(AgentConsoleDataStore.indicators.contactIndicator))if("CallContactEvent"===contact.contactType){if(this.activeContactWidgets.hasOwnProperty(contact.id)){var callWidget=this.activeContactWidgets[contact.id];logger.debug("ContactID: "+contact.id," OnAgentIndicatorUpdate - updating call contact panel"),callWidget.sideBarCallControl("updateContactIndicator",AgentConsoleDataStore.indicators.contactIndicator),callWidget.sideBarCallControl("updateIndicatorInResultsPnl",contact)}}else if("WorkItemContactEvent"===contact.contactType){if(this.activeContactWidgets.hasOwnProperty(contact.id)){callWidget=this.activeContactWidgets[contact.id];logger.debug("ContactID: "+contact.id," OnAgentIndicatorUpdate - updating workitem contact panel"),callWidget.sideBarWorkItemControl("updateContactIndicator",AgentConsoleDataStore.indicators.contactIndicator),callWidget.sideBarWorkItemControl("updateIndicatorInResultsPnl",contact)}}else if("ChatContactEvent"===contact.contactType){if(this.activeContactWidgets.hasOwnProperty(contact.id)){var chatWidget=this.activeContactWidgets[contact.id];logger.debug("ContactID: "+contact.id," OnAgentIndicatorUpdate - updating chat contact panel"),chatWidget.sideBarChatControl("updateContactIndicator",AgentConsoleDataStore.indicators.contactIndicator),chatWidget.sideBarChatControl("updateIndicatorInResultsPnl",contact),this.renderCustomScroll(this.elements.chatContactTab)}}else if("EmailContactEvent"===contact.contactType&&this.activeContactWidgets.hasOwnProperty(contact.id)){var emailWidget=this.activeContactWidgets[contact.id];logger.debug("ContactID: "+contact.id," OnAgentIndicatorUpdate - updating email contact panel"),emailWidget.sideBarEmailControl("updateContactIndicator",AgentConsoleDataStore.indicators.contactIndicator),emailWidget.sideBarEmailControl("updateIndicatorInResultsPnl",contact),this.elements.emailListControlPanel.emailListControl("resizeScrollBar")}},agentIndicatorAction:function(indicator){if(logger.debug("agentIndicatorAction - Indicator type:"+indicator.type+", action :"+indicator.action),"OpenURL"===indicator.type&&AgentConsoleDataStore.checkAndPopUrl(indicator.action,"indicator"),"SpawnScript"===indicator.type){for(var args=[],contact=indicator.action.split('"'),i=3;i<contact.length;i+=2)args.push(contact[i]);var params=args.join("|");AgentConsoleDataStore.scriptList(contact[1],function(scriptId){AgentConsoleDataStore.spawnScript(scriptId,parseInt(contact[2],10),params,"")})}if("SignalScript"===indicator.type){args=null;var intermediateArgs={},processedArgs={};i=0,args=indicator.action.split('"');for(intermediateArgs=[],i=0;i<args.length;i++)""!==args[i]&&" "!==args[i]&&intermediateArgs.push(args[i]);for(i=1;i<intermediateArgs.length;i++)processedArgs[i]=intermediateArgs[i];AgentConsoleDataStore.signalScript(intermediateArgs[0],processedArgs)}},ContactHistoryFilterUpdate:function(){var sortByItem=AgentConsoleDataStore.cHistory.sortByItem;filterItem=AgentConsoleDataStore.cHistory.filterItem,searchText=AgentConsoleDataStore.cHistory.searchText,logger.debug("ContactHistoryFilterUpdate - sortByItem:"+sortByItem+", filterItem :"+filterItem+", searchText :"+searchText),this.elements.contactHistoryControl.contactHistory("updateMetaFilterData",sortByItem,filterItem,searchText)},contactIndicatorResizeResult:function(showIndicator,contactId){var contactIndicator=AgentConsoleDataStore.indicators.contactIndicator,nonParkedContacts=AgentConsoleDataStore.getNonParkedContacts(),nonParkedContactsLength=nonParkedContacts.length;if(logger.debug("ContactID: "+contactId," contactIndicatorResizeResult - showIndicator :"+showIndicator),this.showContactIndicator=showIndicator,!this.showContactIndicator&&this.indicatorHt>0&&(0==nonParkedContactsLength||"Disconnected"===nonParkedContacts[0].status||"Discarded"===nonParkedContacts[0].status)&&(this.indicatorHt=this.indicatorHt-24),this.showContactIndicator)for(var i=0;i<contactIndicator.length;i++){if(!IC_Validation.isNotNullOrEmpty(contactIndicator[i].contactID)){this.indicatorHt=this.indicatorHt+24;break}if(contactIndicator[i].contactID===contactId){this.indicatorHt=this.indicatorHt+24,this.contactIndicatorsAdded.push(contactId);break}}},resizeContentPanel:function(showIndicator){var height;logger.debug("resizeContentPanel -  showIndicator :"+showIndicator),this.showIndicator=showIndicator,height=this.getContentPanelHeight(),this.elements.contentPanel.css("height",height+"px"),showIndicator?this.elements.agentIndicatorPanel.showfn():this.elements.agentIndicatorPanel.hide(),this.resizeAllWidget(),this.isIndicatorVisible(),this.pcPreviewNotesUpdate(),this.renderCustomScroll(this.elements.phoneContacts)},resizeAllWidget:function(){var isDialerPanel=this.isDialerPanel,tabPanelDivHt=this.elements.tabPanel.outerHeight(),height=this.getContentPanelHeight()-(31+tabPanelDivHt);if(logger.debug("resizeAllWidget -  isDialerPanel :"+isDialerPanel),!0===this.isChatContactPanel&&!0===isDialerPanel)isDialerPanel=!1;IC_Validation.isNotNullOrUndefinedString(this.elements.addressBookControl.addressBook)&&this.elements.addressBookControl.addressBook("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.addressBookControl.dialPad)&&this.elements.dialPadControl.dialPad("updatePanelHeight",isDialerPanel,this.showIndicator),IC_Validation.isNotNullOrUndefinedString(this.elements.addressBookControl.agentList)&&this.elements.agentListControl.agentList("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.addressBookControl.skillList)&&this.elements.skillListControl.skillList("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.addressBookControl.contactHistory)&&this.elements.contactHistoryControl.contactHistory("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.addressBookControl.agentInformation)&&this.elements.agentInfoControl.agentInformation("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.agentFeedbackControl.agentFeedback)&&this.elements.agentFeedbackControl.agentFeedback("updatePanelHeight",isDialerPanel,this.showIndicator),IC_Validation.isNotNullOrUndefinedString(this.elements.agentMessageControl.agentMessage)&&this.elements.agentMessageControl.agentMessage("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.promiseKeeperControl.promiseKeeper)&&this.elements.promiseKeeperControl.promiseKeeper("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.promiseKeeperDetailsControl.promiseKeeperDetails)&&this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("updatePanelHeight",isDialerPanel,this.showIndicator,height),IC_Validation.isNotNullOrUndefinedString(this.elements.promiseKeeperDateTimeControl.promiseKeeperDateTime)&&this.elements.promiseKeeperDateTimeControl.promiseKeeperDateTime("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.rescheduleDateTimeControl.rescheduleDateTime)&&this.elements.rescheduleDateTimeControl.rescheduleDateTime("updatePanelHeight",height),IC_Validation.isNotNullOrUndefinedString(this.elements.agentReportsControl.agentReports)&&this.elements.agentReportsControl.agentReports("updatePanelHeight",isDialerPanel,this.showIndicator),IC_Validation.isNotNullOrUndefinedString(this.elements.agentReportsPerformanceControl.agentReportsPerformance)&&this.elements.agentReportsPerformanceControl.agentReportsPerformance("updatePanelHeight",isDialerPanel,this.showIndicator),IC_Validation.isNotNullOrUndefinedString(this.elements.evolveScheduleControl.evolveSchedule)&&this.elements.evolveScheduleControl.evolveSchedule("updatePanelHeight",height)},getContactsByType:function(type){logger.debug("getContactsByType -  type :"+type);var callContacts=[],contact=null,contacts=AgentConsoleDataStore.contacts,len=contacts.length;for(i=0;i<len;i++)(contact=contacts[i]).contactType===type&&"Disconnected"!==contact.status&&callContacts.push(contact);return logger.debug("getContactsByType -  length :"+callContacts.length),callContacts},getContactStateCount:function(type){var typeLen,contactCnt={},contact=null,contacts=AgentConsoleDataStore.contacts,len=contacts.length,typeArray=null,i=0,j=0;for(contactCnt.contacts=[],contactCnt.states={},contactCnt.totalCnt=0,typeLen=(typeArray=IC_Validation.isNotNullOrEmptyArray(type)?type:[type]).length,i=0;i<len;i++)for(contact=contacts[i],j=0;j<typeLen;j++)contact.contactType!==typeArray[j]||"Disconnected"===contact.status&&!1!==contact.finalState&&"Discarded"===contact.status||("object"!=typeof contactCnt.states[contact.status]&&(contactCnt.states[contact.status]={contacts:[],count:0}),contactCnt.contacts.push(contact),contactCnt.states[contact.status].contacts.push(contact),contactCnt.states[contact.status].count++,contactCnt.totalCnt++);return contactCnt},getCallContactCountByState:function(state){var callCnt=0,contacts=AgentConsoleDataStore.contacts,len=contacts.length;for(i=0;i<len;i++)"CallContactEvent"===contacts[i].contactType&&contacts[i].status===state&&callCnt++;return callCnt},showConfirmationPrompt:function(message,yesCallback,noCallback,topPadding){var that=this;logger.debug("showConfirmationPrompt :"+message),IC_Validation.isNotNullOrEmpty(topPadding)&&this.elements.callMsgDiv.css("margin-top",topPadding+"px"),IC_Validation.isNotNullOrEmpty(message)&&(this.elements.callMsgYesBtn.off("click"),this.elements.callMsgYesBtn.on("click",function(){that.closeCallMsgPopup(),yesCallback()}),IC_Common.enterKeyPress(this.elements.callMsgYesBtn,function(){that.closeCallMsgPopup(),yesCallback()}),"function"==typeof noCallback&&(this.elements.callMsgNoBtn.off("click"),this.elements.callMsgNoBtn.on("click",function(){that.closeCallMsgPopup(),noCallback()}),IC_Common.enterKeyPress(this.elements.callMsgNoBtn,function(){that.closeCallMsgPopup(),noCallback()})),this.addCallMessage("iMsg",message),this.elements.popupDiv.showfn(),this.elements.callMsgDiv.trigger("focus"))},showAddCallPrompt:function(callback,noCallback){logger.debug("showConfirmationPrompt ");var callStateCnt=this.getContactStateCount("CallContactEvent"),workStateCnt=this.getContactStateCount("WorkItemContactEvent"),voiceMailCnt=this.getContactStateCount("VoiceMailContactEvent"),callStates=callStateCnt.states,workItemStates=workStateCnt.states,voiceMailStates=voiceMailCnt.states,prompt="",action="",holdContactId=null,that=this,noDialState={Ringing:!0,Dialing:!0,NaturalCallDialing:!0,NaturalCallRinging:!0,Incoming:!0};for(state in callStates)if(callStates.hasOwnProperty(state)&&noDialState.hasOwnProperty(state))return logger.info("Ignore showAddCallPrompt"),!0;for(state in workItemStates)if(workItemStates.hasOwnProperty(state)&&noDialState.hasOwnProperty(state))return logger.info("Ignore showAddCallPrompt"),!0;for(state in voiceMailStates)if(voiceMailStates.hasOwnProperty(state)&&noDialState.hasOwnProperty(state))return logger.info("Ignore showAddCallPrompt"),!0;if(1===callStateCnt.totalCnt||2===callStateCnt.totalCnt&&IC_Validation.isValidObject(callStates.Disconnected)&&1==callStateCnt.states.Disconnected.count?IC_Validation.isValidObject(callStates.Holding)&&1===callStates.Holding.count||(IC_Validation.isValidObject(callStates.Active)?(prompt=IC_Localization.activeCallShouldBePutOnHold,holdContactId=callStateCnt.states.Active.contacts[0].id,action="hold"):(prompt=IC_Localization.currentContactErrorAttempt,action="acwContact")):2===callStateCnt.totalCnt?IC_Validation.isValidObject(callStates.Joined)&&2===callStates.Joined.count||(prompt=IC_Localization.confTheExistingCalls,action="conference"):1===workStateCnt.totalCnt&&(IC_Validation.isValidObject(workItemStates.Holding)&&1===workItemStates.Holding.count||(prompt=IC_Localization.holdCurrentWorkItemContact,holdContactId=workStateCnt.contacts[0].id,action="hold")),1===voiceMailCnt.totalCnt&&(IC_Validation.isValidObject(voiceMailStates.Holding)&&1===voiceMailStates.Holding.count||(prompt=IC_Localization.activeCallShouldBePutOnHold,holdContactId=voiceMailCnt.contacts[0].id,action="hold")),"acwContact"===action){var messages=[];messages.push({message:prompt,levelCss:"iMsg"}),this.showPopup(0,messages,1e4)}else""!==prompt?(this.elements.callMsgYesBtn.off("click"),this.elements.callMsgYesBtn.on("click",$.proxy(that.onClickCallMsgYesBtn,that,action,holdContactId,callback)),IC_Common.enterKeyPress(this.elements.callMsgYesBtn,function(){that.onClickCallMsgYesBtn(action,holdContactId,callback)}),this.elements.callMsgNoBtn.off("click"),"function"==typeof noCallback?(this.elements.callMsgNoBtn.on("click",function(){that.closeCallMsgPopup(),noCallback()}),IC_Common.enterKeyPress(this.elements.callMsgNoBtn,function(){that.closeCallMsgPopup(),noCallback()})):(this.elements.callMsgNoBtn.on("click",function(){that.closeCallMsgPopup()}),IC_Common.enterKeyPress(this.elements.callMsgNoBtn,function(){that.closeCallMsgPopup()})),this.addCallMessage("iMsg",prompt),this.elements.popupDiv.showfn(),this.elements.callMsgDiv.trigger("focus")):callback()},enableDisableClickEvent:function(type,domObj){"disable"===type?domObj.off("mouseenter mouseleave click"):"enable"===type&&domObj.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton)},toggleDialPadDiv:function(btnState){var iconEnabled=this.options.resourceBase+"/css/images/hp-sm-phone.png",iconDisabled=this.options.resourceBase+"/css/images/hp-sm-phone-disabled.png";logger.trace("toggleDialPadDiv - button state :"+btnState),this.elements.multiCallControl.multiCallControl("changeButtonState",this.elements.tabDialpadIconDiv,this.elements.tabDialpadIconImg,btnState,iconEnabled,iconDisabled)},onDocumentClick:function(e){var canHookDocumentClick=!1,len=AgentConsoleDataStore.contacts.length,contact=null,className=e.target.className;for(!1===this.obPhoneSkillsMenuFlag&&"block"===this.elements.obPhoneSkillsMenu.css("display")&&"mCSB_draggerRail"!==className&&"mCSB_draggerContainer"!==className&&"mCSB_buttonUp"!==className&&"mCSB_dragger_bar"!==className&&"mCSB_buttonDown"!==className&&this.elements.obPhoneSkillsMenu.hide(),!1===this.obEmailSkillsMenuFlag&&"block"===this.elements.obEmailSkillsMenu.css("display")&&"mCSB_draggerRail"!==className&&"mCSB_draggerContainer"!==className&&"mCSB_buttonUp"!==className&&"mCSB_dragger_bar"!==className&&"mCSB_buttonDown"!==className&&this.elements.obEmailSkillsMenu.hide(),!0===this.obPhoneSkillsMenuFlag&&(this.obPhoneSkillsMenuFlag=!1),!0===this.obEmailSkillsMenuFlag&&(this.obEmailSkillsMenuFlag=!1),i=0;i<len;i++)"CallContactEvent"===AgentConsoleDataStore.contacts[i].contactType&&(contact=AgentConsoleDataStore.contacts[i],this.activeContactWidgets.hasOwnProperty(contact.id)&&(canHookDocumentClick=!0,callWidget=this.activeContactWidgets[contact.id],canHookDocumentClick&&callWidget.sideBarCallControl("showContactStatePnl")))},updateContactViews:function(){var contactWidget,i=0,nonParkedContacts=AgentConsoleDataStore.getNonParkedContacts(),contact="",canRoundTopCorners=!1,canRoundBottomCorners=!1,len=AgentConsoleDataStore.getNonParkedContactsCount(),chatResult=this.chatContactCount(),chatContactCount=chatResult.count;for(this.contactLength=len,this.isChatContactPanel=0!==chatContactCount,logger.trace("updateContactViews"),i=0;i<len;i++)contact=nonParkedContacts[i],canRoundTopCorners=0===i||nonParkedContacts[i].contactType!=nonParkedContacts[i-1].contactType,canRoundBottomCorners=i===len-1,this.activeContactWidgets.hasOwnProperty(contact.id)&&(contactWidget=this.activeContactWidgets[contact.id],"CallContactEvent"===contact.contactType?(logger.trace("ContactID: "+contact.id," updateContactViews - updating call widget"),this.showOrHideDialPadPC(contact,!0)):"ChatContactEvent"===contact.contactType&&(logger.trace("ContactID: "+contact.id," updateContactViews - updating chat widget"),contactWidget.sideBarChatControl("updateView",{canRoundTopCorners:canRoundTopCorners,canRoundBottomCorners:canRoundBottomCorners,chatCount:chatContactCount,idToShow:chatResult.id,showIndicator:this.showIndicator})));!1===this.isChatContactPanel&&this.isDialerAlive(this.isDialerPanel),this.toggleMulticallControls_Base()},updateQueueCount:function(){var i,len,skillQueue=null,skill="",phoneCount=0,workItemCount=0,chatCount=0,emailCount=0,personalQueueCount=0,personalQChat=0,personalQEmail=0;for(i=0;i<AgentConsoleDataStore.agentSkillList.length;i++)skill=AgentConsoleDataStore.agentSkillList[i],skillQueue=AgentConsoleDataStore.skillQueueMap[skill.id],IC_Validation.isValidObject(skillQueue)&&(4===skill.typeId?phoneCount+=IC_Common.toNumber(skillQueue.QueueCount):6===skill.typeId?workItemCount+=IC_Common.toNumber(skillQueue.QueueCount):3===skill.typeId?chatCount+=IC_Common.toNumber(skillQueue.QueueCount):1===skill.typeId&&(emailCount+=IC_Common.toNumber(skillQueue.QueueCount))),skillQueue=null;if(skillQueue=AgentConsoleDataStore.skillQueueMap[0],IC_Validation.isValidObject(skillQueue))for(len=skillQueue.length,i=0;i<len;i++){"1"===(skill=skillQueue[i]).MediaType&&(personalQEmail+=IC_Common.toNumber(skill.QueueCount)),personalQueueCount+=IC_Common.toNumber(skill.QueueCount),"3"===skill.MediaType&&(personalQChat+=IC_Common.toNumber(skill.QueueCount))}this.personalQueueCountForLogout=personalQueueCount,this.emailQueueCount=emailCount+personalQEmail,this.emailQueueCount>0&&this.addEmail(),logger.debug("updateQueueCount -phone :"+phoneCount+", workitem :"+workItemCount+", chat :"+chatCount+", personal :"+personalQueueCount+", email :"+emailCount),this.elements.footerPanel.footer("updateData","phone",phoneCount),this.elements.footerPanel.footer("updateData","workItem",workItemCount),this.elements.footerPanel.footer("updateData","chat",chatCount),this.elements.footerPanel.footer("updateData","personalQueue",personalQueueCount),this.elements.footerPanel.footer("updateData","email",emailCount),0===AgentConsoleDataStore.lastNewSkillQueueUpdateTime&&(chatCount>0||personalQChat>0)&&!IC_Validation.isValidObject(this.acceptRejectPanel)?AgentConsoleDataStore.lastNewSkillQueueUpdateTime=(new Date).getTime():0===chatCount&&0===personalQChat&&(AgentConsoleDataStore.lastNewSkillQueueUpdateTime=0),"Chat"===this.getCurrentSelectedMediaTab()&&(chatCount>0&&this.chatContacts.length<AgentConsoleDataStore.agentInfo.maxChatsAllowed&&!IC_Validation.isValidObject(this.acceptRejectPanel)||!IC_Validation.isValidObject(this.acceptRejectPanel)&&personalQChat>0)?(this.elements.multiCallControl.multiCallControl("setVisibilityAddChat","enabled"),this.setVisibilityAddChatOnEmailInterrupted()):this.elements.multiCallControl.multiCallControl("setVisibilityAddChat","disabled")},setVisibilityAddChatOnEmailInterrupted:function(){var contact=this.getEmailContact();IC_Validation.isValidObject(contact)&&"EmailContactEvent"===contact.contactType&&"Interrupted"===contact.status&&this.elements.multiCallControl.multiCallControl("setVisibilityAddChat","disabled")},showHomeOrContactsRootPanel:function(){this.panelDisplayed="",this.isTabNeedToShow()?(logger.trace("showHomeOrContactsRootPanel - showContactsRootPanel"),this.showContactsRootPanel()):(logger.trace("showHomeOrContactsRootPanel - hideContactsRootPanel"),this.hideContactsRootPanel())},hideHomeOrContactsRootPanel:function(){this.elements.contactsRootPanel.stop(!0,!0),"block"===this.elements.contactsRootPanel.css("display")&&(this.elements.contactsRootPanel.toggle("slide",{direction:"down"},250),this.onkeyPadClose()),this.elements.homePagePanel.stop(!0,!0),"block"===this.elements.homePagePanel.css("display")&&this.elements.homePagePanel.toggle("slide",{direction:"down"},250)},showContactsRootPanel:function(){logger.trace("Showing Contacts Root Panel"),this.elements.homePagePanel.stop(!0,!0),"block"===this.elements.homePagePanel.css("display")&&this.elements.homePagePanel.slideUp(250),this.elements.contactsRootPanel.stop(!0,!0),"none"===this.elements.contactsRootPanel.css("display")&&this.elements.contactsRootPanel.toggle("slide",{direction:"down"},250),this.showTabControl()},hideContactsRootPanel:function(){logger.trace("Hiding Contacts Root Panel"),this.elements.contactsRootPanel.stop(!0,!0),"block"===this.elements.keyPadControl.css("display")&&this.onkeyPadClose(),"block"===this.elements.contactsRootPanel.css("display")&&this.elements.contactsRootPanel.slideUp(250),this.elements.homePagePanel.stop(!0,!0),"none"===this.elements.homePagePanel.css("display")&&(this.elements.homePagePanel.slideDown(250),this.elements.HomeAgentsIconDiv.removeClass("btnDivHover"),this.elements.HomeSkillsIconDiv.removeClass("btnDivHover"),this.elements.HomeDialPadIconDiv.removeClass("btnDivHover"),this.elements.HomeAddressBooksIconDiv.removeClass("btnDivHover"),this.elements.HomeContactHistoryIconDiv.removeClass("btnDivHover"),this.elements.HomeAgentInfoIconDiv.removeClass("btnDivHover"),this.elements.HomePromiseKeeperIconDiv.removeClass("btnDivHover"),this.elements.HomeHelpIconDiv.removeClass("btnDivHover"),this.elements.HomeAgentReportsIconDiv.removeClass("btnDivHover")),this.showHomeTabPanel()},addChat:function(){logger.debug("addChat - fired"),AgentConsoleDataStore.addChat()},chatSendTxt:function(contactId,msg){logger.debug("ContactID: "+contactId," chatSendTxt - msg :"+msg),AgentConsoleDataStore.chatSendTxt(contactId,msg)},enableActiveChat:function(contactId){logger.debug("ContactID: "+contactId," enableActiveChat"),AgentConsoleDataStore.enableActiveChat(contactId)},triggerContactEvent:function(){AgentConsoleDataStore.triggerContactEvent()},chatTextChanged:function(contactId,msg){var message={id:contactId,msg:msg};AgentConsoleDataStore.setCustomVar("ChatTextChanged",message)},loadChatTranscript:function(contactId){logger.debug("ContactID: "+contactId," loadChatTranscript");var that=this;AgentConsoleDataStore.getChatConversation(contactId,function(messages){that.activeContactWidgets.hasOwnProperty(contactId)&&that.activeContactWidgets[contactId].sideBarChatControl("updateMetaData","loadChatText",messages)})},setAgentState:function(state){logger.debug("setAgentState request, state:"+state.state+" reason:"+state.reason),AgentConsoleDataStore.setAgentState(state.state,state.reason)},setDialerLogin:function(skillName){logger.debug("setDialerLogin - skillName :"+skillName),AgentConsoleDataStore.loginDialer(skillName)},setDialerLogout:function(){logger.debug("setDialerLogout - fired"),AgentConsoleDataStore.logoutDialer()},setFeedbackForm:function(category,priority,comment,customData){logger.debug("setFeedbackForm - fired"),AgentConsoleDataStore.submitFeedbackForm(category,priority,comment,customData)},isDialerAlive:function(isDialerPanel){var height;this.isDialerPanel=isDialerPanel,logger.trace("isDialerAlive :"+isDialerPanel),height=this.getContentPanelHeight(),this.elements.contentPanel.css("height",height+"px"),this.elements.agentStatePanel.agentState("hideDialerPanel",this.isChatContactPanel),this.resizeAllWidget(),this.resizePCPanel(),this.isChatContactPanel||(this.hasNonChatOrNaturalCallContacts()?this.elements.agentStatePanel.agentState("disableDialerPanel"):this.elements.agentStatePanel.agentState("enableDialerPanel"))},resizePCPanel:function(){var validPCContact=$.grep(AgentConsoleDataStore.contacts,function(item){return("ClickToCall"===item.deliveryType||"TenDigitDialAuto"===item.deliveryType||"TenDigitDial"===item.deliveryType)&&"Preview"===item.status}),skill="";validPCContact.length>0&&(skill=AgentConsoleDataStore.allSkillList[validPCContact[0].skillId],IC_Validation.isValidObject(this.acceptRejectPanel)&&this.acceptRejectPanel.pcAcceptRejectControl?(this.acceptRejectPanel.pcAcceptRejectControl("resizePanel",this.isDialerPanel),IC_Validation.isNotNullOrEmptyArray(skill.dispositions)&&IC_Validation.isNotNullOrUndefinedString(this.acceptRejectPanel)&&(this.acceptRejectPanel.pcAcceptRejectControl("updatePreviewNotes",AgentConsoleDataStore.pcPreviewNotes),this.acceptRejectPanel.pcAcceptRejectControl("updateDispositions",skill.dispositions,validPCContact[0].type))):IC_Validation.isValidObject(this.activeContactWidgets[validPCContact[0].id])&&"Preview"===validPCContact[0].status&&(this.activeContactWidgets[validPCContact[0].id].sideBarCallControl("resizePanel",this.isDialerPanel),IC_Validation.isNotNullOrEmptyArray(skill)&&IC_Validation.isNotNullOrEmptyArray(skill.dispositions)&&IC_Validation.isNotNullOrUndefinedString(this.activeContactWidgets[validPCContact[0].id])&&this.activeContactWidgets[validPCContact[0].id].sideBarCallControl("updatePreviewNotesAndDisposition",skill.dispositions,validPCContact[0].type)))},hasNonChatOrNaturalCallContacts:function(){for(var contacts=AgentConsoleDataStore.contacts,currentContact=null,i=0,length=contacts.length;i<length;i++)if("ChatContactEvent"!=(currentContact=contacts[i]).contactType&&"NaturalCalling"!=currentContact.type&&("EmailContactEvent"!=currentContact.contactType||"Parked"!=currentContact.status&&"Discarded"!=currentContact.status))return!0;return!1},getContentPanelHeight:function(){var height=510,metricPanelHt=this.elements.metricsPanel.outerHeight();return height=this.showIndicator?height-24:height,height=!0===this.isDialerPanel&&!0!==this.isChatContactPanel?height-29:height,height=0===metricPanelHt?height:height-metricPanelHt,height-=this.elements.footerPanel.outerHeight(),logger.trace("getContentPanelHeight - height:"+height),height},getFooterAndBrandingHeight:function(){var metricPanelHt=0,footerHt=this.elements.footerPanel.outerHeight();return(IC_Validation.isNotNull(this.elements.sfdcLogo.attr("src"))||IC_Validation.isNotNull(this.elements.cobrandImg.attr("src")))&&(metricPanelHt=this.elements.metricsPanel.outerHeight()),metricPanelHt+footerHt+"px"},dialerAMDOverrideContact:function(contactId,type){logger.trace("ContactID: "+contactId," dialerAMDOverrideContact - type :"+type),AgentConsoleDataStore.dialerAMDOverrideContact(contactId,type)},disposeBadNumberCall:function(contactId,type){logger.trace("ContactID: "+contactId," disposeBadNumberCall - type :"+type),AgentConsoleDataStore.disposeBadNumberCall(contactId,type)},getCurrentSelectedTab:function(){return IC_Common.isButtonSelected(this.elements.tabDialpadIconDiv)?"dialPad":IC_Common.isButtonSelected(this.elements.tabAgentsIconDiv)?"agents":IC_Common.isButtonSelected(this.elements.tabSkillsIconDiv)?"skills":IC_Common.isButtonSelected(this.elements.tabAddressBookIconDiv)?"addressBook":IC_Common.isButtonSelected(this.elements.tabHistoryIconDiv)?"history":IC_Common.isButtonSelected(this.elements.tabAgentInfoIconDiv)?"information":!0===this.showfeedback?"feedback":"block"===this.elements.agentMessageControl.css("display")?"agentMessage":"block"===this.elements.promiseKeeperDateTimeControl.css("display")?"promiseKeeperDateTime":"block"===this.elements.promiseKeeperDetailsControl.css("display")?"promiseKeeperDetails":"block"===this.elements.promiseKeeperControl.css("display")?"promiseKeeper":"block"===this.elements.agentReportsPerformanceControl.css("display")?"agentReportsPerformance":"block"===this.elements.agentReportsControl.css("display")?"agentReports":"block"===this.elements.evolveScheduleControl.css("display")?"evolveSchedule":void 0},switchTab:function(tab){var currentSelectedTab=this.getCurrentSelectedTab();logger.debug("switchTab - current tab :"+currentSelectedTab+", tab :"+tab),currentSelectedTab!==tab&&(this.hideHomeOrContactsRootPanel(),"promiseKeeperDetails"!=tab&&"promiseKeeperDateTime"!=tab&&"agentReportsPerformance"!=tab&&this.hideTab(currentSelectedTab),this.showTab(tab))},showTab:function(tab){logger.debug("showTab -  tab :"+tab),this.panelDisplayed=tab,"dialPad"===tab?this.showDialpad():"agents"===tab?(this.isWorkItemTransferClicked&&(this.elements.agentListControl.css("top",this.topPadding+"px"),this.elements.agentListControl.agentList("updateCSSOnWorkItemTransfer",this.getRemainingContentSpace(),this.topPadding)),this.showAgentList()):"skills"===tab?(this.isWorkItemTransferClicked&&(this.elements.skillListControl.css("top",this.topPadding+"px"),this.elements.skillListControl.skillList("updateCSSOnWorkItemTransfer",this.getRemainingContentSpace(),this.topPadding)),this.isChatContactTransferClicked&&this.elements.skillListControl.skillList("updateChatContactTransfer"),this.isEmailContactTransferClicked&&this.elements.skillListControl.skillList("updateEmailContactTransfer"),this.isVoiceMailTransferClicked&&this.elements.skillListControl.skillList("updateVoiceMailContactTransfer"),this.showSkillList()):"addressBook"===tab?this.showAddressBook():"history"===tab?this.showContactHistory():"information"===tab?this.showAgentInfo():"feedback"===tab?this.showfeedbackOptionPanel():"agentMessage"===tab?this.showAgentMsgPnl():"promiseKeeper"===tab?this.showPromiseKeeper():"promiseKeeperDetails"===tab?this.showPromiseKeeperDetails():"promiseKeeperDateTime"===tab?this.showPromiseKeeperDateTime():"agentReports"===tab?this.showAgentReports():"agentReportsPerformance"===tab?this.showAgentReportsPerformance():"evolveSchedule"===tab&&this.showEvolveSchedule()},hideTab:function(tab){logger.debug("hideTab -  tab :"+tab),this.panelDisplayed="","dialPad"===tab?(IC_Common.unselectButton(this.elements.tabDialpadIconDiv),"block"===this.elements.dialPadControl.css("display")&&(this.sccPhoneNumber="",this.elements.dialPadControl.toggle("slide",{direction:"down"},250))):"agents"===tab?this.hideAgentList():"skills"===tab?this.hideSkillList():"addressBook"===tab?this.hideAddressBook():"history"===tab?this.hideContactHistory():"information"===tab?this.hideAgentInfo():"feedback"===tab?this.hidefeedbackOptionPanel():"agentMessage"===tab?this.hideMessagePanel():"promiseKeeper"===tab?this.hidePromiseKeeper():"promiseKeeperDetails"===tab?(this.hidePromiseKeeperDetails(),this.hidePromiseKeeper(),this.hideEvolveSchedule()):"promiseKeeperDateTime"===tab?(this.hidePromiseKeeperDateTime(),this.hidePromiseKeeperDetails(),this.hidePromiseKeeper(),this.hideEvolveSchedule()):"agentReports"===tab?this.hideAgentReports():"agentReportsPerformance"===tab?(this.hideAgentReportsPerformance(),this.hideAgentReports()):"evolveSchedule"===tab&&this.hideEvolveSchedule()},hideAllTabs:function(){logger.debug("hideAllTabs -  fired"),this.panelDisplayed="",this.elements.dialPadControl.stop(!0,!0),"block"===this.elements.dialPadControl.css("display")&&(IC_Common.unselectButton(this.elements.tabDialpadIconDiv),this.elements.dialPadControl.slideUp(250)),this.hideAgentList(),this.hideSkillList(),this.hideAddressBook(),this.hideContactHistory(),this.hideAgentInfo(),this.hidefeedbackOptionPanel(),this.hidePromiseKeeper(),this.hidePromiseKeeperDetails(),this.hidePromiseKeeperDateTime(),this.hideAgentReports(),this.hideAgentReportsPerformance(),this.hideEvolveSchedule(),this.hideMessagePanel(),this.elements.tooltipDiv.css("display","none")},showDialpad:function(){var that=this;IC_Common.selectButton(this.elements.tabDialpadIconDiv),this.elements.dialPadControl.stop(!0,!0),"none"===this.elements.dialPadControl.css("display")&&this.elements.dialPadControl.toggle("slide",{direction:"down"},250,function(){that.elements.dialPadControl.dialPad("setDialPhoneNo",that.sccPhoneNumber),that.sccPhoneNumber="",that.elements.dialPadControl.dialPad("setFocusToDialPadHeader")})},closeMessagePnl:function(){var that=this;this.hideMessagePanel(function(){that.showHomeOrContactsRootPanel()})},hideMessagePanel:function(callback){IC_Common.unselectButton(this.elements.tabMessageIconDiv),"block"===this.elements.agentMessageControl.css("display")&&this.elements.agentMessageControl.toggle("slide",{direction:"down"},250,callback),this.elements.tabMessageIconDiv.on("click",$.proxy(this.onClickTabMessage,this))},onAgentMsgScrollClick:function(){IC_Common.selectButton(this.elements.tabMessageIconDiv);var that=this;"none"===this.elements.tabPanel.css("display")?(logger.trace("onAgentMsgScrollClick show agent message"),this.showTabControl(function(){that.switchTab("agentMessage")})):"block"===this.elements.agentMessageControl.css("display")?(logger.trace("onAgentMsgScrollClick hide agent message"),this.closeMessagePnl()):(logger.trace("onAgentMsgScrollClick toggle agent message"),this.switchTab("agentMessage"))},showAgentMsgPnl:function(){IC_Common.selectButton(this.elements.tabMessageIconDiv);this.elements.headerLogo.fadeIn(),this.elements.agentMsgScroll.agentMessageScroll("closeScrollMsg"),this.elements.agentMsgScroll.addClass("hideMsgPanel").removeClass("showMsgPanel"),logger.trace("showAgentMsgPnl - display "+this.elements.agentMessageControl.css("display")),"none"===this.elements.agentMessageControl.css("display")&&(this.elements.agentMessageControl.toggle("slide",{direction:"down"},250),this.elements.agentMessageControl.agentMessage("setFocusToAgentMsgHeader"))},headerPanelFlash:function(opacity){this.elements.headerPanel.animate({opacity:opacity},1e3)},closeDialPad:function(callback){if(logger.trace("closeDialPad - display "+this.elements.dialPadControl.css("display")),"block"===this.elements.dialPadControl.css("display")){var that=this;this.elements.dialPadControl.toggle("slide",{direction:"down"},250,function(){that.showHomeOrContactsRootPanel(),that.elements.dialPadControl.dialPad("setDialPhoneNo",""),"function"==typeof callback&&callback()}),IC_Common.unselectButton(this.elements.tabDialpadIconDiv)}},showAgentList:function(callback){if(IC_Common.selectButton(this.elements.tabAgentsIconDiv),logger.trace("showAgentList - display "+this.elements.agentListControl.css("display")),"none"===this.elements.agentListControl.css("display")){AgentConsoleDataStore.pollAgentsCache=!0,AgentConsoleDataStore.failureCount=0;var that=this;this.elements.agentListControl.toggle("slide",{direction:"down"},250,function(){that.elements.agentListControl.agentList("setFocusToAgentListHeader"),"function"==typeof callback&&callback()}),this.elements.agentListControl.agentList("updateGrid",!0)}},hideAgentList:function(callback){var isButtonSelected=IC_Common.isButtonSelected(this.elements.tabAgentsIconDiv);IC_Common.unselectButton(this.elements.tabAgentsIconDiv),logger.trace("hideAgentList - display "+this.elements.agentListControl.css("display")),"block"===this.elements.agentListControl.css("display")&&!0===isButtonSelected&&(AgentConsoleDataStore.pollAgentsCache=!1,this.elements.agentListControl.toggle("slide",{direction:"down"},250,callback))},closeAgentListAndShowHome:function(){var that=this;logger.trace("closeAgentListAndShowHome - Chat transfer clicked :"+this.isChatContactTransferClicked+", Workitem transfer clicked :"+this.isWorkItemTransferClicked+", VoiceMail transfer clicked :"+this.isVoiceMailTransferClicked+", E-Mail transfer clicked : "+this.isEmailContactTransferClicked),this.isWorkItemTransferClicked&&(this.isWorkItemTransferClicked=!1,this.activeContactWidgets[this.workItemIdToTransfer].sideBarWorkItemControl("enableDisbleBtnOnTransfer",this.isWorkItemTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isWorkItemTransferClicked,"WorkItem")),this.isVoiceMailTransferClicked&&(this.isVoiceMailTransferClicked=!1,this.activeContactWidgets[this.voiceMailIdToTransfer].sideBarVoiceMailControl("enableDisbleBtnOnTransfer",this.isVoiceMailTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isVoiceMailTransferClicked,"VoiceMail")),this.isChatContactTransferClicked&&(this.isChatContactTransferClicked=!1,this.activeContactWidgets[this.chatContactIdToTransfer].sideBarChatControl("enableDisbleBtnOnTransfer",this.isChatContactTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isChatContactTransferClicked,"Chat")),this.isEmailContactTransferClicked&&(this.isEmailContactTransferClicked=!1,this.activeContactWidgets[this.emailContactIdToTransfer].sideBarEmailControl("enableDisbleBtnOnTransfer",this.isEmailContactTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isEmailContactTransferClicked,"E-Mail")),this.hideAgentList(function(){that.showHomeOrContactsRootPanel(),that.resetAgentSkillListSize()})},showSkillList:function(callback){if(IC_Common.selectButton(this.elements.tabSkillsIconDiv),logger.trace("showSkillList - display "+this.elements.skillListControl.css("display")),"none"===this.elements.skillListControl.css("display")){this.updateSkillListQueue=!0;var that=this;this.elements.skillListControl.toggle("slide",{direction:"down"},250,function(){that.elements.skillListControl.skillList("setFocusToSkillListHeader"),"function"==typeof callback&&callback()}),this.elements.skillListControl.skillList("updateGrid")}},hideSkillList:function(callback){var isButtonSelected=IC_Common.isButtonSelected(this.elements.tabSkillsIconDiv);IC_Common.unselectButton(this.elements.tabSkillsIconDiv),logger.trace("hideSkillList - display "+this.elements.skillListControl.css("display")),"block"===this.elements.skillListControl.css("display")&&!0===isButtonSelected&&(this.updateSkillListQueue=!1,this.elements.skillListControl.toggle("slide",{direction:"down"},250,callback))},closeSkillListAndShowHome:function(){var that=this;logger.trace("closeSkillListAndShowHome - Chat transfer clicked :"+this.isChatContactTransferClicked+", Workitem transfer clicked :"+this.isWorkItemTransferClicked+", VoiceMail transfer clicked :"+this.isVoiceMailTransferClicked+", E-Mail transfer clicked : "+this.isEmailContactTransferClicked),this.isWorkItemTransferClicked&&(this.isWorkItemTransferClicked=!1,this.elements.skillListControl.skillList("resetFlag"),this.elements.skillListControl.skillList("updateMetaData","skills",AgentConsoleDataStore.allSkillList),this.activeContactWidgets[this.workItemIdToTransfer].sideBarWorkItemControl("enableDisbleBtnOnTransfer",this.isWorkItemTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isWorkItemTransferClicked,"WorkItem")),this.isVoiceMailTransferClicked&&(this.isVoiceMailTransferClicked=!1,this.elements.skillListControl.skillList("resetFlag"),this.elements.skillListControl.skillList("updateMetaData","skills",AgentConsoleDataStore.allSkillList),voiceMailWidget=this.activeContactWidgets[this.voiceMailIdToTransfer],voiceMailWidget.sideBarVoiceMailControl("enableDisbleBtnOnTransfer",this.isVoiceMailTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isVoiceMailTransferClicked,"VoiceMail")),this.isChatContactTransferClicked&&(this.isChatContactTransferClicked=!1,this.elements.skillListControl.skillList("resetFlag"),this.elements.skillListControl.skillList("updateMetaData","skills",AgentConsoleDataStore.allSkillList),this.activeContactWidgets[this.chatContactIdToTransfer].sideBarChatControl("enableDisbleBtnOnTransfer",this.isChatContactTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isChatContactTransferClicked,"Chat")),this.isEmailContactTransferClicked&&(this.isEmailContactTransferClicked=!1,this.elements.skillListControl.skillList("resetFlag"),this.elements.skillListControl.skillList("updateMetaData","skills",AgentConsoleDataStore.allSkillList),emailContactWidget=this.activeContactWidgets[this.emailContactIdToTransfer],emailContactWidget.sideBarEmailControl("enableDisbleBtnOnTransfer",this.isEmailContactTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isEmailContactTransferClicked,"E-Mail")),this.isSkillSelectedHere&&(this.isSkillSelectedHere=!1),this.hideSkillList(function(){that.showHomeOrContactsRootPanel(),that.resetAgentSkillListSize()})},closeAddressBookAndShowHome:function(){var that=this;logger.trace("closeAddressBookAndShowHome - Chat transfer clicked :"+this.isChatContactTransferClicked),this.isChatContactTransferClicked&&(this.isChatContactTransferClicked=!1,this.activeContactWidgets[this.chatContactIdToTransfer].sideBarChatControl("enableDisbleBtnOnTransfer",this.isChatContactTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isChatContactTransferClicked,"Chat")),this.hideAddressBook(function(){that.showHomeOrContactsRootPanel(),that.resetAgentSkillListSize()})},showAddressBook:function(callback){IC_Common.selectButton(this.elements.tabAddressBookIconDiv),logger.trace("showAddressBook - display "+this.elements.addressBookControl.css("display")),"none"===this.elements.addressBookControl.css("display")&&(this.elements.addressBookControl.toggle("slide",{direction:"down"},250,callback),AgentConsoleDataStore.getAddressBook(),this.elements.addressBookControl.addressBook("updateGrid"),this.elements.addressBookControl.addressBook("setFocusToAddressBookHeader"))},hideAddressBook:function(callback){IC_Common.unselectButton(this.elements.tabAddressBookIconDiv),logger.trace("hideAddressBook"),"block"===this.elements.addressBookControl.css("display")&&this.elements.addressBookControl.toggle("slide",{direction:"down"},250,callback),this.elements.addressBookControl.addressBook("stopPollingDynamicAddressBook")},showContactHistory:function(callback){IC_Common.selectButton(this.elements.tabHistoryIconDiv),this.elements.contactHistoryControl.contactHistory("setVisibility",!0),logger.trace("showContactHistory - display "+this.elements.contactHistoryControl.css("display")),"none"===this.elements.contactHistoryControl.css("display")&&(this.elements.contactHistoryControl.toggle("slide",{direction:"down"},250,callback),this.elements.contactHistoryControl.contactHistory("setFocusToContactHistoryHeader"))},hideContactHistory:function(callback){IC_Common.unselectButton(this.elements.tabHistoryIconDiv),this.elements.contactHistoryControl.contactHistory("setVisibility",!1),logger.trace("hideContactHistory - display "+this.elements.contactHistoryControl.css("display")),"block"===this.elements.contactHistoryControl.css("display")&&this.elements.contactHistoryControl.toggle("slide",{direction:"down"},250,callback)},closeContactHistoryAndShowHome:function(){logger.trace("closeContactHistoryAndShowHome");var that=this;this.hideContactHistory(function(){that.showHomeOrContactsRootPanel()})},showAgentInfo:function(callback){IC_Common.selectButton(this.elements.tabAgentInfoIconDiv),logger.trace("showAgentInfo - display "+this.elements.agentInfoControl.css("display")),"none"===this.elements.agentInfoControl.css("display")&&(this.elements.agentInfoControl.toggle("slide",{direction:"down"},250,callback),this.elements.agentInfoControl.agentInformation("startTimer"),this.elements.agentInfoControl.agentInformation("setFocusToAgentInfoHeader"))},hideAgentInfo:function(callback){IC_Common.unselectButton(this.elements.tabAgentInfoIconDiv),logger.trace("hideAgentInfo - display "+this.elements.agentInfoControl.css("display")),"block"===this.elements.agentInfoControl.css("display")&&(this.elements.agentInfoControl.toggle("slide",{direction:"down"},250,callback),this.elements.agentInfoControl.agentInformation("clearTimer"))},closeAgentInfoAndShowHome:function(){var that=this;logger.trace("closeAgentInfoAndShowHome "),this.hideAgentInfo(function(){that.showHomeOrContactsRootPanel()})},createNewpromiseKeeper:function(isEvolve){logger.trace("createNewpromiseKeeper ");this.showTabControl(),this.switchTab("promiseKeeperDetails"),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("createNewPromise",isEvolve)},showAgentPerformance:function(agentPerformance,teamPerformance,reports){this.showTabControl(),this.switchTab("agentReportsPerformance"),this.elements.agentReportsPerformanceControl.agentReportsPerformance("showAgentReports",agentPerformance,teamPerformance,reports)},createScheduledCallback:function(firstName,lastName,phone,skillId,targetId,callbackTime,notes,successCallback,failureCallback){AgentConsoleDataStore.createScheduledCallback(firstName,lastName,phone,skillId,targetId,callbackTime,notes,successCallback,failureCallback)},updateScheduledCallback:function(callbackId,firstName,lastName,phone,skillId,targetId,callbackTime,notes,successCallback,failureCallback){AgentConsoleDataStore.updateScheduledCallback(callbackId,firstName,lastName,phone,skillId,targetId,callbackTime,notes,successCallback,failureCallback)},dateTimePicker:function(callbackTime){this.showTabControl(),this.switchTab("promiseKeeperDateTime"),this.elements.promiseKeeperDateTimeControl.promiseKeeperDateTime("setDate",callbackTime)},showPromiseKeeperDateTime:function(callback){logger.trace("showPromiseKeeperDateTime - display "+this.elements.promiseKeeperDateTimeControl.css("display")),"none"===this.elements.promiseKeeperDateTimeControl.css("display")&&(this.elements.promiseKeeperDateTimeControl.toggle("slide",{direction:"down"},250,callback),this.elements.promiseKeeperDateTimeControl.promiseKeeperDateTime("setFocusToCommitmentDateHeader"))},hideRescheduleDateTime:function(){logger.trace("hideRescheduleDateTime - display "+this.elements.rescheduleDateTimeControl.css("display")),"block"===this.elements.rescheduleDateTimeControl.css("display")&&this.elements.rescheduleDateTimeControl.toggle("slide",{direction:"down"},250)},showRescheduleDateTime:function(contactId,dnis){logger.trace("showRescheduleDateTime - display "+this.elements.rescheduleDateTimeControl.css("display")),"none"===this.elements.rescheduleDateTimeControl.css("display")&&(this.elements.rescheduleDateTimeControl.toggle("slide",{direction:"down"},250),this.elements.rescheduleDateTimeControl.rescheduleDateTime("setDate",new Date),this.elements.rescheduleDateTimeControl.rescheduleDateTime("setFocusToRescheduleHeader",contactId,dnis))},hidePromiseKeeperDateTime:function(){logger.trace("hidePromiseKeeperDateTime - display "+this.elements.promiseKeeperDateTimeControl.css("display")),"block"===this.elements.promiseKeeperDateTimeControl.css("display")&&this.elements.promiseKeeperDateTimeControl.toggle("slide",{direction:"down"},250)},closePromiseKeeperDateTimeAndShowHome:function(){logger.trace("closePromiseKeeperDateTimeAndShowHome "),this.hidePromiseKeeperDateTime(),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("setFocusToDateTimeDiv")},closeRescheduleDateTime:function(){logger.trace("closeRescheduleDateTime"),this.hideRescheduleDateTime()},showPromiseKeeper:function(callback){IC_Common.selectButton(this.elements.tabPromiseKeeperIconDiv),logger.trace("showPromiseKeeper - display "+this.elements.promiseKeeperControl.css("display")),"none"===this.elements.promiseKeeperControl.css("display")&&(this.elements.promiseKeeperControl.toggle("slide",{direction:"down"},250,callback),this.elements.promiseKeeperControl.promiseKeeper("setFocusToCommitmentHeader"))},hidePromiseKeeper:function(callback){IC_Common.unselectButton(this.elements.tabPromiseKeeperIconDiv),logger.trace("hidePromiseKeeper - display "+this.elements.promiseKeeperControl.css("display")),"block"===this.elements.promiseKeeperControl.css("display")&&this.elements.promiseKeeperControl.toggle("slide",{direction:"down"},250,callback),this.elements.tabPromiseKeeperIconDiv.on("click",$.proxy(this.onClickTabPromiseKeeper,this))},closePromiseKeeperAndShowHome:function(){var that=this;logger.trace("closePromiseKeeperAndShowHome "),this.hidePromiseKeeper(function(){that.showHomeOrContactsRootPanel()})},showPromiseKeeperDetails:function(callback){logger.trace("showPromiseKeeperDetails - display "+this.elements.promiseKeeperDetailsControl.css("display")),"none"===this.elements.promiseKeeperDetailsControl.css("display")&&(this.elements.promiseKeeperDetailsControl.toggle("slide",{direction:"down"},250,callback),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("setFocusToCommitmentDetailsHeader"))},hidePromiseKeeperDetails:function(callback){logger.trace("hidePromiseKeeperDetails - display "+this.elements.promiseKeeperDetailsControl.css("display")),"block"===this.elements.promiseKeeperDetailsControl.css("display")&&this.elements.promiseKeeperDetailsControl.toggle("slide",{direction:"down"},250,function(){callback&&callback()})},closePromiseKeeperDetailsAndShowHome:function(){logger.trace("closePromiseKeeperDetailsAndShowHome ");var that=this;this.hidePromiseKeeperDetails(function(){that.showHomeOrContactsRootPanel()})},showAgentReports:function(callback){IC_Common.selectButton(this.elements.tabAgentReportsIconDiv),this.elements.agentReportsControl.agentReports("setVisibility",!0),logger.trace("showAgentReports - display "+this.elements.agentReportsControl.css("display")),"none"===this.elements.agentReportsControl.css("display")&&(this.elements.agentReportsControl.toggle("slide",{direction:"down"},250,callback),this.elements.agentReportsControl.agentReports("setFocusToReportsHeader"))},hideAgentReports:function(callback){IC_Common.unselectButton(this.elements.tabAgentReportsIconDiv),this.elements.agentReportsControl.agentReports("setVisibility",!1),logger.trace("hideAgentReports - display "+this.elements.agentReportsControl.css("display")),"block"===this.elements.agentReportsControl.css("display")&&this.elements.agentReportsControl.toggle("slide",{direction:"down"},250,callback),this.elements.tabAgentReportsIconDiv.on("click",$.proxy(this.onClickTabAgentReports,this))},closeAgentReportsAndShowHome:function(){var that=this;logger.trace("closeAgentReportsAndShowHome "),this.hideAgentReports(function(){that.showHomeOrContactsRootPanel()})},showAgentReportsPerformance:function(callback){logger.trace("showAgentReportsPerformance - display "+this.elements.agentReportsPerformanceControl.css("display")),"none"===this.elements.agentReportsPerformanceControl.css("display")&&(this.elements.agentReportsPerformanceControl.toggle("slide",{direction:"down"},250,callback),this.elements.agentReportsPerformanceControl.agentReportsPerformance("setFocusToPerformanceHeader"))},hideAgentReportsPerformance:function(callback){logger.trace("hideAgentReportsPerformance - display "+this.elements.agentReportsPerformanceControl.css("display")),"block"===this.elements.agentReportsPerformanceControl.css("display")&&this.elements.agentReportsPerformanceControl.toggle("slide",{direction:"down"},250)},closeAgentReportsPerformanceAndShowHome:function(){logger.trace("closeAgentReportsPerformanceAndShowHome ");var that=this;this.hideAgentReportsPerformance(function(){that.showHomeOrContactsRootPanel()})},showEvolveSchedule:function(callback){IC_Common.selectButton(this.elements.tabEvolveScheduleIconDiv),this.isEvolveWFMEnabled?this.elements.evolveScheduleControl.evolveSchedule("setVisibility",!0,!0):this.elements.evolveScheduleControl.evolveSchedule("setVisibility",!0,!1),logger.trace("showEvolveSchedule - display "+this.elements.evolveScheduleControl.css("display")),"none"===this.elements.evolveScheduleControl.css("display")&&(this.elements.evolveScheduleControl.toggle("slide",{direction:"down"},250,callback),this.elements.evolveScheduleControl.evolveSchedule("setFocusToScheduleHeader"))},hideEvolveSchedule:function(callback){IC_Common.unselectButton(this.elements.tabEvolveScheduleIconDiv),this.elements.evolveScheduleControl.evolveSchedule("setVisibility",!1),logger.trace("hideEvolveSchedule - display "+this.elements.evolveScheduleControl.css("display")),"block"===this.elements.evolveScheduleControl.css("display")&&this.elements.evolveScheduleControl.toggle("slide",{direction:"down"},250,callback),this.elements.tabEvolveScheduleIconDiv.on("click",$.proxy(this.onClickTabEvolveSchedule,this))},closeEvolveScheduleAndShowHome:function(){var that=this;this.hideEvolveSchedule(function(){that.showHomeOrContactsRootPanel()})},showfeedbackOptionPanel:function(callback){logger.trace("showfeedbackOptionPanel - display :"+this.elements.agentFeedbackControl.css("display")),"none"===this.elements.agentFeedbackControl.css("display")&&(this.showfeedback=!0,this.elements.agentFeedbackControl.toggle("slide",{direction:"down"},250,callback),this.elements.agentFeedbackControl.agentFeedback("setFocusToFeedbackHeader"))},hidefeedbackOptionPanel:function(callback){logger.trace("hidefeedbackOptionPanel - display :"+this.elements.agentFeedbackControl.css("display")),"block"===this.elements.agentFeedbackControl.css("display")&&(this.showfeedback=!1,this.elements.agentFeedbackControl.toggle("slide",{direction:"down"},250,callback))},closefeedbackPnlAndShowHome:function(){logger.trace("closefeedbackPnlAndShowHome");var that=this;this.hidefeedbackOptionPanel(function(){this.showfeedback=!1,that.showHomeOrContactsRootPanel()})},showContentPanelWrapper:function(callback){logger.trace("showContentPanelWrapper"),"none"===this.elements.contentPanelWrapper.css("display")&&(this.elements.contentPanelWrapper.toggle("slide",{direction:"down"},250,callback),this.elements.agentLegState.showfn(),this.elements.agentLegStatebgElement.showfn(),this.elements.footerPanel.footer("toggleFooterCount",!0)),IC_Validation.isNotNullOrEmpty(this.panelDisplayed)&&this.showHomeTabPanel()},showHomeTabPanel:function(){"block"===this.elements.dialPadControl.css("display")||"block"===this.elements.agentListControl.css("display")||"block"===this.elements.skillListControl.css("display")||"block"===this.elements.addressBookControl.css("display")||"block"===this.elements.contactHistoryControl.css("display")||"block"===this.elements.agentInfoControl.css("display")||"block"===this.elements.agentFeedbackControl.css("display")||"block"===this.elements.agentMessageControl.css("display")||"block"===this.elements.promiseKeeperControl.css("display")||AgentConsoleDataStore.getNonParkedContactsCount()>0||"block"===this.elements.promiseKeeperDetailsControl.css("display")||"block"===this.elements.agentReportsControl.css("display")||"block"===this.elements.agentReportsPerformanceControl.css("display")||"block"===this.elements.evolveScheduleControl.css("display")?(logger.trace("showHomeTabPanel - showTabControl"),this.showTabControl()):(logger.trace("showHomeTabPanel - hideTabControl"),this.hideTabControl())},hideContentPanelWrapper:function(){"block"===this.elements.contentPanelWrapper.css("display")&&(logger.trace("hideContentPanelWrapper"),this.elements.contentPanelWrapper.slideUp(250),this.elements.headerLogo.fadeIn(),this.elements.agentMsgScroll.fadeOut(),this.elements.agentLegState.hide(),this.elements.agentLegStatebgElement.hide(),this.elements.agentIndicatorPanel.hide(),this.elements.agentIndicatorPanel.indicator("updateData","indicator",{}),this.elements.footerPanel.footer("updateData","phone",0),this.elements.footerPanel.footer("updateData","workItem",0),this.elements.footerPanel.footer("updateData","chat",0),this.elements.footerPanel.footer("updateData","personalQueue",0),this.elements.footerPanel.footer("toggleFooterCount",!1))},onChatContactTransfer:function(chatContactId){logger.trace("ContactID: "+chatContactId," onChatContactTransfer"),this.chatContactIdToTransfer=chatContactId,this.isChatContactTransferClicked=!0,this.activeContactWidgets[this.chatContactIdToTransfer].sideBarChatControl("enableDisbleBtnOnTransfer",this.isChatContactTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isChatContactTransferClicked,"Chat"),this.switchTab("agents")},onEmailContactTransfer:function(emailContactId){logger.trace("ContactID: "+emailContactId," onEmailContactTransfer"),this.emailContactIdToTransfer=emailContactId,this.isEmailContactTransferClicked=!0,this.activeContactWidgets[this.emailContactIdToTransfer].sideBarEmailControl("enableDisbleBtnOnTransfer",this.isEmailContactTransferClicked),this.switchTab("agents"),this.changeBtnStateOnWorkItemTransfer(this.isEmailContactTransferClicked,"E-Mail")},onWorkItemTransfer:function(workItemId){logger.trace("ContactID: "+workItemId," onWorkItemTransfer"),this.workItemIdToTransfer=workItemId,this.topPadding=121,this.isWorkItemTransferClicked=!0,this.activeContactWidgets[this.workItemIdToTransfer].sideBarWorkItemControl("enableDisbleBtnOnTransfer",this.isWorkItemTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isWorkItemTransferClicked,"WorkItem"),this.showTab("agents")},transferWorkItemToSkill:function(workItemId,skillName){logger.trace("ContactID: "+workItemId," transferWorkItemToSkill - skill :"+skillName);var that=this;AgentConsoleDataStore.transferWorkItemContactToSkill(workItemId,skillName,function(){that.closeSkillListAndShowHome()})},transferWorkItemToAgent:function(workItemId,agentUserName){logger.trace("ContactID: "+workItemId," transferWorkItemToAgent - agent :"+agentUserName);var that=this;AgentConsoleDataStore.transferWorkItemContactToAgent(workItemId,agentUserName,function(){that.closeAgentListAndShowHome()})},onVoiceMailTransfer:function(voiceMailId){logger.trace("onVoiceMailTransfer - contactId :"+voiceMailId),this.voiceMailIdToTransfer=voiceMailId,this.isVoiceMailTransferClicked=!0,this.activeContactWidgets[this.voiceMailIdToTransfer].sideBarVoiceMailControl("enableDisbleBtnOnTransfer",this.isVoiceMailTransferClicked),this.changeBtnStateOnWorkItemTransfer(this.isVoiceMailTransferClicked,"VoiceMail"),this.switchTab("agents")},transferVoiceMailToSkill:function(voiceMailId,skillId){logger.trace("transferVoiceMailToSkill - contactId :"+voiceMailId+", skill :"+skillId);var that=this;AgentConsoleDataStore.transferVoiceMailContactToSkill(voiceMailId,skillId,function(){that.closeSkillListAndShowHome()})},transferVoiceMailToAgent:function(voiceMailId,agentId){logger.trace("transferVoiceMailToAgent - contactId :"+voiceMailId+", agent :"+agentId);var that=this;AgentConsoleDataStore.transferVoiceMailContactToAgent(voiceMailId,agentId,function(){that.closeAgentListAndShowHome()})},transferChatToSkill:function(chatContactId,skillName){logger.trace("ContactID: "+chatContactId," transferChatToSkill - skill :"+skillName),AgentConsoleDataStore.transferChat(chatContactId,skillName)},transferChatToAgent:function(chatContactId,agentId){logger.trace("ContactID: "+chatContactId," transferChatToAgent - agentId :"+agentId),AgentConsoleDataStore.transferChatToAgent(chatContactId,agentId)},transferEmailToSkill:function(emailContactId,skillId){logger.trace("ContactID: "+emailContactId," transferEmailToSkill - skillId :"+skillId),AgentConsoleDataStore.transferEmailToSkill(emailContactId,skillId)},transferEmailToAgent:function(emailContactId,agentId){logger.trace("ContactID: "+emailContactId," transferEmailToAgent - agentId :"+agentId),AgentConsoleDataStore.transferEmailToAgent(emailContactId,agentId)},acceptAgentConsult:function(contactId){logger.trace("ContactID: "+contactId," acceptAgentConsult"),AgentConsoleDataStore.acceptAgentConsult(contactId)},acceptContact:function(contactId){logger.trace("ContactID: "+contactId," acceptContact"),AgentConsoleDataStore.acceptContact(contactId)},rejectContact:function(contactId){logger.trace("ContactID: "+contactId," rejectContact"),AgentConsoleDataStore.rejectContact(contactId)},snoozeContact:function(contactId){logger.trace("ContactID: "+contactId," snoozeContact"),AgentConsoleDataStore.snoozeContact(contactId)},holdContact:function(contactId,onSuccessCallback){logger.trace("ContactID: "+contactId," holdContact"),AgentConsoleDataStore.holdContact(contactId,onSuccessCallback)},callBackVoiceMailContact:function(contact,onSuccessCallback){logger.trace("callBackVoiceMailContact - contactId : "+contact.id),this.holdContact(contact.id,onSuccessCallback),this.showDialPadVM(contact)},resumeVoiceMailContact:function(contact){logger.trace("resumeVoiceMailContact - contactId :"+contact.id),AgentConsoleDataStore.resumeContact(contact.id),this.showOrHideDialPadPC(contact,!1)},resumeContact:function(contactId){logger.trace("ContactID: "+contactId," resumeContact"),AgentConsoleDataStore.resumeContact(contactId)},transferContact:function(){logger.trace("transferContact"),AgentConsoleDataStore.transferContacts()},endContact:function(contactId){logger.trace("ContactID: "+contactId," endContact"),AgentConsoleDataStore.endContact(contactId)},onEmailContactEnd:function(contactId,isInbound){var that=this;return emailContactWidget=this.activeContactWidgets[contactId],emailContactWidget.sideBarEmailControl("enableDisbleBtnOnTransfer",!0),isInbound?void this.showConfirmationPrompt(IC_Localization.alertMessageEndContact,function(){that.endContact(contactId)},function(){emailContactWidget=that.activeContactWidgets[contactId],emailContactWidget.sideBarEmailControl("enableDisbleBtnOnTransfer",!1)},245):void that.endContact(contactId)},recordCall:function(contactId){logger.trace("ContactID: "+contactId," recordCall"),AgentConsoleDataStore.recordCall(contactId)},maskCallRecording:function(contactId){logger.trace("ContactID: "+contactId," maskCallRecording"),AgentConsoleDataStore.maskCall(contactId)},unmaskCallRecording:function(contactId){logger.trace("ContactID: "+contactId," unmaskCallRecording"),AgentConsoleDataStore.unmaskCall(contactId)},getContactHistory:function(from,to,callback){logger.trace("getContactHistory - from :"+from+", to :"+to),AgentConsoleDataStore.getContactHistory(from,to,callback)},getAgentPerformanceHistory:function(from,to,callback){logger.trace("getAgentReportsHistory - from :"+from+", to :"+to),AgentConsoleDataStore.getAgentPerformanceHistory(from,to,callback)},getTeamPerformanceHistory:function(from,to,callback){logger.trace("getAgentReportsHistory - from :"+from+", to :"+to),AgentConsoleDataStore.getTeamPerformanceHistory(from,to,callback)},getEvolveSchedule:function(successCallback,errorCallback){logger.trace("getEvolveSchedule called."),AgentConsoleDataStore.getEvolveSchedule(successCallback,errorCallback)},isPhoneNumberCharValid:function(currChar){var char=currChar.toString(),regexp=new RegExp(/^([0-9|a-z|A-Z|*|#|,|+])$/g);return!!char.match(regexp)},formatPhoneNumber:function(phNumber){var formatedNumber=phNumber.toString(),unformattedPhoneNumber="";for(i=0;i<phNumber.length;i++){var currChar=phNumber[i];!0===this.isPhoneNumberCharValid(currChar)&&(unformattedPhoneNumber+=formatedNumber[i])}return unformattedPhoneNumber},ValidatePhoneNumber:function(phNumber){if(!IC_Validation.isValidDialNumber(phNumber))return this.addMessage("eMsg",IC_Localization.enterValidPhoneNumber),void this.elements.popupDiv.showfn()},dialPhoneNumber:function(phNumber,clientX,clientY){logger.trace("dialPhoneNumber - phNumber:"+phNumber+", clientX :"+clientX+", clientY :"+clientY);var x,y,menuH,menuW,skillMenu=this.elements.obPhoneSkillsMenu,skillMenuItems=skillMenu.find(".menuItem"),that=this;skillMenuItems.length>0&&(skillMenu.finish(),this.numberToDial=phNumber,1==skillMenuItems.length?skillMenuItems.trigger("click"):(x=clientX+document.body.scrollLeft,y=clientY+document.body.scrollTop,menuH=skillMenu.height(),menuW=skillMenu.width(),y+menuH>=460&&(y-=menuH),x+menuW>=180&&(x=menuW>180?10:180-menuW),skillMenu.css("left",x+"px"),skillMenu.css("top",y+"px"),skillMenu.mCustomScrollbar("destroy"),skillMenu.show(0,function(){skillMenu.mCustomScrollbar({scrollButtons:{enable:!0},scrollInertia:0}),clearTimeout(that.obSkillHideTimeout),that.obSkillHideTimeout=setTimeout(function(){skillMenu.fadeOut()},5e3),that.obPhoneSkillsMenuFlag=!0})))},onAgentSelected:function(agentId){var workItemId,agentUserName,that=this;if(logger.trace("onAgentSelected - agent id :"+agentId+", WorkItem :"+this.isWorkItemTransferClicked+", VoiceMail :"+this.isVoiceMailTransferClicked+", Chat :"+this.isChatContactTransferClicked+", E-Mail : "+this.isEmailContactTransferClicked),this.isWorkItemTransferClicked)return workItemId=AgentConsoleDataStore.getNonParkedContacts()[0].id,agentUserName=AgentConsoleDataStore.agentListMap[agentId].un,void this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferWorkItemToAgent(workItemId,agentUserName)},function(){that.switchTab("agents")},335);if(this.isVoiceMailTransferClicked)return voiceMailId=this.voiceMailIdToTransfer,agentId=agentId,void this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferVoiceMailToAgent(voiceMailId,agentId)},function(){that.switchTab("agents")},335);if(this.isChatContactTransferClicked){var chatContactId=this.chatContactIdToTransfer;this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferChatToAgent(chatContactId,agentId)},function(){that.switchTab("agents")},245)}else if(this.isEmailContactTransferClicked){var emailContactId=this.emailContactIdToTransfer;this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferEmailToAgent(emailContactId,agentId)},function(){that.switchTab("agents")},245)}else this.isMaxConferenceLimitNotReached()&&this.showAddCallPrompt(function(){that.isWorkItemTransferClicked=!1,that.isVoiceMailTransferClicked=!1,that.isEmailContactTransferClicked=!1,"Available"===AgentConsoleDataStore.agentListMap[agentId].asn||"Unavailable"===AgentConsoleDataStore.agentListMap[agentId].asn&&"False"===AgentConsoleDataStore.agentListMap[agentId].acw?AgentConsoleDataStore.dialConsultAgent(AgentConsoleDataStore.agentListMap[agentId].un):AgentConsoleDataStore.dialAgentPersonalQueue(AgentConsoleDataStore.agentListMap[agentId].un)},function(){that.switchTab("agents")})},onSkillSelected:function(skillName,skillId){this.isSkillSelectedHere=!0;var chatContactId,that=this;if(logger.trace("onSkillSelected - skillName :"+skillName+", WorkItem :"+this.isWorkItemTransferClicked+", VoiceMail :"+this.isVoiceMailTransferClicked+", Chat :"+this.isChatContactTransferClicked+", E-Mail : "+this.isEmailContactTransferClicked),this.isWorkItemTransferClicked){var workItemId=AgentConsoleDataStore.getNonParkedContacts()[0].id;this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferWorkItemToSkill(workItemId,skillName)},function(){that.switchTab("skills")},335)}else if(this.isVoiceMailTransferClicked){var voiceMailId=this.voiceMailIdToTransfer;this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferVoiceMailToSkill(voiceMailId,skillId)},function(){that.switchTab("skills")},335)}else{if(this.isChatContactTransferClicked)return chatContactId=this.chatContactIdToTransfer,void this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferChatToSkill(chatContactId,skillName)},function(){that.switchTab("skills")},245);if(this.isEmailContactTransferClicked){var emailContactId=this.emailContactIdToTransfer;this.showConfirmationPrompt(IC_Localization.areYouSure,function(){that.transferEmailToSkill(emailContactId,skillId)},function(){that.switchTab("skills")},245)}else this.isMaxConferenceLimitNotReached()&&this.showAddCallPrompt(function(){that.isWorkItemTransferClicked=!1,that.isVoiceMailTransferClicked=!1,that.isChatContactTransferClicked=!1,that.isEmailContactTransferClicked=!1,AgentConsoleDataStore.dialSkill(skillName)},function(){that.switchTab("skills")})}},onClickAgentLeg:function(){var contacts=AgentConsoleDataStore.contacts;void 0!==this.agentInfo.lgState&&(logger.trace("onClickAgentLeg - lgState :"+this.agentInfo.lgState+", contact length :"+contacts.length),"Disconnected"===this.agentInfo.lgState?AgentConsoleDataStore.dialAgentLeg():("Dialing"===this.agentInfo.lgState||"Active"===this.agentInfo.lgState&&0===contacts.length)&&AgentConsoleDataStore.endAgentLeg())},onClickMsgOkBtn:function(){logger.trace("onClickMsgOkBtn"),AgentConsoleDataStore.containsErrorCodeById(this.currentPopupId,"Custom_SessionEnd")&&setTimeout($.proxy(this.authenticateAndLoginAgent,this,!0),3e3),AgentConsoleDataStore.resetGetNextFailureCount(),this.hidePopup()},onLoginBtnClick:function(){logger.trace("onLoginBtnClick"),this.isAutoLoginErr=!1,setTimeout($.proxy(AgentConsoleDataStore.redirectToLoginPage,this,!0),3e3),this.hidePopup()},onClickCallMsgYesBtn:function(action,holdContactId,callback){logger.trace("holdContactId: "+holdContactId," onClickCallMsgYesBtn - action :"+action),"conference"===action?AgentConsoleDataStore.conferenceContacts(callback):"hold"===action&&this.holdContact(holdContactId,callback),this.closeCallMsgPopup()},closeCallMsgPopup:function(){logger.trace("closeCallMsgPopup ");var self=this;this.elements.popupDiv.fadeOut(function(){self.elements.callMsgDiv.children("span, br").remove()}),this.elements.callMsgDiv.css("display","none")},onClickHomeDialPad:function(){if(this.elements.tooltipDiv.css("display","none"),IC_Common.isButtonEnabled(this.elements.HomeDialPadIconDiv)||IC_Common.isButtonSelected(this.elements.HomeDialPadIconDiv)){var that=this;this.showTabControl(function(){that.switchTab("dialPad")})}},onClickHomeAgents:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("agents")})},onClickHomeSkills:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("skills")})},onClickHomeAddressBooks:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("addressBook")})},onClickHomeContactHistory:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("history")})},onClickHomeAgentInfo:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("information")})},onClickHomePromiseKeeper:function(){if(this.elements.tooltipDiv.css("display","none"),IC_Common.isButtonEnabled(this.elements.HomePromiseKeeperIconDiv)||IC_Common.isButtonSelected(this.elements.HomePromiseKeeperIconDiv)){var that=this;this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("promiseKeeper")}),this.elements.tabPromiseKeeperIconDiv.off("click")}},onClickHelp:function(){window.open(this.options.appHelpTarget,"_blank")},onClickHomeAgentReports:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("agentReports")}),this.elements.tabAgentReportsIconDiv.off("click")},onClickHomeEvolveSchedule:function(){var that=this;this.elements.tooltipDiv.css("display","none"),this.hideHomeOrContactsRootPanel(),this.showTabControl(function(){that.switchTab("evolveSchedule")}),this.elements.tabEvolveScheduleIconDiv.off("click")},onClickHomeEmail:function(event){var x,y;this.elements.tooltipDiv.css("display","none"),(IC_Common.isButtonEnabled(this.elements.HomeOBEmailIconDiv)||IC_Common.isButtonSelected(this.elements.HomeOBEmailIconDiv))&&(x=event.clientX||this.elements.HomeOBEmailIconDiv.offset().left,y=event.clientY||this.elements.HomeOBEmailIconDiv.offset().top+this.elements.HomeOBEmailIconDiv.height(),this.createEmailOB("",x,y))},onClickTabAgents:function(){if(this.isWorkItemTransferClicked||this.isVoiceMailTransferClicked||this.isChatContactTransferClicked||this.isEmailContactTransferClicked)return this.hideTab("skills"),this.hideTab("addressBook"),void this.showTab("agents");this.switchTab("agents")},onClickTabSkills:function(){if(this.isWorkItemTransferClicked||this.isVoiceMailTransferClicked||this.isChatContactTransferClicked||this.isEmailContactTransferClicked)return this.hideTab("agents"),this.hideTab("addressBook"),void this.showTab("skills");this.switchTab("skills")},onClickTabAddressBooks:function(){if(this.isChatContactTransferClicked)return this.hideTab("agents"),this.hideTab("skills"),void this.showTab("addressBook");this.switchTab("addressBook")},onClickTabContactHistory:function(){this.switchTab("history")},onClickTabAgentInfo:function(){this.switchTab("information")},onClickTabDialPad:function(e){if(IC_Common.isButtonEnabled(this.elements.tabDialpadIconDiv)||IC_Common.isButtonSelected(this.elements.tabDialpadIconDiv)){var that=this;this.elements.dialPadControl.dialPad("showMaxDialPadcss"),this.showAddCallPrompt(function(){that.switchTab("dialPad")})}},onClickTabPromiseKeeper:function(e){(IC_Common.isButtonEnabled(this.elements.tabPromiseKeeperIconDiv)||IC_Common.isButtonSelected(this.elements.tabPromiseKeeperIconDiv))&&(this.switchTab("promiseKeeper"),this.elements.tabPromiseKeeperIconDiv.off("click"))},onClickTabAgentReports:function(){this.switchTab("agentReports"),this.elements.tabAgentReportsIconDiv.off("click")},onClickTabEvolveSchedule:function(e){(IC_Common.isButtonEnabled(this.elements.tabEvolveScheduleIconDiv)||IC_Common.isButtonSelected(this.elements.tabEvolveScheduleIconDiv))&&(this.switchTab("evolveSchedule"),this.elements.tabEvolveScheduleIconDiv.off("click"))},onClickTabMessage:function(){(IC_Common.isButtonEnabled(this.elements.tabMessageIconDiv)||IC_Common.isButtonSelected(this.elements.tabMessageIconDiv))&&(this.switchTab("agentMessage"),this.elements.tabMessageIconDiv.off("click"))},onAddCallClick:function(){logger.trace("onAddCallClick - clicked "),this.elements.dialPadControl.dialPad("showMaxDialPadcss"),this.onClickTabDialPad()},onkeyPadClose:function(){logger.trace("onkeyPadClose - clicked "),this.elements.keyPadControl.hide()},onkeyPadClick:function(){var that=this;logger.trace("onkeyPadClick - clicked "),this.elements.keyPadControl.toggle("slide",{direction:"up"},500,function(){that.elements.keyPadControl.keyPad("setKeyPadFocus")})},sendDTMFValue:function(dtmfValue){logger.trace("sendDTMFValue - dtmfValue :"+dtmfValue),AgentConsoleDataStore.sendDTMFTones(dtmfValue)},onMuteClick:function(){logger.trace("onMuteClick - leg muted :"+this.agentInfo.lgMuted),!0===this.agentInfo.lgMuted?AgentConsoleDataStore.unmuteAgent():AgentConsoleDataStore.muteAgent()},onTransferClick:function(e){var nonParkedContactLength=AgentConsoleDataStore.getNonParkedContactsCount();logger.trace("onTransferClick - contact count :"+nonParkedContactLength),nonParkedContactLength>1&&AgentConsoleDataStore.transferContacts()},onConferenceClick:function(e){var nonParkedContactLength=AgentConsoleDataStore.getNonParkedContactsCount();logger.trace("onConferenceClick - contact count :"+nonParkedContactLength),nonParkedContactLength>1&&AgentConsoleDataStore.conferenceContacts()},onPopoutClick:function(e){logger.trace("onPopoutClick"),localStorage.popoutActiveTab=0,AgentConsoleDataStore.popoutChat()},onOptionsPanelOpen:function(isOpenedByAgent,error){if(!1===IC_Validation.isNotNullOrEmpty(this.elements.optionPanel)&&"Logging in"!==this.agentInfo.cState.state){logger.trace("onOptionsPanelOpen - error :",error),this.elements.footerPanel.footer("updateOptionIconSelected",!0),this.elements.optionPanel=$('<div class="optionPanel"/>').appendTo(this.elements.rootDiv);var userCredential=AgentConsoleDataStore.getCustomVar("UserCredential",userCredential);this.elements.optionPanel.css("bottom",this.getFooterAndBrandingHeight()),IC_Validation.isValidObject(userCredential)&&(this.options.username=userCredential.username,this.options.stationId=userCredential.stationId,this.options.phoneNo=userCredential.phoneNo,this.options.isAutoLogin=userCredential.isAutoLogin,this.options.isTooltipEnabled=userCredential.isTooltipEnabled,this.options.agentAudioSettings=userCredential.agentAudioSettings,this.options.agentVisualSettings=userCredential.agentVisualSettings),this.elements.optionPanel.userSetting({container:this,agentInfo:this.agentInfo,resourceBase:this.options.resourceBase}),this.elements.optionPanel.userSetting("setFocusToOptionsHeader",AgentConsoleDataStore.isEvolve()),IC_Validation.isValidObject(error)?this.elements.optionPanel.userSetting("updateView",error):IC_Validation.isNullOrEmpty(this.options.stationId)&&IC_Validation.isNullOrEmpty(this.options.phoneNo)?this.elements.optionPanel.userSetting("updateView"):IC_Validation.isNotNullOrUndefinedString(isOpenedByAgent)&&!isOpenedByAgent&&this.elements.optionPanel.userSetting("updateView"),this.elements.optionPanel.toggle("slide",{direction:"down"},250)}},closeUserSetting:function(){IC_Validation.isNotNullOrEmpty(this.elements.optionPanel)&&(logger.trace("closeUserSetting"),this.elements.optionPanel.userSetting("destroy"),this.elements.footerPanel.footer("updateOptionIconSelected",!1),this.elements.optionPanel=null)},saveUserSetting:function(stationId,phoneNo,phoneNumberType,logLevel,isTooltipEnabled,agentAudioSettings,agentVisualSettings){var that=this,isSettingChanged=this.options.stationId!==stationId||this.options.phoneNo!==phoneNo||this.options.logLevel!==logLevel||this.options.isTooltipEnabled!==isTooltipEnabled||JSON.stringify(this.options.agentAudioSettings)!==JSON.stringify(agentAudioSettings)||JSON.stringify(this.options.agentVisualSettings)!==JSON.stringify(agentVisualSettings),isAgentLoggedOut="Logged out"===this.agentInfo.cState.state,isNoReloginReq=this.options.stationId===stationId&&this.options.phoneNo===phoneNo&&(this.options.isTooltipEnabled!==isTooltipEnabled||this.options.logLevel!==logLevel||JSON.stringify(this.options.agentAudioSettings)!==JSON.stringify(agentAudioSettings)||JSON.stringify(this.options.agentVisualSettings)!==JSON.stringify(agentVisualSettings));logger.debug("saveUserSetting - settingChanged :"+isSettingChanged+", Agent logged out :"+isAgentLoggedOut),this.closeUserSetting(),isSettingChanged?AgentConsoleDataStore.upsertUserOptions(stationId,phoneNo,phoneNumberType,logLevel,isTooltipEnabled,agentAudioSettings,agentVisualSettings,function(isError,errorMsg){if(isError){var error={ShowError:isError,msg:errorMsg};that.onOptionsPanelOpen(!1,error)}else{var userCredential={stationId:stationId,phoneNo:phoneNo,isTooltipEnabled:isTooltipEnabled,agentAudioSettings:agentAudioSettings,agentVisualSettings:agentVisualSettings};if(AgentConsoleDataStore.setCustomVar("UserCredential",userCredential),AgentConsoleDataStore.setCustomVar("UserAVSettings",userCredential),isNoReloginReq&&(that.options.isTooltipEnabled=isTooltipEnabled,that.options.logLevel=logLevel,that.options.agentAudioSettings=agentAudioSettings,that.options.agentVisualSettings=agentVisualSettings),0===AgentConsoleDataStore.getNonParkedContactsCount())isAgentLoggedOut?("block"===that.elements.loginPopupDiv.css("display")&&that.hidePopup(),that.options.stationId=stationId,that.options.phoneNo=phoneNo,that.options.logLevel=logLevel,that.options.isTooltipEnabled=isTooltipEnabled,that.options.agentAudioSettings=agentAudioSettings,that.options.agentVisualSettings=agentVisualSettings,that.loginAgent(!0)):isNoReloginReq||(AgentConsoleDataStore.setCustomVar("UserLoginRequested",!0),AgentConsoleDataStore.logout(function(){AgentConsoleDataStore.redirectToLoginPage(!1)}));else if(!isNoReloginReq){var message=IC_Localization.callInProgressNotReauthenticate;that.addMessage("eMsg",message),that.elements.popupDiv.showfn()}}}):isAgentLoggedOut&&("block"===this.elements.loginPopupDiv.css("display")&&this.hidePopup(),this.authenticateAndLoginAgent(!0))},logoutUser:function(){var parkedList,that=this,pendingPromises=this.isPendingPromiseExist(),parkedEmailList=AgentConsoleDataStore.parkedEmailList;parkedList=$.grep(parkedEmailList,function(item){return item.targetAgentId!=AgentConsoleDataStore.agentInfo.id});var contactsToRequeue=function(){var interruptedContactsCount=0,activeContactsCount=0;if(IC_Validation.isNotNullOrEmptyArray(that.allContacts))for(var i=0;i<that.allContacts.length;i++)"Interrupted"===that.allContacts[i].status?interruptedContactsCount++:activeContactsCount++;return{interrupted:interruptedContactsCount,active:activeContactsCount}}();function logout(callback,logoutParams){"Logged out"!==that.agentInfo.cState.state&&"Logging in"!==that.agentInfo.cState.state&&(logger.trace("logoutUser - clicked"),that.elements.agentStatePanel.agentState("updateNextStateTimerOnLogout"),AgentConsoleDataStore.logout(null,logoutParams),callback&&callback())}contactsToRequeue.active<=0&&(this.personalQueueCountForLogout>0||contactsToRequeue.interrupted>0)?(this.closeUserSetting(),this.showConfirmationPrompt(IC_Localization.logoutRequeueInterruptedContactsConfirmation.replace("{0}",this.personalQueueCountForLogout>0?this.personalQueueCountForLogout:contactsToRequeue.interrupted),function(){logout(null,{forceLogoff:!0,ignorePersonalQueue:!1,endContacts:!0})},function(){})):pendingPromises&&parkedList.length>0?(this.closeUserSetting(),this.showConfirmationPrompt(IC_Localization.logoutConfirmation,logout,function(){})):pendingPromises?(this.closeUserSetting(),this.showConfirmationPrompt(IC_Localization.reminderWarning,logout,function(){})):parkedList.length>0?(this.closeUserSetting(),this.showConfirmationPrompt(IC_Localization.logoutConfirmationForInbox,logout,function(){})):logout($.proxy(that.closeUserSetting,that))},isPendingPromiseExist:function(){for(var promiseKeeperRecords=AgentConsoleDataStore.promiseKeeperList,i=0;i<promiseKeeperRecords.length;i++)if("A"===promiseKeeperRecords[i].target&&(new Date(AgentConsoleDataStore.promiseKeeperList[i].callbackTime)-new Date)/1e3/60<60)return!0;return!1},showCancelChangesPrompt:function(callback){var that=this;this.showConfirmationPrompt(IC_Localization.callbackCancelChanges,function(){callback?callback():that.hidePromiseKeeperDetails()},function(){})},downloadLogEntries:function(){logger.trace("downloadLogEntries - clicked"),AgentConsoleDataStore.downloadLog(),this.closeUserSetting()},showFeedbackForm:function(){logger.trace("showFeedbackForm ");this.closeUserSetting(),this.hideHomeOrContactsRootPanel(),this.showTabControl(),this.switchTab("feedback")},persistContactHistoryFilterData:function(sortByItem,filterItem,searchText){logger.debug("persistContactHistoryFilterData - SortBy :"+sortByItem+", Filter :"+filterItem+", Search Text :"+searchText),AgentConsoleDataStore.persistContactHistoryFilterData(sortByItem,filterItem,searchText)},getAddressBookEntries:function(addressBookName,callback,searchText,sortField){logger.trace("getAddressBookEntries - fired"),AgentConsoleDataStore.getAddressBookEntries(addressBookName,callback,searchText,sortField)},getDynamicAddressBookEntries:function(addressBookId,isFullLoad,updatedSince,callback){logger.trace("getDynamicAddressBookEntries - fired"),AgentConsoleDataStore.getDynamicAddressBookEntries(addressBookId,isFullLoad,updatedSince,callback)},showTabControl:function(callback){var tabPanel=this.elements.tabPanel;logger.trace("showTabControl - fired"),tabPanel.stop(!0,!0),"none"===tabPanel.css("display")&&tabPanel.toggle("slide",{direction:"down"},250,function(){tabPanel.css("border-top","1px solid #D1D1D1"),"function"==typeof callback&&callback()})},hideTabControl:function(callback){var tabPanel=this.elements.tabPanel;logger.trace("hideTabControl - fired"),tabPanel.stop(!0,!0),"block"===tabPanel.css("display")&&tabPanel.toggle("slide",{direction:"down"},250,function(){tabPanel.css("border-top",""),"function"==typeof callback&&callback()})},toggleTabControl:function(tab,callBack){var tabPanel=this.elements.tabPanel,homePanel=this.elements.homePagePanel;logger.trace("toggleTabControl - fired"),IC_Common.unselectButton(this.elements.tabDialpadIconDiv,this.elements.tabDialpadIconImg,this.resourceBase+"/css/images/hp-sm-phone.png"),this.elements.tabAgentsIconDiv.removeClass("btnDivSelect"),this.elements.tabSkillsIconDiv.removeClass("btnDivSelect"),this.elements.tabAddressBookIconDiv.removeClass("btnDivSelect"),this.elements.tabHistoryIconDiv.removeClass("btnDivSelect"),this.elements.tabPromiseKeeperIconDiv.removeClass("btnDivSelect"),this.elements.tabEvolveScheduleIconDiv.removeClass("btnDivSelect"),this.elements.tabMessageIconDiv.removeClass("btnDivSelect"),homePanel.css("border-top","1px solid #D1D1D1"),tabPanel.css("border-top",""),homePanel.toggle("slide",{direction:"down"},250,function(){"block"===homePanel.css("display")&&homePanel.css("border-top","")}),tabPanel.toggle("slide",{direction:"down"},250,function(){"block"===tabPanel.css("display")&&tabPanel.css("border-top","1px solid #D1D1D1"),void 0!==tab&&null!==tab&&(tab.addClass("btnDivSelect"),tab.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton)),"function"==typeof callBack&&callBack()})},viewPromiseKeeperDetails:function(data,isEvolve){logger.trace("viewPromiseKeeperDetails "),this.showTabControl(),this.switchTab("promiseKeeperDetails"),this.elements.promiseKeeperDetailsControl.promiseKeeperDetails("refresh",data,AgentConsoleDataStore.agentSkillList,isEvolve)},getServerTimestamp:function(){return AgentConsoleDataStore.getServerTimestamp()},createTask:function(notesResult){var contact=null,len=AgentConsoleDataStore.contacts.length,contactId=this.contactResultPanel.contactResult("getContactId");for(logger.trace("ContactID: "+contactId," createTask"),AgentConsoleDataStore.addJob({id:IC_Common.generateUniqueId("job"),type:"CreateTask",data:{contactId:contact.id,contact:contact,notesResult:notesResult},sync:!0}),i=0;i<len;i++)if((contact=AgentConsoleDataStore.contacts[i]).id===contactId){"Disconnected"===contact.status&&!1===contact.finalState&&IC_Validation.isNotNullOrEmpty(notesResult.disp)&&"WorkItemContactEvent"===contact.contactType&&AgentConsoleDataStore.setDisposition(contactId,disposition.disp,notesResult.notes);break}},setDisposition:function(contactId,notesResult,callbackNumber){logger.debug("ContactID: "+contactId," Setting disposition for dialer");var contact=null,len=AgentConsoleDataStore.contacts.length,secDispId="";for(i=0;i<len&&(contact=AgentConsoleDataStore.contacts[i]).id!==contactId;i++);IC_Validation.isValidObject(contact)&&("CallContactEvent"===contact.contactType&&this.isNaturalCall(contact)?(IC_Validation.isNotNullOrUndefinedString(callbackNumber)||(callbackNumber=contact.inbound?contact.ani:contact.dnis),AgentConsoleDataStore.setDisposition(contactId,notesResult.disp.id,"",notesResult.dispPayload,callbackNumber,notesResult.notes,"Dialer")):(IC_Validation.isNotNullOrUndefinedString(notesResult.secDisp)&&(secDispId=notesResult.secDisp.id),AgentConsoleDataStore.setDisposition(contactId,notesResult.disp.id,secDispId,"","",notesResult.notes,"Regular")))},pcPreviewNotesUpdate:function(data,isSet){$.grep(AgentConsoleDataStore.contacts,function(item){return"ClickToCall"===item.deliveryType||"TenDigitDialAuto"===item.deliveryType||"TenDigitDial"===item.deliveryType}).length>0&&(isSet?AgentConsoleDataStore.pcPreviewNotesUpdate(data):this.acceptRejectPanel&&this.acceptRejectPanel.pcAcceptRejectControl?this.acceptRejectPanel.pcAcceptRejectControl("updatePreviewNotes",AgentConsoleDataStore.pcPreviewNotes):IC_Validation.isValidObject(AgentConsoleDataStore.pcPreviewNotes)&&this.activeContactWidgets[AgentConsoleDataStore.pcPreviewNotes.contactId]&&this.activeContactWidgets[AgentConsoleDataStore.pcPreviewNotes.contactId].sideBarCallControl("updatePreviewNotes",AgentConsoleDataStore.pcPreviewNotes))},contactResultChanged:function(contactId,changedData,value){logger.trace("ContactID: "+contactId," contactResultChanged"),AgentConsoleDataStore.contactResultUpdate(contactId,changedData,value)},doScreenPop:function(url,type){logger.trace("doScreenPop - url :"+url),AgentConsoleDataStore.doScreenPop(url,"",type)},onSelectRelatedLst:function(type,id){},getRemainingContentSpace:function(){var contactId,contacts=AgentConsoleDataStore.getNonParkedContacts(),contentPanelHeight=415,contactHeight=0,calcHeight=163,voiceMailWidget=null;for(contactId in contentPanelHeight=!0===this.isDialerPanel?contentPanelHeight-29:contentPanelHeight,contentPanelHeight=!0===this.showIndicator?contentPanelHeight-24:contentPanelHeight,this.activeContactWidgets)if(this.activeContactWidgets.hasOwnProperty(contactId)&&IC_Validation.isNotNullOrUndefinedString(contactId))try{var contact=null;if("CallContactEvent"===this.activeContactTypes[contactId])if(contact=this.activeContactWidgets[contactId].sideBarCallControl("getContact"),this.isNaturalCall(contact)){if(IC_Validation.isNotNullOrUndefinedString(contact.otherInfo)){var otherInfo;otherInfo=IC_Common.getFormatOtherInfo(contact.otherInfo),IC_Validation.isNotNullOrUndefinedString(otherInfo)&&otherInfo.valueOne.length>0&&0==otherInfo.valueTwo.length&&!IC_Validation.isNotNullOrUndefinedString(otherInfo.valueTwo[1])&&(contentPanelHeight+=22)}contactHeight+=103,contactHeight="NaturalCallAMD"===contact.status?contactHeight+26:contactHeight}else contactHeight+=52;else"VoiceMailContactEvent"===this.activeContactTypes[contactId]?(voiceMailWidget=this.activeContactWidgets[contactId],contacts.length>1?(contentPanelHeight=contentPanelHeight,contactHeight+=78,voiceMailWidget.sideBarVoiceMailControl("hideVMControlPnl")):(contentPanelHeight+=30,contactHeight+=105,voiceMailWidget.sideBarVoiceMailControl("showVMControlPnl"))):"EmailContactEvent"===this.activeContactTypes[contactId]?(contact=this.activeContactWidgets[contactId].sideBarEmailControl("getContact"),contacts.length>1&&("Interrupted"!==contact.status&&contact.isInbound?contentPanelHeight-=88:contentPanelHeight=contentPanelHeight),contactHeight+=50):contactHeight+=52}catch(e){logger.error("getRemainingContentSpace() - Error while calculating contact height:"+e.message)}IC_Validation.isValidObject(this.acceptRejectPanel)?calcHeight+=contactHeight:calcHeight=contactHeight;var height=contentPanelHeight-(25+calcHeight+25+38+this.indicatorHt+30);return logger.trace("getRemainingContentSpace - height :"+height),height},changeBtnStateOnWorkItemTransfer:function(isTransferClicked,transferType){logger.trace("changeBtnStateOnWorkItemTransfer - Transfer clicked :"+isTransferClicked+", Type :"+transferType),!0===isTransferClicked&&"Chat"===transferType?(IC_Common.disableButton(this.elements.tabDialpadIconDiv,"",""),IC_Common.disableButton(this.elements.tabHistoryIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentInfoIconDiv,"",""),IC_Common.disableButton(this.elements.tabAddressBookIconDiv,"",""),IC_Common.disableButton(this.elements.tabPromiseKeeperIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentReportsIconDiv,"",""),IC_Common.disableButton(this.elements.tabEvolveScheduleIconDiv,"",""),IC_Common.disableButton(this.elements.tabMessageIconDiv,"",""),this.elements.tabDialpadIconDiv.off("click"),this.elements.tabHistoryIconDiv.off("click"),this.elements.tabAgentInfoIconDiv.off("click"),this.elements.tabAddressBookIconDiv.off("click"),this.elements.tabPromiseKeeperIconDiv.off("click"),this.elements.tabAgentReportsIconDiv.off("click"),this.elements.tabEvolveScheduleIconDiv.off("click"),this.elements.tabMessageIconDiv.off("click")):!0===isTransferClicked&&"E-Mail"===transferType?(IC_Common.disableButton(this.elements.tabDialpadIconDiv,"",""),IC_Common.disableButton(this.elements.tabHistoryIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentInfoIconDiv,"",""),IC_Common.disableButton(this.elements.tabAddressBookIconDiv,"",""),IC_Common.disableButton(this.elements.tabPromiseKeeperIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentReportsIconDiv,"",""),IC_Common.disableButton(this.elements.tabEvolveScheduleIconDiv,"",""),IC_Common.disableButton(this.elements.tabMessageIconDiv,"",""),this.elements.tabDialpadIconDiv.off("click"),this.elements.tabHistoryIconDiv.off("click"),this.elements.tabAgentInfoIconDiv.off("click"),this.elements.tabAddressBookIconDiv.off("click"),this.elements.tabPromiseKeeperIconDiv.off("click"),this.elements.tabAgentReportsIconDiv.off("click"),this.elements.tabEvolveScheduleIconDiv.off("click"),this.elements.tabMessageIconDiv.off("click")):!0===isTransferClicked&&"VoiceMail"===transferType?(IC_Common.disableButton(this.elements.tabDialpadIconDiv,"",""),IC_Common.disableButton(this.elements.tabHistoryIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentInfoIconDiv,"",""),IC_Common.disableButton(this.elements.tabAddressBookIconDiv,"",""),IC_Common.disableButton(this.elements.tabPromiseKeeperIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentReportsIconDiv,"",""),IC_Common.disableButton(this.elements.tabEvolveScheduleIconDiv,"",""),IC_Common.disableButton(this.elements.tabMessageIconDiv,"",""),this.elements.tabDialpadIconDiv.off("click"),this.elements.tabHistoryIconDiv.off("click"),this.elements.tabAgentInfoIconDiv.off("click"),this.elements.tabAddressBookIconDiv.off("click"),this.elements.tabPromiseKeeperIconDiv.off("click"),this.elements.tabAgentReportsIconDiv.off("click"),this.elements.tabEvolveScheduleIconDiv.off("click"),this.elements.tabMessageIconDiv.off("click")):isTransferClicked?(IC_Common.disableButton(this.elements.tabDialpadIconDiv,"",""),IC_Common.disableButton(this.elements.tabAddressBookIconDiv,"",""),IC_Common.disableButton(this.elements.tabHistoryIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentInfoIconDiv,"",""),IC_Common.disableButton(this.elements.tabPromiseKeeperIconDiv,"",""),IC_Common.disableButton(this.elements.tabAgentReportsIconDiv,"",""),IC_Common.disableButton(this.elements.tabEvolveScheduleIconDiv,"",""),IC_Common.disableButton(this.elements.tabMessageIconDiv,"",""),this.elements.tabDialpadIconDiv.off("click"),this.elements.tabAddressBookIconDiv.off("click"),this.elements.tabHistoryIconDiv.off("click"),this.elements.tabAgentInfoIconDiv.off("click"),this.elements.tabPromiseKeeperIconDiv.off("click"),this.elements.tabAgentReportsIconDiv.off("click"),this.elements.tabEvolveScheduleIconDiv.off("click"),this.elements.tabMessageIconDiv.off("click")):(this.enableHpDialIcon&&!0!==this.isEmailContact()&&!0!==this.isChatContactPanel?(IC_Common.enableButton(this.elements.tabDialpadIconDiv,"",""),this.elements.tabDialpadIconDiv.on("click",$.proxy(this.onClickTabDialPad,this))):(IC_Common.disableButton(this.elements.tabDialpadIconDiv,"",""),this.elements.tabDialpadIconDiv.off("click")),IC_Common.enableButton(this.elements.tabAddressBookIconDiv,"",""),IC_Common.enableButton(this.elements.tabHistoryIconDiv,"",""),IC_Common.enableButton(this.elements.tabAgentInfoIconDiv,"",""),IC_Common.enableButton(this.elements.tabPromiseKeeperIconDiv,"",""),IC_Common.enableButton(this.elements.tabAgentReportsIconDiv,"",""),IC_Common.enableButton(this.elements.tabEvolveScheduleIconDiv,"",""),IC_Common.enableButton(this.elements.tabMessageIconDiv,"",""),this.elements.tabAddressBookIconDiv.on("click",$.proxy(this.onClickTabAddressBooks,this)),this.elements.tabHistoryIconDiv.on("click",$.proxy(this.onClickTabContactHistory,this)),this.elements.tabAgentInfoIconDiv.on("click",$.proxy(this.onClickTabAgentInfo,this)),this.elements.tabPromiseKeeperIconDiv.on("click",$.proxy(this.onClickTabPromiseKeeper,this)),this.elements.tabAgentReportsIconDiv.on("click",$.proxy(this.onClickTabAgentReports,this)),this.elements.tabEvolveScheduleIconDiv.on("click",$.proxy(this.onClickTabEvolveSchedule,this)),this.elements.tabMessageIconDiv.on("click",$.proxy(this.onClickTabMessage,this)))},isIndicatorVisible:function(){if(logger.trace("isIndicatorVisible - showIndicator"+this.showIndicator+", isChatContactPanel"+this.isChatContactPanel),this.showIndicator&&!0===this.isChatContactPanel)for(var contactId in logger.trace("isIndicatorVisible"),this.activeContactWidgets)if(this.activeContactWidgets.hasOwnProperty(contactId)){var chatWidget=this.activeContactWidgets[contactId];chatWidget.data("AgentConsoleSideBarChatControl")&&chatWidget.sideBarChatControl("updateChatHeight",!0)}},resetAgentSkillListSize:function(){logger.trace("resetAgentSkillListSize"),this.isWorkItemTransferClicked=!1,this.isVoiceMailTransferClicked=!1,this.topPadding=0,this.elements.agentListControl.css("top",this.topPadding+"px"),this.elements.agentListControl.agentList("resetCSSToOriginal"),this.elements.skillListControl.skillList("resetFlag"),this.elements.skillListControl.css("top",this.topPadding+"px"),this.elements.skillListControl.skillList("resetCSSToOriginal")},isNaturalCall:function(contact){var isNaturalCall=!1;return"NaturalCalling"===contact.type&&(isNaturalCall=!0),isNaturalCall},destroy:function(){},canScreenpopForNaturalCall:function(contact){var isScreenPop=!1,skillId=contact.skillId,skillObj=AgentConsoleDataStore.allSkillList[skillId];return IC_Validation.isValidObject(skillObj)&&(isScreenPop="Active"===contact.status&&("Active"===skillObj.screenPopTriggerEvent||"Connect"===skillObj.screenPopTriggerEvent)||"Connect"===skillObj.screenPopTriggerEvent&&"NaturalCallAMD"===contact.status&&!0===contact.linked||"Linked"===skillObj.screenPopTriggerEvent&&!0===contact.linked,logger.debug("ContactID: "+contact.id," canScreenpopForNaturalCall : Skill ScreenPopTriggerEvent -"+skillObj.screenPopTriggerEvent+" isScreenPop-"+isScreenPop)),isScreenPop},getEmailContact:function(){var emailContact=null;if(AgentConsoleDataStore.contacts.length>0){var i=0;for(i=0;i<AgentConsoleDataStore.contacts.length;i++){var contact=AgentConsoleDataStore.contacts[i];if("EmailContactEvent"===contact.contactType&&("Disconnected"!==contact.status&&"Parked"!==contact.status||!0!==contact.finalState)){emailContact=contact;break}}}return emailContact},getSkillAgents:function(skillId,callback){AgentConsoleDataStore.getSkillAgents(skillId,callback)},getSkillDetails:function(skillId,callback){AgentConsoleDataStore.getSkillDetails(skillId,callback)},parkEmail:function(contact){var that=this;AgentConsoleDataStore.parkPopoutEmail(contact,function(){that.forceDestroyPersonalQueueParkedEmail(that.activeContactWidgets,contact.contactId)})},onParkEmailLimitValidation:function(){var message;message=[{message:"Maximum Inbox size has been exceeded.",levelCss:"iMsg"}],this.showPopup(0,message,1e4)},addCallCommitment:function(callInfo){var that=this,sfResult=AgentConsoleDataStore.getSfResult(callInfo.id),canPopulateFirstandLastName=!1,record={};function getPromiseKeeperRecord(firstName,lastName){return{firstName:firstName||"",lastName:lastName||"",target:"A",dialNumber:callInfo.inbound?callInfo.ani:callInfo.dnis,skillId:callInfo.inbound?that.obPhoneSkillsList[0].id:callInfo.skillId,notes:"",callbackTime:(new Date).getTime()}}function showPromiseKeeper(record){that.viewPromiseKeeperDetails(record,!1),that.elements.promiseKeeperDetailsControl.promiseKeeperDetails("editView");var onPromiseHide=that.hidePromiseKeeperDetails;that.hidePromiseKeeperDetails=function(){that.hidePromiseKeeperDetails=onPromiseHide,that.hidePromiseKeeperDetails(function(){that.showHomeOrContactsRootPanel()})}}sfResult&&(sfResult.task.who?"003"===sfResult.task.who.substring(0,3)?record={id:sfResult.task.who,objectType:"Contact"}:"00Q"===sfResult.task.who.substring(0,3)&&(record={id:sfResult.task.who,objectType:"Lead"}):record=function(sfResult){if(sfResult.results&&sfResult.results.result){for(var record,records=sfResult.results.result,keys=Object.keys(records),contactorLeadRecordIds=[],idx=0,length=keys.length;idx<length;idx++){record=records[keys[idx]];var recordType="Lightning"===AgentConsoleDataStore.sfMode?record.RecordType:record.object;"contact"!=recordType.toLowerCase()&&"lead"!=recordType.toLowerCase()||contactorLeadRecordIds.push({id:keys[idx],objectType:recordType})}if(1==contactorLeadRecordIds.length)return contactorLeadRecordIds[0]}}(sfResult),record&&AgentConsoleDataStore.getFirstandLastName(record.id,record.objectType,function(result){IC_Validation.isNotNullOrUndefinedString(result)&&(canPopulateFirstandLastName=!0,showPromiseKeeper(getPromiseKeeperRecord(result.FirstName,result.LastName)))})),0==canPopulateFirstandLastName&&showPromiseKeeper(getPromiseKeeperRecord("",""))},hasOutBoundPhoneSkill:function(){return this.enableHpDialIcon},isTagsAssigned:function(skillId){return AgentConsoleDataStore.isTagsAssigned(skillId)},updateTagsforContact:function(contact){AgentConsoleDataStore.tags.updateContact(contact),this.updateTagsforContactUI(contact)},updateTagsforContactUI:function(contact){var callWidget=this.activeContactWidgets[contact.id];IC_Validation.isValidObject(callWidget)&&("CallContactEvent"===contact.contactType?callWidget.sideBarCallControl("updateTagsContent",contact):"VoiceMailContactEvent"===contact.contactType?callWidget.sideBarVoiceMailControl("updateTagsContent",contact):"ChatContactEvent"===contact.contactType?callWidget.sideBarChatControl("updateTagsContent",contact):"WorkItemContactEvent"===contact.contactType?callWidget.sideBarWorkItemControl("updateTagsContent",contact):"EmailContactEvent"===contact.contactType&&callWidget.sideBarEmailControl("updateTagsContent",contact))},onSkillTagsUpdate:function(){var contact=this.getFirstContactForContactResult(),_length=AgentConsoleDataStore.contacts.length,lastContact=AgentConsoleDataStore.contacts[_length-1];if(IC_Validation.isNotNullOrEmpty(contact)&&IC_Validation.isNotNullOrEmpty(lastContact)&&this.isTagsAssigned(contact.skillId)){var callWidget=this.activeContactWidgets[lastContact.id];IC_Validation.isValidObject(callWidget)&&("CallContactEvent"===lastContact.contactType?callWidget.sideBarCallControl("updateTagsContent",contact):"VoiceMailContactEvent"===lastContact.contactType&&"Active"===contact.status?callWidget.sideBarVoiceMailControl("updateTagsContent",contact):"ChatContactEvent"===lastContact.contactType?callWidget.sideBarChatControl("updateTagsContent",contact):"WorkItemContactEvent"===lastContact.contactType?callWidget.sideBarWorkItemControl("updateTagsContent",contact):"EmailContactEvent"===lastContact.contactType&&callWidget.sideBarEmailControl("updateTagsContent",contact))}},isAllTagsAddedtoContact:function(contactId){return AgentConsoleDataStore.tags.isAllTagsAddedtoContact(contactId)},onTagsUpdatedContactEvent:function(){var contactId=AgentConsoleDataStore.tagsUpdatedContact.contactId,contacts=$.grep(AgentConsoleDataStore.contacts,function(item){if(item.id==contactId)return item});if(contacts.length>0){var contact=contacts[0];this.updateTagsforContactUI(contact)}},updateContactResult:function(contact){var _contact=this.getFirstContactForContactResult();IC_Validation.isValidObject(_contact)?this.updateContactResultNotesPanel(_contact):null!==AgentConsoleDataStore.sfResult&&IC_Validation.isNotNullOrEmptyArray(AgentConsoleDataStore.sfResult)&&AgentConsoleDataStore.removeContactResult(contact.id)},enableResultsNotes:function(contact){if("Discarded"!==contact.status&&"Disconnected"!==contact.status&&!1===contact.finalState){contact.id,AgentConsoleDataStore.lastDispContactId;if(this.activeContactWidgets.hasOwnProperty(contact.id)){var contactWidget=this.activeContactWidgets[contact.id];"EmailContactEvent"===contact.contactType||("VoiceMailContactEvent"===contact.contactType?contactWidget.sideBarVoiceMailControl("recordResultNotesPanel",contact):"CallContactEvent"===contact.contactType?contactWidget.sideBarCallControl("recordResultNotesPanel",contact):"WorkItemContactEvent"===contact.contactType&&contactWidget.sideBarWorkItemControl("recordResultNotesPanel",contact))}}},updateContactResultNotesPanel:function(contact){logger.trace("updateContactResultNotesPanel");AgentConsoleDataStore.agentInfo;var isScreenPop=!0;if(IC_Validation.isValidObject(contact)){var skill=AgentConsoleDataStore.allSkillList[contact.skillId];if("Discarded"!==contact.status&&"Disconnected"!==contact.status||!1!==contact.finalState||!IC_Validation.isValidObject(skill)||!0!==skill.useDisposition&&!0!==skill.reqDisposition){if(this.isNaturalCall(contact)&&("Preview"===contact.status||"NaturalCallDialing"===contact.status||"NaturalCallRinging"===contact.status||"NaturalCallAMD"===contact.status)){isScreenPop=!1;IC_Validation.isNotNullOrEmpty(contact.screenPopUrl)?(isScreenPop=this.canScreenpopForNaturalCall(contact),logger.debug("ContactID: "+contact.id," updateContactResult isScreenPop:"+isScreenPop)):contact.linked&&(isScreenPop=!0)}}else{var isDispSumbit=contact.id===AgentConsoleDataStore.lastDispContactId,contactWidget=this.activeContactWidgets[contact.id];if("ChatContactEvent"!==contact.contactType&&"EmailContactEvent"!==contact.contactType)1==this.getContactsCount()&&(!1===isDispSumbit?"CallContactEvent"===contact.contactType?contactWidget.sideBarCallControl("createDispositionPanel",contact,skill):"VoiceMailContactEvent"===contact.contactType?contactWidget.sideBarVoiceMailControl("createDispositionPanel",contact,skill):"WorkItemContactEvent"===contact.contactType&&contactWidget.sideBarWorkItemControl("createDispositionPanel",contact,skill):!0===isDispSumbit&&("CallContactEvent"===contact.contactType?contactWidget.sideBarCallControl("destroyContactResultPanel"):"VoiceMailContactEvent"===contact.contactType?contactWidget.sideBarVoiceMailControl("destroyContactResultPanel"):"WorkItemContactEvent"===contact.contactType&&contactWidget.sideBarWorkItemControl("destroyContactResultPanel")));else"EmailContactEvent"===contact.contactType&&!0===isDispSumbit&&contactWidget.sideBarEmailControl("destroyContactResultPanel")}}("Discarded"!==contact.status&&"Disconnected"!==contact.status&&"Parked"!==contact.status||!0!==contact.finalState)&&"Interrupted"!==contact.status&&this.getContactResults(contact,isScreenPop)},getContactsCount:function(){var contact,nonParkedContacts=AgentConsoleDataStore.getNonParkedContacts(),count=0;if(nonParkedContacts.length>0)for(var i=0;i<nonParkedContacts.length;i++)"CallContactEvent"!==(contact=nonParkedContacts[i]).contactType&&"VoiceMailContactEvent"!==contact.contactType&&"WorkItemContactEvent"!==contact.contactType||count++;return count},updateContactResultPnl:function(){this.onContactResultListUpdate()},populateDispInResultNotes:function(dispositions,secDisposition){var isAmount,isDate,filteredList=[],primDisposition=[];if(this.disposition=dispositions,primDisposition=IC_Validation.isNotNullOrUndefinedString(secDisposition)?dispositions.filter(function(item){return item.id!==secDisposition.id&&!1===item.isPreviewDisposition}):dispositions.filter(function(item){return!1===item.isPreviewDisposition}),IC_Validation.isNotNullOrEmptyArray(primDisposition)){for(var i=0;i<primDisposition.length;i++){isAmount=!1,isDate=!1,IC_Validation.isNullOrEmpty(primDisposition[i].isAmount)||(isAmount=primDisposition[i].isAmount,isDate=primDisposition[i].isDate);var obj={id:primDisposition[i].id,value:primDisposition[i].name,order:primDisposition[i].order,isPreviewDisposition:primDisposition[i].isPreviewDisposition,isAmount:isAmount,isDate:isDate};filteredList.push(obj)}filteredList.sort(function(a,b){return a.order-b.order}),this.dispSelect.comboBox("setStore",filteredList)}},populateSecDispInResultNotes:function(dispositions,selectedDisposition){var isAmount,isDate,secDisposition,i=0,filteredList=[];if(this.secDisposition=dispositions.filter(function(item){return item.id!==selectedDisposition.id&&!1===item.isPreviewDisposition}),secDisposition=this.secDisposition,IC_Validation.isNotNullOrEmptyArray(secDisposition)){for(i=0;i<secDisposition.length;i++){isAmount=!1,isDate=!1,IC_Validation.isNullOrEmpty(secDisposition[i].isAmount)||(isAmount=secDisposition[i].isAmount,isDate=secDisposition[i].isDate);var obj={id:secDisposition[i].id,value:secDisposition[i].name,order:secDisposition[i].order,isAmount:isAmount,isPreviewDisposition:secDisposition[i].isPreviewDisposition,isDate:isDate};filteredList.push(obj)}filteredList.sort(function(a,b){return a.order-b.order}),this.secDispSelect.comboBox("setStore",filteredList)}else this.secDispSelect.comboBox("setStore",filteredList)},getChatContact:function(){var chatContact=null;if(AgentConsoleDataStore.contacts.length>0){var i=0;for(i=0;i<AgentConsoleDataStore.contacts.length;i++){var contact=AgentConsoleDataStore.contacts[i];if("ChatContactEvent"===contact.contactType&&("Disconnected"!==contact.status||!0!==contact.finalState)){chatContact=contact;break}}}return chatContact},updateResultNotesDisposition:function(sfResult,disposition){sfResult.task.disp,sfResult.task.secDisp;var _len=AgentConsoleDataStore.contacts.length,_con=AgentConsoleDataStore.contacts[_len-1],callWidget=this.activeContactWidgets[_con.id];IC_Validation.isValidObject(callWidget)&&"CallContactEvent"===_con.contactType&&callWidget.sideBarCallControl("showContactResult")},onGetBUFeaturesList:function(){if(AgentConsoleDataStore.isEvolve())for(i=0;i<AgentConsoleDataStore.featuresList.length;i++)105==AgentConsoleDataStore.featuresList[i].productId&&1==AgentConsoleDataStore.featuresList[i].isEnabled&&AgentConsoleDataStore.connectScreenAgent(),102==AgentConsoleDataStore.featuresList[i].productId&&1==AgentConsoleDataStore.featuresList[i].isEnabled&&(this.isEvolveWFMEnabled=!0),103==AgentConsoleDataStore.featuresList[i].productId&&1==AgentConsoleDataStore.featuresList[i].isEnabled&&(this.isEvolveQMEnabled=!0),1001==AgentConsoleDataStore.featuresList[i].productId&&1==AgentConsoleDataStore.featuresList[i].isEnabled&&(this.isCXonePMEnabled=!0),(this.isEvolveWFMEnabled||this.isEvolveQMEnabled)&&AgentConsoleDataStore.startWS(),this.isEvolveWFMEnabled||this.isEvolveQMEnabled||this.isCXonePMEnabled?(this.elements.HomeScheduleIconDiv.showfn(),this.elements.tabEvolveScheduleIconDiv.showfn()):(this.elements.HomeScheduleIconDiv.hide(),this.elements.tabEvolveScheduleIconDiv.hide())},openWFM:function(wfoURL){var wfoVfPage=location.protocol+"//"+location.host+"/apex/"+this.options.sfNamespace+"__wfo";AgentConsoleDataStore.openWfo(wfoVfPage,wfoURL)},updateEvolveNotifications:function(agentMessage){AgentConsoleDataStore.updateEvolveNotifications(agentMessage)},clearFlashMsgTimer:function(){this.elements.agentMsgScroll.agentMessageScroll("clearFlashMsgTimer")},WebRTCStatusChangedEvent:function(event,data){var message=null,timeout=null;switch(data.status){case webRTC.statusMessages.custom_initializingAudioCode:message={message:"<div style='text-align: center'>"+('<img class="softPhoneMegIcon" id="softPhoneMegIcon" src="'+this.resourceBase+'/css/images/softPhoneLoading.svg"/>')+"</div>"+IC_Localization.softphoneInitialize,levelCss:"iMsg"};break;case webRTC.statusMessages.custom_connectingAgentLeg:message={message:"<div style='text-align: center'>"+('<img class="softPhoneMegIcon" id="softPhoneMegIcon" src="'+this.resourceBase+'/css/images/softPhoneLoading.svg"/>')+"</div>"+IC_Localization.softphoneAgentLegConnect,levelCss:"iMsg"};break;case webRTC.statusMessages.ac_loginfailed:message={message:IC_Localization.softphoneLoginFailed,levelCss:"eMsg"};break;case webRTC.statusMessages.validation_speakerMicMissing:message={message:IC_Localization.softphoneMediaDeviceMissing,levelCss:"eMsg"},timeout=1e4;break;case webRTC.statusMessages.validation_mediaDeviceAccessDenied:message={message:IC_Localization.softphoneMediaAccessDenied,levelCss:"eMsg"},timeout=1e4;break;case webRTC.statusMessages.ac_callTerminated:lastWebRTCStatus==webRTC.statusMessages.custom_connectingAgentLeg?(message={message:IC_Localization.softphoneAgentLegCallFailed,levelCss:"eMsg"},timeout=5e3):this.hidePopup();break;case webRTC.statusMessages.ac_connected:case webRTC.statusMessages.ac_disconnected:case webRTC.statusMessages.ac_logout:case webRTC.statusMessages.ac_callConfirmed:this.hidePopup()}lastWebRTCStatus=data.status,message&&this.showPopup(0,[message],timeout)},onSoftPhoneVolumeChange:function(volume){this.createAudioElement(),this.elements.audioElement.prop("volume",volume)},getSoftPhoneVolume:function(){return IC_Validation.isValidObject(this.elements.audioElement)?this.elements.audioElement[0].volume:this.defaultSoftPhoneVolume},makeWebRTCAgentLegCall:function(){webRTC.connectAgentLeg(this.agentInfo.lgId)},endAgentLeg:function(){AgentConsoleDataStore.endAgentLeg()},onAgentLegAcceptRejectActionsEvent:function(){"accept"==AgentConsoleDataStore.agentLegAcceptRejectActions?(this.makeWebRTCAgentLegCall(),AgentConsoleDataStore.clearAgentLegAcceptRejectActions(),webRTC.stopAudioNotification()):"reject"==AgentConsoleDataStore.agentLegAcceptRejectActions&&(this.endAgentLeg(),AgentConsoleDataStore.clearAgentLegAcceptRejectActions(),webRTC.stopAudioNotification())}})}(jQuery);