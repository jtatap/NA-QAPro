!function($){var logger=IC_Common.getLogger("BaseContainer");$.widget("AgentConsole.baseContainer",{options:{},tabPriority:{CallContactEvent:0,ChatContactEvent:1,EmailContactEvent:2,VoiceMailContactEvent:3,WorkItemContactEvent:4},activeContactTypes:{},activeContactWidgets:{},parkedContactWidgets:{},callContacts:[],chatContacts:[],emailContacts:[],voiceMailContacts:[],workItemContacts:[],allCallContacts:[],parkedEmailList:[],noQueueParkedEmailList:[],toAddress:"",createBaseControls:function(){this.emailWidgetName=this.options.isPopout?"emailContactControl":"sideBarEmailControl",this.elements.emailListControlPanel=$('<div id="emailSidebarId"/>').emailListControl({container:this,resourceBase:this.options.resourceBase,isPopout:this.options.isPopout,emailWidget:this.emailWidgetName}),this.elements.multiCallControl=$('<div class="multiCallCtrl"/>').multiCallControl({container:this,resourceBase:this.options.resourceBase,addState:"enabled",muteState:"disabled",keyPadState:"enabled",transferState:"disabled",conferenceState:"disabled",popoutState:"disabled",ctrlType:"CallContactEvent"})},initializeBase:function(){$(document).on(AgentConsoleDataStore.ParkedEmailDetailsEvent,$.proxy(this.onParkedEmailDetailsUpdate,this)),$(document).on(AgentConsoleDataStore.SkillRunningLowEvent,$.proxy(this.onSkillRunningLowUpdate,this)),$(document).on(AgentConsoleDataStore.ContactEvent,$.proxy(this.onContactUpdate_Base,this)),$(document).on(AgentConsoleDataStore.AgentSessionEndEvent,$.proxy(this.onAgentSessionEnd_Base,this)),$(document).on(AgentConsoleDataStore.MaxConferenceHandleEvent,$.proxy(this.onMaxConferenceHandleUpdate,this)),$(document).on(AgentConsoleDataStore.PermissionsListEvent,$.proxy(this.onPermissionsListUpdate,this)),$(document).on(AgentConsoleDataStore.OmniChannelReadyStateChangedEvent,$.proxy(this.onOmniChannelReadyStateChanged,this)),$(document).on(AgentConsoleDataStore.agentLegAcceptRejectActionsEvent,$.proxy(this.onAgentLegAcceptRejectActionsEvent_Base,this))},onAcceptRejectPanelShow:function(contact){this.showMediaTab()},onNewContactWidgetCreated:function(contact){this.showMediaTab()},showMediaTab:function(){this.elements.contactsRootPanel.stop(!0,!0),this.options.isPopout?(this.showContactsRootPanel(),this.hideAllTabs()):"none"===this.elements.contactsRootPanel.css("display")&&(this.showContactsRootPanel(),this.hideAllTabs())},onAgentSessionEnd_Base:function(){for(var id in this.parkedContactWidgets)this.parkedContactWidgets.hasOwnProperty(id)&&this.clearWidgetfromUI(this.parkedContactWidgets,id);this.parkedContactWidgets={}},onContactUpdate_Base:function(){AgentConsoleDataStore.contacts.sort(function(a,b){var firstTime=new Date(a.time).getTime(),secondTime=new Date(b.time).getTime();return firstTime<secondTime?-1:firstTime>secondTime?1:0})},isTabNeedToShow:function(){return AgentConsoleDataStore.getNonParkedContactsCount()>0||this.noQueueParkedEmailList.length>0||!1===AgentConsoleDataStore.isSkillRunningLow||this.isPCQueueContactActive||IC_Validation.isValidObject(this.acceptRejectPanel)||IC_Validation.isNotNullOrEmpty(this.agentInfo.dialerCampaign)},setFocusMediaTab:function(topPriority){var that=this;0==topPriority?this.showPhoneContactTab():1==topPriority?this.showChatContactTab():2==topPriority?this.showEmailContactTab():3===topPriority?this.showVoiceMailContactTab():4==topPriority?this.showWorkItemContactTab():5==topPriority&&setTimeout(function(){that.isTabNeedToShow()||that.hideMediaTabControls()},2e3)},enableDisableMediaTab:function(){this.setVisibilityPhoneTab(),this.setVisibilityChatTab(),this.setVisibilityEmailTab(),this.setVisibilityVoiceMailTab(),this.setVisibilityWorkItemTab()},getTabPriorityToFocus:function(){var tabToSelect=5,contacts=Object.clone(AgentConsoleDataStore.contacts),contactsLength=contacts.length;if(contacts.sort(function(a,b){var firstTime=new Date(a.lastStateTime).getTime(),secondTime=new Date(b.lastStateTime).getTime();return firstTime>secondTime?-1:firstTime<secondTime?1:0}),contactsLength>0){var firstContact=contacts[0];tabToSelect="Interrupted"!=firstContact.status||1==contactsLength?this.tabPriority[firstContact.contactType]:this.tabPriority[contacts[1].contactType]}return tabToSelect},toggleMulticallControls_Base:function(){var contact,contacts=AgentConsoleDataStore.contacts,muteState="disabled",aInfo=AgentConsoleDataStore.agentInfo,keyPadState="disabled",topPriority=this.getTabPriorityToFocus();this.allCallContacts=[],this.allContacts=[],this.callContacts=[],this.chatContacts=[],this.emailContacts=[],this.voiceMailContacts=[],this.workItemContacts=[];for(i=0,length=contacts.length;i<length;i++)if(contact=contacts[i],this.tabPriority[contact.contactType],1!=contact.finalState)switch(this.allContacts.push(contact),contact.contactType){case"CallContactEvent":this.allCallContacts.push(contact),"Disconnected"!==contact.status&&this.callContacts.push(contact);break;case"ChatContactEvent":this.chatContacts.push(contact);break;case"EmailContactEvent":this.emailContacts.push(contact);break;case"VoiceMailContactEvent":this.voiceMailContacts.push(contact);break;case"WorkItemContactEvent":this.workItemContacts.push(contact)}var allContactsLength=this.allContacts.length;for(0==allContactsLength&&(topPriority=!1===AgentConsoleDataStore.isSkillRunningLow||this.isPCQueueContactActive?0:this.noQueueParkedEmailList.length>0?2:5),topPriority<=4&&this.elements.multiCallControl.showfn(),this.enableDisableMediaTab(),this.setFocusMediaTab(topPriority),allContactsLength>0?aInfo.enabledForMCH?IC_Common.enableButton(this.elements.tabOBEmailIconDiv,this.elements.tabOBEmailIconImg,this.resourceBase+"/css/images/mail.png"):IC_Common.disableButton(this.elements.tabOBEmailIconDiv,this.elements.tabOBEmailIconImg,this.resourceBase+"/css/images/mail-disable.png"):this.toggleHpIconEmail(),i=0;i<this.callContacts.length;i++){var status=this.callContacts[i].status;if("Active"===status||"NaturalCallAMD"===status||"Holding"===status||"Masking"===status){keyPadState="enabled";break}}this.elements.multiCallControl.multiCallControl("setVisibilitychatPopout","enabled"),this.elements.multiCallControl.multiCallControl("setVisibilityKeypad",keyPadState),0==this.callContacts.length?!0===aInfo.lgMuted&&(aInfo.lgMuted=!1,AgentConsoleDataStore.unmuteAgent()):muteState=!0===aInfo.lgMuted?"selected":"enabled",this.elements.multiCallControl.multiCallControl("setVisibilityMute",muteState),this.updateMultiCallControl_Base()},updateMultiCallControl_Base:function(){2===this.callContacts.length?(this.updateAddCallVisibility("disabled"),"Joined"===this.callContacts[0].status&&"Joined"===this.callContacts[1].status?(this.elements.multiCallControl.multiCallControl("setVisibilityEndConference","enabled"),this.elements.multiCallControl.multiCallControl("setVisibilityKeypad","enabled"),this.onMultiConferenceEnabled()):"Joined"!==this.callContacts[1].status&&this.elements.multiCallControl.multiCallControl("setVisibilityConference","enabled")):this.callContacts.length<2?(1!==this.callContacts.length||"Holding"===this.callContacts[0].status||"Preview"!==this.callContacts[0].status&&"Dialing"!==this.callContacts[0].status&&"NaturalCallRinging"!==this.callContacts[0].status&&"NaturalCallAMD"!==this.callContacts[0].status?this.enableHpDialIcon&&this.toggleHpIconDialPad():this.updateAddCallVisibility("disabled"),this.elements.multiCallControl.multiCallControl("setVisibilityConference","disabled")):this.callContacts.length>2&&"Joined"===this.callContacts[0].status&&"Joined"===this.callContacts[1].status&&"Joined"===this.callContacts[2].status&&(this.elements.multiCallControl.multiCallControl("setVisibilityKeypad","enabled"),this.elements.multiCallControl.multiCallControl("setVisibilityEndConference","enabled"),this.onMultiConferenceEnabled());var nonConferencedConsultCalls=this.callContacts.filter(function(callContact){return"Consult"===callContact.type&&"Joined"!==callContact.status}),isTransferEnabled=this.callContacts.length>=2&&nonConferencedConsultCalls.length<=1;this.elements.multiCallControl.multiCallControl("setVisibilityTransfer",isTransferEnabled?"enabled":"disabled")},updateAddCallVisibility:function(btnState){var addCallTooltip=IC_Localization.addCall;this.toggleDialPadDiv(btnState),IC_Validation.isNotNullOrEmptyArray(this.callContacts)&&this.callContacts.length>=2&&"Joined"===this.callContacts[0].status&&"Joined"===this.callContacts[1].status&&(addCallTooltip=IC_Localization.addCalltoConference),this.elements.multiCallControl.multiCallControl("setVisibilityAdd",btnState,addCallTooltip)},onMultiConferenceEnabled:function(){var addCallBtnState="disabled";this.isMaxConferenceLimitNotReached()&&(addCallBtnState="enabled"),this.updateAddCallVisibility(addCallBtnState)},conferenceClick:function(){if(this.callContacts.length>=2)if("Joined"===this.callContacts[0].status&&"Joined"===this.callContacts[1].status){this.elements.multiCallControl.multiCallControl("setVisibilityEndConference","disabled");for(var i=1;i<this.callContacts.length;i++)this.endContact(this.callContacts[i].id)}else this.onConferenceClick(),this.elements.multiCallControl.multiCallControl("setVisibilityConference","disabled")},updateTabVisibility:function(){this.isTabNeedToShow()||this.hideContactsRootPanel()},getCurrentSelectedMediaTab:function(){return"block"===this.elements.omniContactTab.css("display")?"OmniContact":"block"===this.elements.phoneContactTab.css("display")?"Phone":"block"===this.elements.chatContactTab.css("display")?"Chat":"block"===this.elements.emailContactTab.css("display")?"Email":"block"===this.elements.voiceMailContactTab.css("display")?"VoiceMail":"block"===this.elements.workItemContactTab.css("display")?"WorkItem":void 0},setVisibilityPhoneTab:function(){var isPCContactsRunning=this.isPCQueueContactActive||0==AgentConsoleDataStore.isSkillRunningLow;IC_Validation.isNotNullOrEmptyArray(this.allCallContacts)||1==isPCContactsRunning?(this.phoneTabIcon.attr("src",this.resourceBase+"/css/images/agent-info-skills-phone.png"),this.phoneIndicateIcon.addClass("viewedContactTabIndicate"),this.enableDisableClickEvent("enable",this.phoneTabDiv),this.phoneTabDiv.off("click"),this.phoneTabDiv.on("click",$.proxy(this.showPhoneContactTab,this)),0===this.allCallContacts.length&&isPCContactsRunning?(this.phoneIndicateIcon.removeClass("newContactTabIndicate viewedContactTabIndicate"),this.phoneIndicateIcon.text("")):this.phoneIndicateIcon.text(this.allCallContacts.length)):(this.phoneTabIcon.attr("src",this.resourceBase+"/css/images/phoneIcon-disable.png"),this.enableDisableClickEvent("disable",this.phoneTabDiv),this.phoneIndicateIcon.removeClass("newContactTabIndicate viewedContactTabIndicate"),this.phoneIndicateIcon.text(""),this.disableTabBGColor(this.phoneTabDiv))},setVisibilityChatTab:function(){IC_Validation.isNotNullOrEmptyArray(this.chatContacts)?(this.chatTabIcon.attr("src",this.resourceBase+"/css/images/chatIcn-dark.png"),this.chatIndicateIcon.text(this.chatContacts.length),this.enableDisableClickEvent("enable",this.chatTabDiv),this.chatTabDiv.off("click"),this.chatTabDiv.on("click",$.proxy(this.showChatContactTab,this))):(this.chatTabIcon.attr("src",this.resourceBase+"/css/images/chatIcon-disable.png"),this.chatIndicateIcon.removeClass("newContactTabIndicate viewedContactTabIndicate"),this.enableDisableClickEvent("disable",this.chatTabDiv),this.chatIndicateIcon.text(""),this.disableTabBGColor(this.chatTabDiv))},setVisibilityEmailTab:function(){var emailContactsLength=this.emailContacts.length+this.noQueueParkedEmailList.length;emailContactsLength>0?(this.emailTabIcon.attr("src",this.resourceBase+"/css/images/mail.png"),this.emailIndicateIcon.addClass("viewedContactTabIndicate"),this.emailIndicateIcon.text(emailContactsLength),this.enableDisableClickEvent("enable",this.emailTabDiv),this.emailTabDiv.off("click"),this.emailTabDiv.on("click",$.proxy(this.showEmailContactTab,this))):(this.emailTabIcon.attr("src",this.resourceBase+"/css/images/mail-disable.png"),this.emailIndicateIcon.removeClass("newContactTabIndicate viewedContactTabIndicate"),this.enableDisableClickEvent("disable",this.emailTabDiv),this.emailIndicateIcon.text(""),this.disableTabBGColor(this.emailTabDiv))},setVisibilityVoiceMailTab:function(){IC_Validation.isNotNullOrEmptyArray(this.voiceMailContacts)?(this.voicemailTabIcon.attr("src",this.resourceBase+"/css/images/personal-connection-override-answer-machine.png"),this.voicemailIndicateIcon.addClass("viewedContactTabIndicate"),this.voicemailIndicateIcon.text(this.voiceMailContacts.length),this.enableDisableClickEvent("enable",this.voicemailTabDiv),this.voicemailTabDiv.off("click"),this.voicemailTabDiv.on("click",$.proxy(this.showVoiceMailContactTab,this))):(this.voicemailTabIcon.attr("src",this.resourceBase+"/css/images/voicemail-disable.png"),this.voicemailIndicateIcon.removeClass("newContactTabIndicate viewedContactTabIndicate"),this.enableDisableClickEvent("disable",this.voicemailTabDiv),this.voicemailIndicateIcon.text(""),this.disableTabBGColor(this.voicemailTabDiv))},setVisibilityWorkItemTab:function(){IC_Validation.isNotNullOrEmptyArray(this.workItemContacts)?(this.workItemTabIcon.attr("src",this.resourceBase+"/css/images/agent-info-skills-work-item.png"),this.workItemIndicateIcon.addClass("viewedContactTabIndicate"),this.workItemIndicateIcon.text(this.workItemContacts.length),this.enableDisableClickEvent("enable",this.workItemTabDiv),this.workItemTabDiv.off("click"),this.workItemTabDiv.on("click",$.proxy(this.showWorkItemContactTab,this))):(this.workItemTabIcon.attr("src",this.resourceBase+"/css/images/workItem-disable.png"),this.workItemIndicateIcon.removeClass("newContactTabIndicate viewedContactTabIndicate"),this.enableDisableClickEvent("disable",this.workItemTabDiv),this.workItemIndicateIcon.text(""),this.disableTabBGColor(this.workItemTabDiv))},hideSelectedMediaTabControl:function(selectedTab){"OmniContact"===selectedTab?this.elements.omniContactTab.hide():"Phone"===selectedTab?this.elements.phoneContactTab.hide():"Chat"===selectedTab?this.elements.chatContactTab.hide():"Email"===selectedTab?this.elements.emailContactTab.hide():"VoiceMail"===selectedTab?this.elements.voiceMailContactTab.hide():"WorkItem"===selectedTab&&this.elements.workItemContactTab.hide()},enableTabBGColor:function(selectedTab){this.phoneTabDiv.removeClass("selectedMediaTab"),this.voicemailTabDiv.removeClass("selectedMediaTab"),this.emailTabDiv.removeClass("selectedMediaTab"),this.chatTabDiv.removeClass("selectedMediaTab"),this.workItemTabDiv.removeClass("selectedMediaTab"),this.omniTabDiv.removeClass("selectedMediaTab"),selectedTab.addClass("selectedMediaTab").removeClass("btnDivHover")},disableTabBGColor:function(selectedTab){selectedTab.removeClass("selectedMediaTab").removeClass("btnDivHover")},onSkillRunningLowUpdate:function(){!1===AgentConsoleDataStore.isSkillRunningLow?("none"===this.elements.contactsRootPanel.css("display")&&this.showContactsRootPanel(),logger.debug("onSkillRunningLowUpdate - show"),this.element.skillRunningLow.showfn(),this.toggleMulticallControls_Base()):(this.element.skillRunningLow.hide(),logger.debug("onSkillRunningLowUpdate - hide"),this.isTabNeedToShow()?this.toggleMulticallControls_Base():("block"===this.elements.contactsRootPanel.css("display")&&this.hideContactsRootPanel(),this.options.isPopout&&(this.hideMediaTabControls(),this.setVisibilityPhoneTab())))},secondsToTime:function(seconds){var hours,mins,secs,time=":00";return null!==seconds&&void 0!==seconds&&"number"==typeof seconds?(hours=Math.floor(seconds/3600),mins=Math.floor(seconds/60)%60,secs=seconds%60,time=hours>0?hours+":"+(mins>9?mins:"0"+mins)+":"+(secs>9?secs:"0"+secs):mins<=0?":"+(secs>9?secs:"0"+secs):mins+":"+(secs>9?secs:"0"+secs)):time},startTimer:function(){var that=this;this.timeOutId=setInterval(function(){that.updateTimer()},1e3)},clearTimer:function(){void 0!==this.timeOutId&&clearInterval(this.timeOutId)},updateTimer:function(){var timeText,currentTimerVal,diff=0;IC_Validation.isNotNullOrEmpty(this.lastServerTimestamp)&&(diff=parseInt((this.getServerTimestamp()-this.lastServerTimestamp)/1e3)),timeText=(currentTimerVal=this.initialTimerVal+diff)>345600?">96 "+IC_Localization.hours:this.secondsToTime(currentTimerVal),$(".ringTimer").text(timeText)},onParkedContactUpdate:function(contacts){this.elements.emailListControlPanel.emailListControl("onParkedContactUpdate",contacts),this.updateTabVisibility(),this.toggleMulticallControls_Base()},clearWidgetfromUI:function(conainer,id){if(conainer.hasOwnProperty(id)){var widget=conainer[id];delete conainer[id],widget[this.emailWidgetName]("destroy",!0),this.elements.emailListControlPanel.emailListControl("onWidgetRemove",id)}},forceDestroyPersonalQueueParkedEmail:function(conainer,contactId){if(conainer.hasOwnProperty(contactId)){for(var i in this.clearWidgetfromUI(conainer,contactId),this.noQueueParkedEmailList)if(this.noQueueParkedEmailList[i].id===contactId){this.noQueueParkedEmailList.splice(i,1);break}for(var i in this.parkedEmailList)if(this.parkedEmailList[i].contactId===contactId){this.parkedEmailList.splice(i,1);break}AgentConsoleDataStore.parkedEmailList=this.parkedEmailList,localStorage.parkedEmailList=JSON.stringify(AgentConsoleDataStore.parkedEmailList),this.elements.emailListControlPanel.emailListControl("refreshParkedAccordianCount",this.noQueueParkedEmailList.length),this.getParkedEmailList()}},onParkedEmailDetailsUpdate:function(){this.parkedEmailList=AgentConsoleDataStore.parkedEmailList,this.noQueueParkedEmailList=[];var parkedContact,parkedStoreContact,newEmailContact,parkedContacts=AgentConsoleDataStore.parkedEmailList;if(0==parkedContacts.length)for(var id in this.parkedContactWidgets)this.forceDestroyPersonalQueueParkedEmail(this.parkedContactWidgets,id,!1);for(var i=0,length=parkedContacts.length;i<length;i++)(parkedContact=parkedContacts[i]).targetAgentId==AgentConsoleDataStore.agentInfo.id?this.forceDestroyPersonalQueueParkedEmail(this.parkedContactWidgets,parkedContact.contactId):((parkedStoreContact=this.getPreviewContactfromStore(parkedContact.contactId))?(newEmailContact=parkedStoreContact).skillName=parkedContact.skillName:newEmailContact={id:parkedContact.contactId,contactId:parkedContact.contactId,status:parkedContact.state,contactType:"EmailContactEvent",type:"Regular",skillId:parkedContact.skillId,skillName:parkedContact.skillName,isInbound:!IC_Common.toBoolean(parkedContact.isOutbound),time:new Date(parkedContact.contactStart).getTime(),lastStateTime:new Date(parkedContact.lastUpdateTime).getTime(),screenPopUrl:"",finalState:!1,fromAddress:IC_Validation.isNotNullOrUndefinedString(parkedContact.fromAddr)?parkedContact.fromAddr:"",toAddress:parkedContact.toAddr,ccAddress:"",bccAddres:"",subject:IC_Validation.isNotNullOrUndefinedString(parkedContact.subject)?parkedContact.subject:"",bodyHTML:"",body:"",sentDate:IC_Validation.isNotNullOrUndefinedString(parkedContact.contactStart)?new Date(parkedContact.contactStart).getTime():"",attachments:"",pocAddress:"",customData:"",targetAgentId:IC_Validation.isNotNullOrUndefinedString(parkedContact.targetAgentId)?parkedContact.targetAgentId:""},this.noQueueParkedEmailList.push(newEmailContact));for(var id in this.parkedContactWidgets)-1==this.noQueueParkedEmailList.indexOfKey("id",id)&&this.clearWidgetfromUI(this.parkedContactWidgets,id);this.onParkedContactUpdate(this.noQueueParkedEmailList),this.parkedContactsUpdateComplete()},getPreviewContactfromStore:function(contactId){for(var contacts=AgentConsoleDataStore.contacts,i=0,length=contacts.length;i<length;i++)if(contact=contacts[i],contact.id==contactId&&"Parked"==contact.status)return contact},getParkedEmailList:function(){AgentConsoleDataStore.getParkedEmailDetails(!0)},unParkEmail:function(contactId,isUnparkNow){var that=this;AgentConsoleDataStore.unParkEmail(contactId,isUnparkNow,function(){that.forceDestroyPersonalQueueParkedEmail(that.parkedContactWidgets,contactId)})},parkedContactsUpdateComplete:function(){},hideEmailInterruptOverlay:function(){$("#overlay").removeClass("emailInterruptOverlay"),$("#contentPnlDisableOverlay").removeClass("contentPnlDisableOverlay"),$("#widgetPnlOverlay").removeClass("contentPnlDisableOverlay")},showEmailInterruptOverlay:function(){$("#overlay").addClass("emailInterruptOverlay"),$("#contentPnlDisableOverlay").addClass("contentPnlDisableOverlay"),$("#widgetPnlOverlay").addClass("contentPnlDisableOverlay")},hideMediaTabControls:function(){var getSelected=this.getCurrentSelectedMediaTab();this.hideSelectedMediaTabControl(getSelected),this.hideContactsRootPanel(),this.elements.multiCallControl.hide(),this.options.isPopout&&(this.hideEmailInterruptOverlay(),this.hideContactResultPnl())},isEmailContact:function(){if(AgentConsoleDataStore.contacts.length>0){var isEmail=!1,i=0;for(i=0;i<AgentConsoleDataStore.contacts.length;i++){var contact=AgentConsoleDataStore.contacts[i];if("EmailContactEvent"===contact.contactType&&("Disconnected"!==contact.status&&"Parked"!==contact.status||!0!==contact.finalState)&&"Interrupted"!==contact.status){isEmail=!0;break}}return logger.info("isEmailContact : "+isEmail),isEmail}return!1},isChatContact:function(){if(AgentConsoleDataStore.contacts.length>0){var isChat=!1,i=0;for(i=0;i<AgentConsoleDataStore.contacts.length;i++){if("ChatContactEvent"===AgentConsoleDataStore.contacts[i].contactType){isChat=!0;break}}return logger.info("isChatContact : "+isChat),isChat}return!1},onPermissionsListUpdate:function(){logger.trace("onPermissionsListUpdate - fired");var that=this,data=AgentConsoleDataStore.permissionsList;this.elements.agentListControl.agentList("updatePermissionsList","permissionsList",data),this.elements.agentInfoControl.agentInformation("updatePermissionsList","permissionsList",data),this.isMultiConferenceEnabled=!1,IC_Validation.isNotNullOrEmptyArray(data)&&$.grep(data,function(event){"multipartyconferencing"===event.Key&&(that.isMultiConferenceEnabled=!0)}),this.updateMultiCallControl_Base()},onMaxConferenceHandleUpdate:function(){IC_Validation.isNotNullOrEmptyArray(this.callContacts)&&this.callContacts.length>2&&"Joined"===this.callContacts[0].status&&"Joined"===this.callContacts[1].status&&this.toggleHpIconDialPad()},isMaxConferenceLimitNotReached:function(){var maxConferenceParties=this.isMultiConferenceEnabled?AgentConsoleDataStore.maxConference:3;return this.callContacts.length<maxConferenceParties-1},onOmniChannelReadyStateChanged:function(){var omniChannelRoutingInfo=AgentConsoleDataStore.omniChannelRoutingInfo;omniChannelRoutingInfo.autoRejected||1==AgentConsoleDataStore.getContacts(function(contact){return contact.id==omniChannelRoutingInfo.contactId&&"Incoming"==contact.status}).length&&"workItemAcceptRejectPanel"==this.acceptRejectPanelType&&IC_Validation.isValidObject(this.acceptRejectPanel)&&this.acceptRejectPanel.workItemAcceptRejectPanel("toggleAcceptButtonAccess",omniChannelRoutingInfo.canAccept)},onWorkItemContactAcceptRejectPanelShow:function(contact){if(contact.workItemType==IC_Util.SalesforceOmnichannelRouting){var omniChannelRoutingInfo=AgentConsoleDataStore.omniChannelRoutingInfo,canEnableAcceptBtn=!1;omniChannelRoutingInfo.contactId==contact.id&&(canEnableAcceptBtn=omniChannelRoutingInfo.canAccept),this.acceptRejectPanel.workItemAcceptRejectPanel("toggleAcceptButtonAccess",canEnableAcceptBtn)}},onWorkItemContactAcceptRejectPanelDestroy:function(contact){var omniChannelRoutingInfo=AgentConsoleDataStore.omniChannelRoutingInfo;if(omniChannelRoutingInfo.autoRejected&&omniChannelRoutingInfo.contactId==contact.id)var message=[{message:IC_Localization.omniChannelBusy,levelCss:"iMsg"}];this.showPopup(0,message,1e4)},onAgentLegAcceptRejectActionsEvent_Base:function(){switch(AgentConsoleDataStore.agentLegAcceptRejectActions){case"show":this.showAgentLegAcceptRejectPanel();break;case"hide":case"accept":case"reject":this.hideAgentLegAcceptRejectPanel()}},showAgentLegAcceptRejectPanel:function(){IC_Validation.isValidObject(this.agentLegAcceptRejectPanel)||(this.agentLegAcceptRejectPanel=$('<div class="ContactRootPnl" />').agentLegAcceptRejectControl({controller:this})),this.agentLegAcceptRejectPanel.appendTo(this.elements.contactsRootPanel)},hideAgentLegAcceptRejectPanel:function(){IC_Validation.isValidObject(this.agentLegAcceptRejectPanel)&&this.agentLegAcceptRejectPanel.agentLegAcceptRejectControl("destroy"),this.agentLegAcceptRejectPanel=null},fireAgentLegAcceptRejectActions:function(event){AgentConsoleDataStore.fireAgentLegAcceptRejectActions(event)},onCallContactDisconnect:function(contact){var disconnectCodes={Busy:IC_Localization.busy,BadNumber:IC_Localization.badNumberTooltip};disconnectCodes.hasOwnProperty(contact.disconnectCode)&&this.showPopup(0,[{message:disconnectCodes[contact.disconnectCode],levelCss:"eMsg"}])},onClickTabEmail:function(event){var x,y;this.elements.tooltipDiv.css("display","none"),(IC_Common.isButtonEnabled(this.elements.tabOBEmailIconDiv)||IC_Common.isButtonSelected(this.elements.tabOBEmailIconDiv))&&(x=event.clientX||this.elements.tabOBEmailIconDiv.offset().left,y=event.clientY||this.elements.tabOBEmailIconDiv.offset().top+this.elements.tabOBEmailIconDiv.height(),this.createEmailOB("",x,y))},createEmailOB:function(toAddress,clientX,clientY){logger.trace("createEmailOB, clientX :"+clientX+", clientY :"+clientY);var x,y,menuH,menuW,skillMenu=this.elements.obEmailSkillsMenu,skillMenuItems=skillMenu.find(".menuItem"),maxW=this.options.isPopout?280:180,that=this;skillMenuItems.length>0&&(this.toAddress=toAddress,skillMenu.finish(),1==skillMenuItems.length?skillMenuItems.trigger("click"):(x=clientX+document.body.scrollLeft,y=clientY+document.body.scrollTop,menuH=skillMenu.height(),menuW=skillMenu.width(),y+menuH>=460&&(y-=menuH),x+menuW>=maxW&&(x=menuW>maxW?10:maxW-menuW),skillMenu.css("left",x+"px"),skillMenu.css("top",y+"px"),skillMenu.mCustomScrollbar("destroy"),skillMenu.show(0,function(){skillMenu.mCustomScrollbar({scrollButtons:{enable:!0},scrollInertia:0}),clearTimeout(that.obSkillHideTimeout),that.obSkillHideTimeout=setTimeout(function(){skillMenu.fadeOut()},5e3),that.obEmailSkillsMenuFlag=!0})))}})}(jQuery);