!function($){var logger=IC_Common.getLogger("EmailContact");$.widget("AgentConsole.emailContactControl",{options:{controller:null,resourceBase:"",isPopout:!1,emailWidgetClick:function(){}},contactInfo:{},stopDestroy:!1,mailRespOption:"reply",emailTinyMceEditor:null,weekDays:[],contactIndicator:[],_init:function(){this.weekDays=[IC_Localization.sun,IC_Localization.mon,IC_Localization.tue,IC_Localization.wed,IC_Localization.thu,IC_Localization.fri,IC_Localization.sat],this.bumberPanelRight.on("click",$.proxy(this.rightBumberClick,this)),this.bumberPanelRight.on("mouseenter",$.proxy(this.rightBumberMouseEnter,this)),this.bumberPanelRight.on("mouseleave",$.proxy(this.rightBumberMouseLeave,this)),this.stateControlsPanel.on("click",$.proxy(this.statePnlClick,this)),this.bumberPanelLeft.on("click",$.proxy(this.leftBumberClick,this)),this.bumberPanelLeft.on("mouseover",$.proxy(this.leftBumberMouseEnter,this)),this.controlsPanel.on("mouseleave",$.proxy(this.ctrsPnlClickMouseLeave,this)),this.contactControlsPanel.on("click",$.proxy(this.ctrsPnlClick,this)),this.contactControlsPanel.on("mouseleave",$.proxy(this.ctrsPnlMouseLeave,this))},_create:function(){this.options.isPopout?this.consoleOptions=this.options.controller.options:this.consoleOptions=this.options.controller.consoleOptions(),this.element.append(this._createRootPanels()),this.contactIndicatorPanel=$('<div class="contactIndicator"/>').appendTo(this.stateControlsPanel),this.contactIndicatorPanel.indicator({container:this,isContact:!0}),this.contactIndicatorPanel.hide(),this.element.addClass("Separator"),this.updateControlPanel()},_createRootPanels:function(){var resourceBase=this.options.resourceBase;return this.root=$('<div class="ChatPnl"/>').addClass("emailStatePnlHeight"),this.ctrlPanel=$('<div class="ctrlPanel"/>'),this.controlsPanel=$('<div class="ControlsPnl" id = "po_emailControlsPanelId"/>'),this.statePanel=$('<div class="StatePnl"/>'),this.bumberPanelLeft=$('<div class="BumperPnlLeft" id = "po_emailBumperPnlLeftId" />'),this.stateControlsPanel=$('<div class="StateCtrlPnl unselectContact" />'),this.mediaTypeImgPnlL=$('<img class="MediaTypeMail" src="'+resourceBase+'/css/images/sm-mailbox.png" />'),this.rightArrowPnl=$('<img class="RightArrowInBumberBox" src="'+resourceBase+'/css/images/bumber-arrow-right.png" />'),this.rightArrowPnl.hide(),this.bumberPanelLeft.append(this.mediaTypeImgPnlL).append(this.rightArrowPnl),this.skillAndDurationHolder=$('<div class="skillAndDurationPnl"/>'),this.skillNamePnl=$('<div id = "emailPopoutSkillNamePnlId" class="ContactType" />'),this.callDurationPnl=$('<div class="ContactTypeTime" align="right" />'),this.emailStatusDiv=$('<div class="emailStatusDiv" align="center" />'),this.emailStatusImg=$("<img />"),this.emailStatusImg.hide(),this.emailStatusDiv.append(this.emailStatusImg),this.skillAndDurationHolder.append(this.skillNamePnl).append(this.emailStatusDiv).append(this.callDurationPnl),this.stausAndTimeHolder=$('<div class="statusAndTimePnl"/>'),this.contactStatus=$('<div class="ContactStatus StatusActive textEllipsis" align="left" id="po_emailContactStatusId"/>'),this.contactStatusTime=$('<div class="ContactStatusTime" align="right" />'),this.stausAndTimeHolder.append(this.contactStatus).append(this.contactStatusTime),this.parkedEmailStatusHolder=$('<div class="parkedEmailStatusHolder"/>'),this.parkedEmailSkillAndTimerDiv=$("<div>"),this.parkedEmailSkillDiv=$('<div class="parkedEmailSkillDiv textEllipsis" align="left" />').appendTo(this.parkedEmailSkillAndTimerDiv),this.parkedTimerPnl=$('<div align="right" class="parkedEmailTimer" />').appendTo(this.parkedEmailSkillAndTimerDiv),this.parkedEmailSubDiv=$('<div class="parkedEmailSubDiv textEllipsis" align="left" />'),this.parkedEmailStatusHolder.append(this.parkedEmailSkillAndTimerDiv).append(this.parkedEmailSubDiv),this.stateControlsPanel.append(this.skillAndDurationHolder).append(this.stausAndTimeHolder).append(this.parkedEmailStatusHolder),this.statePanel.append(this.bumberPanelLeft).append(this.stateControlsPanel),this.ctrlPanel.append(this.statePanel),this.bumberPanelRight=$('<div class="BumperPnlRight" id = "po_emailBumperPnlRightId" />'),this.contactControlsPanel=$('<div class="ContactCtrlPnl" id = "po_emailContactCtrlPnlId" />'),this.mediaTypeImgPnlR=$('<img class="MediaTypeMail" src="'+resourceBase+'/css/images/sm-mailbox.png"/>'),this.LeftArrowPnl=$('<img class="LeftArrowInBumberBox" src="'+resourceBase+'/css/images/bumber-arrow-left.png" />'),this.bumberPanelRight.append(this.mediaTypeImgPnlR).append(this.LeftArrowPnl),this.transferDiv=$('<div class="btnBrRound5 DropBtnPnl FourIcons btnDivDisable" title="'+IC_Localization.transfer+'" align="center" />'),this.transferImg=$('<img src="'+resourceBase+'/css/images/bumber-workitem-transfer-disabled.png" class="ImgTransfer" />'),this.transferDiv.append(this.transferImg),this.transferDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.transferDiv.on("click",$.proxy(this.transferClick,this)),this.dropDiv=$('<div class="btnBrRound5 DropBtnPnl FourIcons btnDivDisable" title="'+IC_Localization.discard+'" align="center" id = "po_emailDropDivId"/>'),this.dropImg=$('<img src="'+resourceBase+'/css/images/trash-enabled.png" class="ImgTrash" />'),this.dropDiv.append(this.dropImg),this.dropDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.dropDiv.on("click",$.proxy(this.dropClick,this)),this.emailParkDiv=$('<div class="btnBrRound5 DropBtnPnl FourIcons btnDivEnable" title="'+IC_Localization.parkEmail+'" align="center" id = "po_emailParkDivId"/>').css("display","none"),this.emailParkImg=$('<img src="'+resourceBase+'/css/images/bumber-workitem-drop.png" class="ImgEmailPark" />'),this.emailParkDiv.append(this.emailParkImg),this.emailParkDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.emailParkDiv.on("click",$.proxy(this.parkEmailClick,this,!1)),this.emailUnParkNowDiv=$('<div class="btnBrRound5 DropBtnPnl FourIcons btnDivEnable" title="'+IC_Localization.unparkNow+'" align="center" id = "po_emailUnParkDivId"/>').css("display","none"),this.emailUnParkNowImg=$('<img src="'+resourceBase+'/css/images/unpark_worknow.png" class="ImgEmailUnPark" />'),this.emailUnParkNowDiv.append(this.emailUnParkNowImg),this.emailUnParkNowDiv.hoverfn(IC_Common.mouseEnterButton,IC_Common.mouseLeaveButton),this.emailUnParkNowDiv.on("click",$.proxy(this.parkEmailClick,this,!0)),this.bumberPanelLeft.addClass("TopLeftRound"),this.stateControlsPanel.addClass("TopRightRound"),this.bumberPanelRight.addClass("TopRightRound"),this.controlsPanel.addClass("TopLeftRound TopRightRound"),this.contactControlsPanel.addClass("TopLeftRound"),this.contactControlsPanel.append(this.transferDiv).append(this.dropDiv),this.contactControlsPanel.append(this.emailParkDiv).append(this.emailUnParkNowDiv),this.controlsPanel.append(this.bumberPanelRight).append(this.contactControlsPanel),this.ctrlPanel.append(this.statePanel).append(this.controlsPanel),this.root.append(this.ctrlPanel),this.root},updateStatePnlHeight:function(status){"Active"===status||"Disconnected"===status?this.resizeContentPanel(this.contactIndicatorPanel.indicator("getIndicatorShown")):"Interrupted"===status&&this.resizeContentPanel(!1)},agentIndicatorAction:function(indicator){this.options.controller.agentIndicatorAction(indicator)},enableDisableDiscardButton:function(enabled){var dropState=!0===enabled&&"Discarded"!==this._contactInfo.status?"enabled":"disabled";this.changeButtonState(this.dropDiv,this.dropImg,dropState,this.resourceBase+"/css/images/trash-enabled.png",this.resourceBase+"/css/images/trash-disabled.png")},updateContactIndicator:function(contactIndicator){this.contactIndicator=contactIndicator,this.contactIndicatorPanel.indicator("updateData","contactId",this._contactInfo.id),this.contactIndicatorPanel.indicator("updateData","indicator",contactIndicator)},resizeContentPanel:function(showIndicator){!0===showIndicator?(this.statePanel.addClass("statePnlLarge"),this.stateControlsPanel.addClass("stateCtrlPnlLarge"),this.bumberPanelLeft.addClass("bumberPnlLeftLarge"),this.bumberPanelRight.addClass("bumberPnlRightLarge"),this.controlsPanel.addClass("ctrlPnlLarge"),this.dropDiv.css({"margin-top":"17px"}),this.transferDiv.css({"margin-top":"17px"}),this.emailParkDiv.css({"margin-top":"17px"}),this.contactIndicatorPanel.showfn(),this.stausAndTimeHolder.addClass("statusAndTimePnlIndicator"),this.contactStatus.addClass("ContactStatusIndicator"),this.skillAndDurationHolder.addClass("skillAndDurationPnlIndicator"),this.skillNamePnl.addClass("ContactTypeIndicator"),this.callDurationPnl.addClass("ContactTypeTimeIndicator")):(this.contactIndicatorPanel.hide(),this.statePanel.removeClass("statePnlLarge"),this.stateControlsPanel.removeClass("stateCtrlPnlLarge"),this.bumberPanelLeft.removeClass("bumberPnlLeftLarge"),this.bumberPanelRight.removeClass("bumberPnlRightLarge"),this.controlsPanel.removeClass("ctrlPnlLarge"),this.dropDiv.css({"margin-top":"11px"}),this.transferDiv.css({"margin-top":"11px"}),this.emailParkDiv.css({"margin-top":"11px"}),this.stausAndTimeHolder.removeClass("statusAndTimePnlIndicator"),this.contactStatus.removeClass("ContactStatusIndicator"),this.skillAndDurationHolder.removeClass("skillAndDurationPnlIndicator"),this.skillNamePnl.removeClass("ContactTypeIndicator"),this.callDurationPnl.removeClass("ContactTypeTimeIndicator"))},_updateUI:function(){var contactInfo=this._contactInfo,resourceBase=this.options.resourceBase,dropState="disabled",status=contactInfo.status,transferState="disabled",parkIconState="disabled",isInbound=contactInfo.isInbound,that=this,emailRecTime=null,dateTimeFormat=null,getTimerWidth=0;if(this.bumberPanelLeft.removeClass("BottomLeftRound"),this.stateControlsPanel.removeClass("BottomRightRound"),this.controlsPanel.removeClass("BottomLeftRound BottomRightRound"),this.bumberPanelRight.removeClass("BottomRightRound"),this.contactControlsPanel.removeClass("BottomLeftRound"),"Incoming"!==status&&("Holding"!==status&&"Discarded"!==status&&"Parked"!==status&&(dropState="enabled","enabled"),"Discarded"===status&&!1===contactInfo.finalState&&!0===contactInfo.useAcw&&"enabled","Parked"==status&&(this.options.controller.isTagsAssigned(contactInfo.skillId)?"enabled":"disabled"),this.rightArrowPnl.showfn(),this.stopHoverSlide=!0,"Active"===status&&isInbound&&(transferState="enabled",parkIconState="enabled")),"Parked"===status?(parkIconState="enabled",this.emailParkDiv.attr("title",IC_Localization.unparkToQueue),this.emailParkImg.removeClass("ImgEmailPark"),this.emailParkImg.attr("src",resourceBase+"/css/images/unpark_queue.png").addClass("ImgEmailUnPark"),this.changeButtonState(this.emailParkDiv,this.emailParkImg,parkIconState,resourceBase+"/css/images/unpark_queue.png",resourceBase+"/css/images/unpark_queue.png"),this.stausAndTimeHolder.css("display","none"),this.parkedEmailStatusHolder.css("display","block"),this.mediaTypeImgPnlL.attr("src",resourceBase+"/css/images/email-parked-mediaIcon.svg").removeClass("MediaTypeMail").addClass("parkedEmailIcon"),this.mediaTypeImgPnlR.attr("src",resourceBase+"/css/images/email-parked-mediaIcon.svg").removeClass("MediaTypeMail").addClass("parkedEmailIcon")):(this.emailParkDiv.attr("title",IC_Localization.parkEmail),this.emailParkImg.removeClass("ImgEmailUnPark").addClass("ImgEmailPark"),this.changeButtonState(this.emailParkDiv,this.emailParkImg,parkIconState,resourceBase+"/css/images/bumber-workitem-drop.png",resourceBase+"/css/images/bumber-workitem-drop-disabled.png"),this.parkedEmailStatusHolder.css("display","none"),this.stausAndTimeHolder.css("display","block"),this.contactStatus.text(this.getStatusDesc(status)),this.mediaTypeImgPnlL.attr("src",resourceBase+"/css/images/sm-mailbox.png").removeClass("parkedEmailIcon").addClass("MediaTypeMail"),this.mediaTypeImgPnlR.attr("src",resourceBase+"/css/images/sm-mailbox.png").removeClass("parkedEmailIcon").addClass("MediaTypeMail")),this.changeButtonState(this.dropDiv,this.dropImg,dropState,resourceBase+"/css/images/trash-enabled.png",resourceBase+"/css/images/trash-disabled.png"),this.changeButtonState(this.transferDiv,this.transferImg,transferState,resourceBase+"/css/images/bumber-workitem-transfer.png",resourceBase+"/css/images/bumber-workitem-transfer-disabled.png"),this.contactStatus.removeClass("BumpPnlLeftGradientIncoming BumpPnlLeftGradientActive BumpPnlLeftGradientHoldDiconnect"),this.statusColor(status),this.contactStatusWidth=this.contactStatus.width(),this.options.controller.getSkillDetails(contactInfo.skillId,function(skillDetails){0!==Object.keys(skillDetails).length&&skillDetails.emailParking?that.emailParkDiv.showfn():that.emailParkDiv.hide()}),"Parked"==status){if(sendDate=new Date(this._contactInfo.lastStateTime),today=new Date,today.getDate()==sendDate.getDate()&&today.getMonth()==sendDate.getMonth()&&today.getYear()==sendDate.getYear())dateTimeFormat=IC_Common.getAMPMLocale(new Date(this._contactInfo.lastStateTime).format(this.consoleOptions.localeTimeFormat),this.consoleOptions.localeCode),this.callDurationPnl.text(dateTimeFormat),this.parkedTimerPnl.css("display","none"),this.parkedEmailSkillDiv.css("float","none");else{var emailRecDate=new Date(this._contactInfo.time).getDate(),emailRecMonth=new Date(this._contactInfo.time).getMonth()+1;emailRecDate=emailRecDate<=9?"0"+emailRecDate:emailRecDate,emailRecMonth=emailRecMonth<=9?"0"+emailRecMonth:emailRecMonth,dateTimeFormat=this.weekDays[new Date(this._contactInfo.time).getDay()]+". "+emailRecDate+"/"+emailRecMonth,this.callDurationPnl.text(dateTimeFormat),emailRecTime=IC_Common.getAMPMLocale(new Date(this._contactInfo.time).format(this.consoleOptions.localeTimeFormat),this.consoleOptions.localeCode),this.parkedTimerPnl.css("display","block"),this.parkedTimerPnl.text(emailRecTime),this.parkedEmailSkillDiv.css("float","left"),getTimerWidth=IC_Common.getTextWidth(emailRecTime,{"font-size":"10.5px","font-family":"verdana"})}IC_Common.setTextWithEllipsis(this.parkedEmailSkillDiv,contactInfo.skillName,154-getTimerWidth,!0),IC_Common.setTextWithEllipsis(this.parkedEmailSubDiv,contactInfo.subject,160,!0)}else this.startContactDurationTimer(),this.options.controller.OnAgentIndicatorUpdate(),this.updateStatePnlHeight(status);"Discarded"===status&&this.showDispositionPanel(),this.calculateEllipsisSpace(contactInfo,dateTimeFormat),$(".ui-dialog-content").dialog("close")},startContactDurationTimer:function(){var that=this;globalTimer.callbacks[this._contactInfo.id]=function(){that.updateTimer(that.callDurationPnl)},that.updateTimer(that.callDurationPnl)},updateTimer:function(timerPnlObj){var hours,calculatedTime=0,contactDuration=this.timeDiff(this._contactInfo.time);calculatedTime=contactDuration<345600?IC_Common.secondsToTime(contactDuration):">96 "+IC_Localization.hours,timerPnlObj.text(calculatedTime),IC_Validation.isNotNullOrUndefinedString(contactDuration)&&"number"==typeof contactDuration&&(hours=Math.floor(contactDuration/3600),contactDuration%60,(Math.floor(contactDuration/60)%60<=10&&0===hours||hours<=10)&&(this.calculateEllipsisSpace(this._contactInfo),this.contactStatusEllipsis()))},calculateEllipsisSpace:function(contactInfo,dateFormat){this.skillNamePnl.css({width:"auto","font-size":"12px"});var skillPnlWidth,callDurationWidth=0===this.callDurationPnl.width()?this.callDurationWidth:this.callDurationPnl.width(),name="";if(name="Consult"===contactInfo.type&&IC_Validation.isNotNullOrEmpty(contactInfo.consultAgentName)?contactInfo.consultAgentName:contactInfo.skillName,name="Parked"===contactInfo.status?contactInfo.fromAddress:name,IC_Validation.isNotNullOrUndefinedString(dateFormat)){var dateWidth=IC_Common.getTextWidth(dateFormat,{"font-size":"10.5px","font-family":"verdana"});IC_Common.setTextWithEllipsis(this.skillNamePnl,name,154-dateWidth,!0)}else callDurationWidth=128-parseInt(callDurationWidth),this.skillNamePnl.text(name),skillPnlWidth=(skillPnlWidth=this.skillNamePnl.css("width")).replace("px",""),this.skillNamePnl.css("width",callDurationWidth+"px"),skillPnlWidth>=callDurationWidth&&(this.skillNamePnl.addClass("textEllipsis"),this.skillNamePnl.attr("title",name))},timeDiff:function(contactStateTime){var ms=Math.abs(this.options.controller.getServerTimestamp()-contactStateTime);return Math.round(ms/1e3)},contactStatusEllipsis:function(){var statusAndTimePnlWidth=this.stausAndTimeHolder.width(),contactTimerWidth=this.contactStatusTime.width(),contactStatusWidth=this.contactStatusWidth,diffTimerWidth=statusAndTimePnlWidth-contactTimerWidth;contactStatusWidth+=10;contactStatusWidth>diffTimerWidth?this.contactStatus.css({width:diffTimerWidth-20+"px"}):contactStatusWidth>0&&this.contactStatus.css({width:"auto"})},changeButtonState:function(div,img,state,iconEnabled,iconDisabled){"enabled"===(state=state||"disabled")?IC_Common.enableButton(div,img,iconEnabled):"disabled"===state?IC_Common.disableButton(div,img,iconDisabled):"selected"===state?IC_Common.selectButton(div,img,iconEnabled):"unselected"===state&&IC_Common.unselectButton(div,img,iconEnabled)},statusColor:function(status){this.stateControlsPanel.removeClass("unselectContact").addClass("StatePnlSelected"),this.ctrlPanel.removeClass("InterruptCtrlPanel").addClass("ActiveCtrlPanel"),this.statePanel.removeClass("interruptEmail"),"Discarded"===status?(this.contactStatus.removeClass("BumpPnlLeftGradientActive").addClass("BumpPnlLeftGradientHoldDiconnect"),this.bumberPanelLeft.removeClass("BumpPnlLeftGradientActive").addClass("BumpPnlLeftGradientHoldDiconnect"),this.bumberPanelRight.removeClass("BumpPnlRightGradientActive").addClass("BumpPnlRightGradientHoldDisconnect")):"Active"===status?(this.contactStatus.removeClass("BumpPnlLeftGradientHoldDiconnect").addClass("BumpPnlLeftGradientActive"),this.bumberPanelLeft.removeClass("BumpPnlLeftGradientHoldDiconnect").addClass("BumpPnlLeftGradientActive"),this.bumberPanelRight.removeClass("BumpPnlRightGradientHoldDisconnect").addClass("BumpPnlRightGradientActive")):(this.contactStatus.removeClass("BumpPnlLeftGradientActive").addClass("BumpPnlLeftGradientHoldDiconnect"),this.bumberPanelLeft.removeClass("BumpPnlLeftGradientActive").addClass("BumpPnlLeftGradientHoldDiconnect"),this.bumberPanelRight.removeClass("BumpPnlRightGradientActive").addClass("BumpPnlRightGradientHoldDisconnect")),"Interrupted"===status?this.statePanel.addClass("interruptEmail"):"Parked"==status&&this.stateControlsPanel.addClass("unselectContact").css({"border-right":"1px solid #D1D1D1"})},setSelectedMode:function(){this.stateControlsPanel.removeClass("unselectContact")},resetSelectedMode:function(){this.stateControlsPanel.addClass("unselectContact")},refresh:function(contactinfo){this._contactInfo=contactinfo,this._updateUI()},getContact:function(){return this._contactInfo},search:function(searchPattern){if(""===$.trim(searchPattern))return this.element.show(500),this.options.controller.showContactResult(),!0;var contact=this._contactInfo,tempElement=$("<span>"),emailBody="";return emailBody=contact.body?contact.body:tempElement.html(contact.bodyHTML).text(),-1!=contact.fromAddress.toLocaleLowerCase().indexOf(searchPattern)||-1!=contact.toAddress.toLocaleLowerCase().indexOf(searchPattern)||-1!=contact.subject.toLocaleLowerCase().indexOf(searchPattern)||-1!=contact.skillName.toLocaleLowerCase().indexOf(searchPattern)||-1!=emailBody.toLocaleLowerCase().indexOf(searchPattern)?(this.element.show(500),this.options.controller.showContactResult(),!0):(this.element.hide(500),this.options.controller.hideContactResult(),!1)},getStatusDesc:function(status){var contact=this.options.controller.getChatContact()||{};switch(status){case"Active":return"ChatContactEvent"===contact.contactType&&"Incoming"===contact.status?this.options.controller.showEmailInterruptOverlay():this.options.controller.hideEmailInterruptOverlay(),IC_Localization.active;case"Discarded":return IC_Localization.discarded;case"Interrupted":return"ChatContactEvent"===contact.contactType&&"Incoming"!==contact.status?this.options.controller.hideEmailInterruptOverlay():this.options.controller.showEmailInterruptOverlay(),$("#widgetPnlOverlay").removeClass("contentPnlDisableOverlay"),IC_Localization.interrupted;default:return status}},leftBumberClick:function(){var status=this._contactInfo.status;!0===this.stopHoverSlide&&"Interrupted"!==status&&this.showContactCtrlsPnl()},leftBumberMouseEnter:function(){var status=this._contactInfo.status;if(!0===this.stopHoverSlide){this.bumberPanelLeft.addClass("bumperBoxHover").removeClass("BumberPnlLeft");"block"!=this.bumberPanelLeft.css("display")&&"inline"!=this.bumberPanelLeft.css("display")||!1===this.leftBumberMouseFlag||"Interrupted"===status||(this.leftBumberMouseFlag=!1,this.controlsPanel.animate({width:"toggle"},{duration:250,specialEasing:{width:"linear",height:"easeOutBounce"}}))}},enableDisbleBtnOnTransfer:function(isTransferClicked){var dropState="enabled",transferState="enabled",parkIconState="enabled";isTransferClicked&&(dropState="disabled",transferState="disabled","disabled",parkIconState="disabled");var resourceBase=this.options.resourceBase;this.changeButtonState(this.dropDiv,this.dropImg,dropState,resourceBase+"/css/images/trash-enabled.png",resourceBase+"/css/images/trash-disabled.png"),this.changeButtonState(this.transferDiv,this.transferImg,transferState,resourceBase+"/css/images/bumber-workitem-transfer.png",resourceBase+"/css/images/bumber-workitem-transfer-disabled.png"),this.changeButtonState(this.emailParkDiv,this.emailParkImg,parkIconState,resourceBase+"/css/images/bumber-workitem-drop.png",resourceBase+"/css/images/bumber-workitem-drop-disabled.png")},ctrsPnlClickMouseLeave:function(){if(!0!==this.maskingFlag&&!0!==this.rightBumberMouseFlag&&!0===this.stopHoverSlide){this.bumberPanelLeft.removeClass("bumperBoxHover").addClass("BumberPnlLeft");"block"!=this.controlsPanel.css("display")&&"inline"!=this.controlsPanel.css("display")||!1!==this.leftBumberMouseFlag||(this.leftBumberMouseFlag=!0,this.bumberPanelLeft.showfn(),this.controlsPanel.animate({width:"toggle"},{duration:250,specialEasing:{width:"linear",height:"easeOutBounce"}}))}},ctrsPnlMouseLeave:function(){this.rightBumberMouseFlag=!1},rightBumberMouseEnter:function(){this.bumberPanelRight.addClass("bumperBoxHoverSelected")},rightBumberMouseLeave:function(){this.bumberPanelRight.removeClass("bumperBoxHoverSelected"),this.rightBumberMouseFlag=!0},statePnlClick:function(e){this.options.emailWidgetClick(this._contactInfo,e)},ctrsPnlClick:function(e){e.stopPropagation()},showDispositionPanel:function(){this.options.controller.showDispositionPanel(this._contactInfo)},transferClick:function(e){e.stopPropagation(),e.preventDefault(),(IC_Common.isButtonEnabled(this.transferDiv)||IC_Common.isButtonSelected(this.transferDiv))&&this.options.controller.onEmailContactTransfer(this._contactInfo.id)},dropClick:function(e){(IC_Common.isButtonEnabled(this.dropDiv)||IC_Common.isButtonSelected(this.dropDiv))&&("Holding"===this._contactInfo.status?(e.stopPropagation(),e.preventDefault()):(this.options.controller.onEmailContactEnd(this._contactInfo.id,this._contactInfo.isInbound),this.showContactStatePnl()))},showContactStatePnl:function(){(0===this.callDurationPnl.width()||IC_Validation.isNotNullOrUndefinedString(this.callDurationPnl.width()))&&(this.callDurationWidth=this.callDurationPnl.width()),"none"==this.bumberPanelLeft.css("display")&&(this.bumberPanelLeft.showfn(),this.controlsPanel.animate({width:"toggle"},{duration:250,specialEasing:{width:"linear",height:"easeOutBounce"}}))},parkEmailClick:function(unparkNow){(IC_Common.isButtonEnabled(this.emailParkDiv)||IC_Common.isButtonSelected(this.emailParkDiv))&&("Active"===this._contactInfo.status?this.options.isPopout?this.options.controller.callParkEmailonWidget(this._contactInfo.id):this.options.controller.parkEmail(this._contactInfo):this.options.controller.unParkEmail(this._contactInfo.id,unparkNow))},updateControlPanel:function(){var agentInfo=this.options.controller.agentInfo(),isAcw=agentInfo.cState.acw;"Unavailable"!==agentInfo.cState.state||isAcw?(this.contactControlsPanel.find(".FourIcons").removeClass("FiveIcons"),this.emailUnParkNowDiv.hide()):(this.contactControlsPanel.find(".FourIcons").addClass("FiveIcons"),this.emailUnParkNowDiv.showfn())},setCornerAfterCall:function(){this.bumberPanelLeft.addClass("TopLeftRound BottomLeftRound"),this.stateControlsPanel.addClass("TopRightRound BottomRightRound"),this.bumberPanelRight.addClass("TopRightRound BottomRightRound"),this.controlsPanel.addClass("TopLeftRound TopRightRound BottomLeftRound BottomRightRound"),this.contactControlsPanel.addClass("TopLeftRound BottomLeftRound")},destroy:function(destroyImmediate){var that=this,contactId=that._contactInfo.id;function disposeUI(){try{$(that).children().each(function(){IC_Common.discardElement(this)}),that.element.remove()}catch(ex){logger.error("destroy :",ex)}}1!=this.stopDestroy&&(this.stopDestroy=!0,destroyImmediate?(delete globalTimer.callbacks[that._contactInfo.id],disposeUI()):setTimeout(function(){logger.trace("ContactID: "+contactId," :contactInfo before"),delete globalTimer.callbacks[that._contactInfo.id],that.element.slideUp(250,function(){that.options.controller.onContactDestroy(that._contactInfo,that),disposeUI(),logger.trace("ContactID: "+contactId," :contactInfo after")})},3e3))}})}(jQuery);